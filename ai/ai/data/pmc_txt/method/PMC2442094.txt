Methods Strain and genome nomenclature Abbreviations used to designate the cyanobacterial strains (genome accession number) Ama-MBIC11017: Acaryochloris marina MBIC11017 (embl: CP000828) Ana-PCC7120: Anabaena/Nostoc sp. PCC 7120 (embl: BA000019) Ava-ATCC29413: Anabaena variabilis ATCC 29413 (embl: CP000117) Cbi-PCC7001: Cyanobium sp. PCC 7001 (gb: 1106012173546) Cth-ATCC51142: Cyanothece sp. ATCC 51142 (embl: CP000806) Cth-CCY0110: Cyanothece sp. CCY0110 (gb: 1101676644636–1101676644658) Cwa-WH8501: Crocosphaera watsonii WH8501 (embl: AADV02000100) Syn-JA33Ab: Cyanobacteria Yellowstone JA-3-3Ab (embl: CP000239) Syn-JA23B'a: Cyanobacteria Yellowstone JA-2-3B'a (embl: CP000240) Gvi-PCC7421: Gloeobacter violaceus PCC 7421 (embl: BA000045) Lae-PCC8106: Lyngbya aestuari PCC 8106 (gb: 1099428180563–1099428180584) Mch-PCC7420: Microcoleus chthonoplastes PCC 7420 (gb:1103659003780–1103659003836) Mic-NIES843: Microcystis aeruginosa NIES-843 (embl: AP009552) Mic-PCC7806: Microcystis aeruginosa PCC 7806 (embl: AM778843–AM778958) Nsp-CCY9414: Nodularia spumigena CCY9414 (gb:1099428179735–1099428179797) Npu-PCC73102: Nostoc punctiforme PCC 73102 (kindly provided by J. C. Meeks) [77] Pro-SS120: Prochlorococcus marinus SS120 (embl: AE017126) Pro-AS9601: Prochlorococcus marinus AS9601 (embl: CP000551) Pro-MED4: Prochlorococcus marinus MED4 (embl: BX548174) Pro-MIT9211: Prochlorococcus marinus MIT9211 (embl: AALP01000001) Pro-MIT9215: Prochlorococcus marinus MIT9215 (embl: CP000825) Pro-MIT9301: Prochlorococcus marinus MIT9301 (embl: CP000576) Pro-MIT9303: Prochlorococcus marinus MIT9303 (embl: CP000554) Pro-MIT9312: Prochlorococcus marinus MIT9312 (embl: CP000111) Pro-MIT9313: Prochlorococcus marinus MIT9313 (embl: BX572095) Pro-MIT9515: Prochlorococcus marinus MIT9515 (embl: CP000552) Pro-NATL1A: Prochlorococcus marinus NATL1A (embl: CP000553) Pro-NATL2A: Prochlorococcus marinus NATL2A (embl: CP000095) Syn-BL107: Synechococcus sp. BL107 (gb: 1099739244347) Syn-CC9311: Synechococcus sp. CC9311 (embl: CP000435) Syn-CC9605: Synechococcus sp. CC9605 (embl: CP000110) Syn-CC9902: Synechococcus sp. CC9902 (embl: CP000097) Syn-PCC6301: Synechococcus elongatus PCC 6301 (embl: AP008231) Syn-PCC7002: Synechococcus sp. PCC 7002 (embl: CP000951) Syn-PCC7335: Synechococcus sp. PCC 7335 (gb: 1103496006889–1103496006899) Syn-PCC7942: Synechococcus elongatus PCC 7942 (embl: CP000100) Syn-RCC307: Synechococcus sp. RCC307 (embl: CT978603) Syn-RS9916: Synechococcus sp. RS9916 (gb: 1100013018508) Syn-RS9917: Synechococcus sp. RS9917 (gb: 1099465004208) Syn-WH5701: Synechococcus sp. WH5701 (gb: 1099465003749–1099465003864) Syn-WH7803: Synechococcus sp. WH7803 (embl: CT971583) Syn-WH7805: Synechococcus sp. WH7805 (gb: 1099646010155–1099646010157) Syn-WH8102: Synechococcus sp. WH8102 (gb: BX548020) Syn-PCC6803: Synechocystis sp. PCC 6803 (embl: BA000022) Tel-BP1: Thermosynechococcus elongatus BP-1 (embl: BA000039) Ter-IMS101: Trichodesmium erythreum IMS101 (embl: CP000393) Pairs of cyanobacterial genomes used in Figure 3 Mic-PCC7806/Cwa-WH8501 Mic-PCC7806/Syn-PCC6803 Cwa-WH8501/Syn-PCC6803 Lae-PCC8106/Ter-IMS101 Npu-PCC73102/Ava-ATCC29413 Npu-PCC73102/Ana-PCC7120 Npu-PCC73102/Nsp-CCY9414 Nsp-CCY9414/Ana-PCC7120 Ava-ATCC29413/Nsp-CCY9414 Ana-PCC7120/Ava-ATCC29413 Other bacterial strains used in Figure 3 (genome accession number) Shigella dysenteriae, serovar 1, strain Sd97/Sd197 (CP000034_GR) Acidovorax avenae subsp. citrulli AAC00-1 (NC_008752) Agrobacterium tumefaciens str. C58 (NC_003062) Bacillus subtilis subsp. subtilis str. 168 (NC_000964) Bordetella parapertussis 12822 (NC_002928) Escherichia coli APEC O1 (NC_008563) Enterobacter sp. 638 (NC_009436) Janthinobacterium sp. Marseille (NC_009659) Klebsiella pneumoniae subsp. pneumoniae MGH 78578 (CP000647) Listeria monocytogenes EGD-e (NC_003210) Methylococcus capsulatus str. Bath (NC_002977) Ochrobactrum anthropi ATCC 49188 chromosome 1 (NC_009667) Polaromonas naphthalenivorans CJ2 (NC_008781) Pseudomonas aeruginosa PA7 (NC_009656) Pseudomonas fluorescens PfO-1 (NC_007492) Rhizobium etli CFN 42 (NC_007761) Rhizobium leguminosarum bv. viciae 3841 (NC_008380) Rhodobacter sphaeroides ATCC 17025 (NC_009428) Rhodoferax ferrireducens T118 (NC_007908) Shewanella loihica PV-4 (NC_009092) Shewanella oneidensis MR-1 (NC_004347) Shewanella sp. W3-18-1 (NC_008750) Shigella boydii Sb227 (NC_007613) Silicibacter sp. TM1040 (NC_008044) Yersinia enterocolitica subsp. enterocolitica 8081 (NC_008800) Yersinia pestis CO92 (NC_003143) Photorhabdus luminescens subsp. laumondii TTO1 (NC_005126) DNA preparation and sequencing The strain Microcystis aeruginosa PCC 7806 (kept in constant culture since its isolation in 1978; Pasteur Culture Collection, Paris, France [18]) was grown as described [52]. The genome sequence of Mic-PCC7806 was determined by a whole-genome shotgun strategy. Two libraries were generated using genomic DNA extracted with the kit Nucleobond AGX500 (Macherey-Nagel, Hoerdt, France) and shared by nebulization. The first library contained inserts from 1 to 4 kb cloned in pcDNA2.1 (Invitrogen Life Technologies, Carlsbad, CA, USA) and the second included inserts from 5 to 8 kb cloned in the low-copy vector pSYX34 (gift of F. Kunst, Institut Pasteur, Paris, France). A BAC library was constructed into the vector pBeloBAC11 (inserts ≤ 20 kb) (Epicentre, Madison, USA) using spooled DNA extracted as described [78] and partially hydrolyzed with HindIII. Plasmid DNA purification was performed using the Montage Plasmid Miniprep96 Kit (Millipore, Molsheim, France) or the TempliPhi DNA sequencing template amplification kit (GE Healthcare, Uppsala, Sweden). BAC Miniprep96 Kit (Millipore, Molsheim, France) was used for BAC templates. Sequencing reactions were done, from both ends of DNA inserts, using ABI PRISM BigDye Terminator cycle sequencing ready reactions kit and run on a 3700 Genetic Analyzer (Applied Biosystems, Foster City, CA, USA). The trace file was used with the Phred-Phrap-Consed package to perform the assembly [79]. Sequencing reactions were performed to close gaps, improve coverage and resolve sequence ambiguities using PCR products amplified from genomic DNA or DNA plasmid templates. Phylogenetic analysis A dataset containing a concatenation of the 16S and 23S sequences was aligned by Muscle [80], and the alignment was manually edited to remove ambiguously aligned positions, giving a final dataset of 4195 nucleotide positions for phylogenetic analysis. From this dataset, a maximum likelihood tree was calculated by Phyml [81], using the HKY model of nucleotide evolution with an estimation of the transition/transversion ratio, including 4 rates of site heterogeneity, an estimated number of invariable positions, and an estimated alpha shape parameter. The numbers at the nodes correspond to the bootstrap values calculated on 1000 resampled datasets by Phyml. Syntenic score computation Ten orthologs located on either side of one pair of putatively orthologous CDS (linked by BDBH) were analyzed. For each pair of orthologous genes located in the proximity of the tested gene and of its ortholog, the synteny score was incremented by 1. Using this method of calculation, two totally syntenic genomes will have a score of 20 attributed to each of their orthologs, whereas two-non syntenic genomes will have a score of 0. Restriction-modification enzymes Putative restriction enzymes were identified by Blast searching of known type I and II restriction enzymes against the Mic-PCC7806 genome. Because DNA methylases are more reliably identified by Blast than restriction enzymes, we also identified all methylases, and examined the surrounding genes for potential restriction enzymes. Detection of atypical CDSs A first-order Markov model was built based on the dinucleotide composition of the core genes of a group of 8 selected cyanobacterial genomes (Table 4), identified by bi-directional best hits using BLASTp (bitscore of 30% against itself). This Markov model takes into account the Markov probability matrix of the core genes to analyse whether the composition of the CDS under study is "atypical", using the formula described in [25]. For each CDS, the model calculates an index that represents the likelihood that CDS will have a dinucleotide composition compatible with that of the core genes. In order to assess significance cutoffs, we applied the following statistics [82]: for each gene analyzed, one million random sequences were generated based on the Markov model probability matrix of the core genes, and the Markov index was calculated for each of these random sequences. The results were then analyzed by a one-tailed test with cut-offs of 0.1%. The cut-off was defined after several in silico horizontal gene transfer simulations, during which random genes from different genomes were introduced artificially into the genome sequences under study. The optimal threshold (0.1%) was defined for all the genomes of the group as the value at which the model had the highest detection of the in silico introduced genes (true positives), and the lowest detection of core genes (false positives). Clustering of atypical genes We defined an initial cluster of at least 4 neighboring atypical genes which was allowed to grow (in both directions) searching for other nearby atypical genes, until regions containing 4 or more non-atypical genes appeared. By this process, a reduced number of less-atypical genes and of normal genes could be included in a larger CAG.