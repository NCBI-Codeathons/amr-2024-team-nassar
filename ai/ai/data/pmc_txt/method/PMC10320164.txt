MATERIALS AND METHODS Workflow The FunARTS workflow is illustrated briefly in Figure 1. The pipeline involves these automated steps: First, users upload FASTA, Genbank, or EMBL files of fungal genomes or BGCs as input. Additionally, it is also possible to provide antiSMASH job ids. In the next step, BGCs are predicted using the antiSMASH fungal version (11). Then, FunARTS identifies essential housekeeping genes and their duplications. Essential housekeeping (core) genes within the genome are determined using Hidden Markov Models (HMMs) from the BUSCO dataset (24) by HMMER3 (25). Meanwhile, duplication thresholds are specified for each core gene model according to the reference set. Subsequently, FunARTS screens whether duplicated essential genes are located within a BGC. Additionally, it can also determine the presence of known resistance factors and domains of unknown function. Finally, interactive output tables are generated for easy exploration of the results. When multiple genomes are analyzed, the BiG-SCAPE (26) algorithm is employed to group BGCs into gene cluster families (GCFs) for easy comparison of results. Figure 1.Illustration of the FunARTS pipeline. (A) Basic steps for reference set construction. Housekeeping core genes, duplication thresholds, and additional statistics are identified for each reference genome. The Hidden Markov Models are appended to reference sets. (B) The workflow of FunARTS screening. Input genome(s) are scanned to identify Biosynthetic Gene Clusters (BGCs) known resistance factors, and core genes using reference sets. FunARTS screening criteria are then applied. Duplications, BGC prioritization, and novel target discovery are integrated into the interactive output. (C) Comparing the results of multi-genome analysis. The BiG-SCAPE clustering algorithm is applied to all determined BGCs. Illustration of the FunARTS pipeline. (A) Basic steps for reference set construction. Housekeeping core genes, duplication thresholds, and additional statistics are identified for each reference genome. The Hidden Markov Models are appended to reference sets. (B) The workflow of FunARTS screening. Input genome(s) are scanned to identify Biosynthetic Gene Clusters (BGCs) known resistance factors, and core genes using reference sets. FunARTS screening criteria are then applied. Duplications, BGC prioritization, and novel target discovery are integrated into the interactive output. (C) Comparing the results of multi-genome analysis. The BiG-SCAPE clustering algorithm is applied to all determined BGCs. Reference set and core gene detection To identify reference core genes 1793 complete genomes representing 9 different phyla were collected from the MycoCosm database (Supplementary Table S1) (17). Core genes were identified using the BUSCO datasets (24) and OrthoDB v10 (27), which is one of the largest databases of orthologs with functional annotations (Supplementary Figure S1). Core genes were classified based on their function using the OrthoDB database for each reference set. As some of the core genes might be more likely associated with biosynthesis than resistance and lead to false positive results, FunARTS offers two search modes for the detection of core genes. The ‘default mode’ assists in lowering false positives and filters unlikely targets by removing regulatory, transport, and biosynthetic functions associated with known BGCs. The ‘exploration mode’ is an alternative for searching more prospective targets and skips the filtering step. Screening criteria BGC proximity First, fungiSMASH is used to detect BGCs. Then, BGC proximity hits are calculated by finding core and resistance gene locations that intersect with BGC boundaries determined by fungiSMASH. These hits are summarized in the interactive output tables. Gene duplication Since resistant target genes can usually be found as a second copy of the non-resistant ‘normal’ housekeeping target gene, duplication of a housekeeping gene can be an additional indicator for resistant targets (28). To identify duplication events, the median and standard deviation for the orthologs of each essential core gene was calculated and compared to the number in the query genome. All essential genes greater than these thresholds are presented in the duplication section on the result page. Analysis options Several input options provide some flexibility and allow to select or deselect certain analysis options. By default, Ascomycota is selected as the reference set with all criteria and cut-offs. In addition, four other sets are available for analysis. It is also possible to search for known resistance factors and Domain of Unknown Functions (DUF). The ‘exploration mode’ option provides an extended search capability, whereas the 'Advanced' section allows users to upload their custom core genes and resistance HMM models for more customized searches. Output and interactive summary tables Outputs are generated separately for single and multi-genome results in different interactive navigations. These include various sections according to the following criteria: core genes, resistance models, gene duplications, BGC proximity, and BGC networking. Users can prioritise quickly relevant properties and their combinations by searching and sorting in dynamic tables in the different sections. Additionally, expandable rows can be used for each item to investigate more detailed information. Sequence IDs are generated by FunARTS, and the location information provided in the output table is the most reliable and feasible method to match the sequences in the input file. All summary tables can be exported from the 'Export' section and saved for further analysis. FunARTS tables are provided as tsv files, and antiSMASH and BiG-SCAPE results can be visualized in a browser by opening the html-file. Interactive navigation for single results The summary section depicts the number of models and screening criteria hits. Key information such as duplications, BGC proximity, and resistance models are given in the core gene table. Furthermore, functions, average selection pressure (dN/dS) values and affinity with reference organisms (ubiquity) of the essential gene are provided in the table (Supplementary Methods). The proximity table visualizes the BGC table with localized hits such as core genes or DUF. Cluster IDs ensure a link to view the original fungiSMASH results. If available, more information about the core gene model can be found in the hit table by expanding a row. Interactive navigation for multiple results In the first part of the multiple results page, users can find summaries of each run and also click the links in the ‘Organism’ column to navigate through the results for each genome. The data presentation style of multiple results is similar to that of individual results. One exception is the ‘Core Genes’ table which shows the frequency (from ‘0.0’ to ‘1.0’) of hits found in the total input number rather than presence or absence. All clustered BGCs from antiSMASH results are analyzed to determine BGC similarity using the BiG-SCAPE (26) algorithm. During this analysis, the BiG-SCAPE algorithm generates sequence similarity networks of BGCs and classifies them into gene cluster families (GCFs). With an option to access the interactive big scape results page, it is possible to visualize the BGC networks of the clusters.