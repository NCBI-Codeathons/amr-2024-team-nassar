["Materials and Methods", "DNA and RNA Samples", "One female (MNHN-IM-2019-21838) and one male (MNHN-IM-2019-21839) specimen of M. corrugatus were collected in Corsica, France, whereas one female (MNHN-IM-2019-21840) and two male (MNHN-M-2019-21841 and MNHN-IM-2019-21842) specimens of S. haemastoma were collected in Capo Linaro, Italy. The foot (muscular tissue only) and the columellar muscle associated with the cephalopodium (pooled samples 1020.1 and 1020.5) of the M. corrugatus MNHN-IM-2019-21838 were used for DNA sequencing, whereas the heart (samples 1020.2 and 1020.15), kidney (samples 1020.3 and 1020.16), and ctenidium (samples 1020.4 and 1020.17) of each of the two specimens, respectively, were kept for RNA sequencing. For S. haemastoma, the heart, the capsule gland, the gland of Leiblein, the kidney, and ctenidium samples (pooled samples 0620.59, 0620.61, 0620.65, 0620.70, and 0620.72) from the specimen MNHN-IM-2019-21840 were used for DNA sequencing, and the osphradium (samples 0620.38, 0620.51 and 0620.71) and salivary gland (samples 0620.43, 0620.54, and 0620.68) of each of the three specimens, respectively, were kept for RNA sequencing. Samples were sent to Dovetail (Scotts Valley, California, USA) for library preparation, sequencing, assembly, and annotation.", "PacBio Library Preparation, Sequencing, and Assembly", "Both M. corrugatus and S. haemastoma DNA samples were generated following extraction protocol performed at Dovetail (Grohme et al. 2018) and were quantified using Qubit 2.0 Fluorometer (Life Technologies, Carlsbad, CA, USA). The PacBio SMRTbell library (\u223c20\u2005kb) for PacBio Sequel was constructed using SMRTbell Express Template Prep Kit 2.0 (PacBio, Menlo Park, CA, USA) using the manufacturer-recommended protocol. The library was bound to polymerase using the Sequel II Binding Kit 2.0 (PacBio) and loaded onto PacBio Sequel II. Sequencing was performed on three PacBio Sequel II 8 M SMRT cells generating 359 and 195\u2005Gb of data (M. corrugatus and S. haemastoma, respectively). The reads were used as an input to Wtdbg2 v2.5 (Ruan and Li 2020) with a genome size of 3.0gb, a minimum read length of 20\u2005Kb, and a minimum alignment length of 8,192. Additionally, purge_dups v1.2.3 (Guan et al. 2020) was used to remove haplotigs and contig overlaps in the resulted assembly.", "Omni-C Library Preparation, Sequencing, and Scaffolding", "For each Dovetail Omni-C library, chromatin was fixed in formaldehyde in the nucleus and then extracted. Fixed chromatin was digested with DNAse I, chromatin ends were repaired and ligated to a biotinylated bridge adapter followed by proximity ligation of adapter containing ends. After proximity ligation, crosslinks were reversed and the DNA purified. Purified DNA was treated to remove biotin that was not internal to ligated fragments. Sequencing libraries were generated using NEBNext Ultra enzymes and Illumina-compatible adapters. Biotin-containing fragments were isolated using streptavidin beads before PCR enrichment of each library. The libraries were sequenced on an Illumina HiSeqX platform to produce an approximately 30 \u00d7 sequence coverage. The input de novo assemblies and Dovetail OmniC libraries reads were used as input data for HiRise with MQ > 50 as parameter, a software pipeline designed specifically for using proximity ligation data to scaffold genome assemblies (Putnam et al. 2016). Dovetail OmniC library sequences were aligned to the draft input assemblies using BWA (Li and Durbin 2009). The separations of Dovetail OmniC read pairs mapped within draft scaffolds were analyzed by HiRise to produce a likelihood model for genomic distance between read pairs, and the model was used to identify and break putative misjoins, to score prospective joins, and to make joins above a threshold.", "RNA Sequencing", "Total RNA extraction was done using the QIAGEN RNeasy Plus Kit following manufacturer protocols. Total RNA was quantified using Qubit RNA Assay and TapeStation 4200. Prior to library prep, a DNase treatment was performed, followed by AMPure bead cleanup and QIAGEN FastSelect HMR rRNA depletion. Library preparation was done with the NEBNext Ultra II RNA Library Prep Kit following manufacturer protocols. Then, these libraries were run on the NovaSeq6000 platform in 2 \u00d7 150\u2005bp configuration.", "Gene Annotation Pipeline", "Repeat families found in the genome assemblies of M. corrugatus and S. haemastoma were identified de novo and classified using the software package RepeatModeler, v.2.0.1 (Flynn et al. 2020). The custom repeat libraries obtained from RepeatModeler, v.2.0.1 (Flynn et al. 2020), were used to discover, identify, and mask the repeats in the assembly files using RepeatMasker, v.4.1.0 (Smit et al. 2013). CDSs from published annotations (Aplysia californica, Biomphalaria glabrata, Crassostrea virginica, L. gigantea, and Octopus bimaculoides) were used to train the initial ab initio model for both species using the AUGUSTUS software, v.2.5.5 (Stanke et al. 2006). Six rounds of prediction optimization were done with the software package provided by AUGUSTUS, v.2.5.5 (Stanke et al. 2006). The same CDSs were also used to train a separate ab initio model for each genome using SNAP, v.2006-07-28 (Korf 2004). RNAseq reads were mapped onto the genome using the STAR aligner software, v.2.7 (Dobin et al. 2013), and intron hints generated with the bam2hints tool within the AUGUSTUS software, v.2.5.5. MAKER, v3.01.03 (Cantarel et al. 2008), SNAP and AUGUSTUS (with intron-exon boundary hints provided from RNA-Seq) were then used to predict genes in the repeat-masked reference genome. To help guide the prediction process, Swiss-Prot peptide sequences from the UniProt database were downloaded and used in conjunction with the published protein sequences listed above to generate peptide evidence in the Maker pipeline. Only genes that were predicted by both SNAP and AUGUSTUS were retained in the final gene sets.", "Duplications, Syntenic Regions, and Ks Distribution", "Paralogs and orthologs were detected using the BRH method. Briefly, using BLASTp v2.13.0 (Camacho et al. 2009), all proteomes of M. corrugatus, S. haemastoma, C. ventricosus, and P. canaliculata were aligned to each other's with a maximal evalue of 1e\u221210 and at least 50% of one of the two sequences length aligned. Duplications within a species genome (M. corrugatus, S. haemastoma, C. ventricosus, P. canaliculata) and syntenic regions between two different species (pairwise comparison) were assessed using MCScanX v.2 (Wang et al. 2012). First, alignments between proteins from the same species and proteins from two different species were computed using BLASTp v2.13.0 (Camacho et al. 2009) with the parameters \u201cnumber of alignments\u201d equal to 5 and with a \u201cmaximal e-value\u201d of 1e\u221210. The resulted BLAST output and GFF files were given to MCScanX v2 (Wang et al. 2012) scripts (McscanX, duplicate_gene_classifier, detect_collinear_tandem_arrays and dot_plotter) with default parameters. To visualize syntenic regions, online synvisio program (Bandi and Gutwin 2020) was used to generate the figures using the collinearity file resulted from MCScanX v.2. We defined homologous pseudochromosomes within C. ventricosus, M. corrugatus, and S. haemastoma resulting from the syntenic regions shared with P. canaliculata. All orthologs defined by the BRH methods and found in homologous pseudochromosomes had their protein sequences aligned between them using MAFFT v.7.471 with default parameters (Katoh and Frith 2012). Then, the protein multiple alignments were associated to the corresponding DNA sequence into a codon alignment using pal2nal with -nogap option. The number of synonymous substitutions per synonymous sites (Ks) for each BRH were calculated using KaKs_Calculator, v2.0 (Wang et al. 2010). The Ks distribution was plotted using ggplot package from R v3.6.3 (R Core Team 2022) with density function.", "Homeobox Gene Annotations", "Hox genes were specifically annotated in M. corrugatus, S. haemastoma, and in four species representatives of different gastropod subclasses, having their genomes sequenced and available: P. canaliculata (Caenogastropods; Architaenioglossa), Ch. squamiferum (Neomphalina), H. rubra (Vetigastropoda), and L. gigantea (Patellogastropoda). In addition, we annotated Homeobox genes in a Bivalvia species, P. maximus. First of all, we created a database of homeobox genes from different species including Cr. gigas (Zhang et al. 2012), L. goshimai (Huan et al. 2020), Acanthochitona rubrolineata (Huan et al. 2020), C. ventricosus (Pardos-Blas et al. 2021), Elysia marginata (Maeda et al. 2021), and P. canaliculata (full NCBI annotation). Then, the database was aligned against all predicted proteomes considered in this study. From the five best matches, we assigned the predominant function (minimum of three same functions over five). This constituted a second database of homeobox genes, and was aligned again on the same proteomes. Proteins not found in the first round and having more than 60% of identity and aligned on more than 60% of the sequence length were kept. Then, all the proteins detected were mapped on the seven genomes of interest using exonerate v2.2 (Slater and Birney 2005) and all matches were given to Gmove v2 (Dubarry et al. 2016) for automatic annotation. Each predicted homeobox gene was further annotated manually. Briefly, we verified the presence of homeobox domains using CDDsearch (online version, (Marchler-Bauer et al. 2015) and manually annotated the genes regarding the mapping of proteins from the reference database using IGV v2.5.3 (Thorvaldsdottir et al. 2013). The phylogeny of homeobox domains predicted was performed on their multiple alignment using the MAFFT webserver tool with default parameters (Katoh and Frith 2012) and IQ-tree v1.6.12 (Minh et al. 2020).", "Putative Toxins Identification", "All sequences from ConoServer (Kaas et al. 2012) and the sequences annotated with the key words \u201ctoxin\u201d or \u201cvenom\u201d from uniprotKB were mapped on both genomes using BLASTx v2.13.0 (Camacho et al. 2009) with a maximal e-value of 0.001. Next, Exonerate v.2.2 (Slater and Birney 2005) was launched to better align the exons boundaries of the hits identified using BLAST v2.13.0. We then used Gmove (Dubarry et al. 2016) in order to detect possible complete ORF in both genomes. We discarded reverse transcriptases from the analysis after running BLASTp v2.13.0 against NR. Only the putative toxin-coding genes detected in M. corrugatus and S. haemastoma, respectively, and found within syntenic blocks between each species and P. canaliculata were manually annotated using the combination of the online Introproscan domain search (Jones et al. 2014), ConoPrec (Kaas et al. 2012), and the online BLASTp v2.13.0 against NR database (Sayers et al. 2022). From the detected M. corrugatus' putative toxin genes, we further mapped them on the genomes of S. haemastoma, P. canaliculata, and itself to span all possible ortholog and paralogous genes using BLASTx v2.13.0 with an e-value of 1E\u22125 followed by exonerate with default parameters.", "Differential Gene Expression in S. haemastoma", "The analysis of differential gene expression was conducted on the available RNAseq data from S. haemastoma as three replicates were sequenced for each tissue (osphradium and salivary gland). First quality control was performed on each replicates raw reads using fastqc v.0.11.9 (https://www.bioinformatics.babraham.ac.uk/projects/fastqc/) and quality filtered and trimmed using fastp v.0.23.1with default parameters (Chen et al. 2018). Then, cleaned reads were mapped onto the genome sequences of S. haemastoma using STAR v.2.7.10b (Dobin et al. 2013) with the following parameters: \u2013alignIntronMax 1,000 \u2013alignMatesGapMax 10,000, and the addition of the gene annotation file. Each bam file was indexed using samtools v.1.15.1 (Danecek et al. 2021). Read counts were assessed using featureCounts from subread package v.2.0.1 (Liao et al. 2014). Differential gene expression analysis was performed using the R software v.4.2.2 (R Core Team 2022), Bioconductor (Gentleman et al. 2004) packages including DESeq2 v.1.38.1 (Anders and Huber 2010; Love et al. 2014), and the SARTools package v.1.8.1 (Varet et al. 2016). The parameters used for this analysis were the following: fitType parametric, cooksCutoff TRUE, independentFiltering TRUE, alpha 0.05, pAdjustMethod BH, typeTrans VST, and locfunc median. All genes detected as differentially expressed were then realigned on the genome using exonerate v.2.4.0 (Slater and Birney 2005) to check for potential undetected copies in the genomes and compared with our available annotation."]