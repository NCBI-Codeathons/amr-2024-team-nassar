["Methods", "Model creation and optimization", "Three profile hidden Markov models (HMMs) were built to represent two major mechanisms of macrolide resistance: two models for ribosomal target modification by Erm 23S rRNA methyltransferases and one for enzymatic inactivation by Mph macrolide 2\u2032-phosphotransferases. Each model was optimized using fARGene v0.1 [26]. Briefly, for each model, the sensitivity was estimated using leave-one-out cross-validation, and the specificity was estimated using a set of protein sequences that shared a close evolutionary relationship with the resistance determinant, while not conferring the resistance phenotype. Prior to creating the models, protein sequences representing known macrolide resistance genes of the relevant classes were acquired from NCBI GenBank, based on GenBank IDs provided by the official Tetracycline and MLS nomenclature website (accessed October 2019) [16, 27]. To avoid bias when creating the models, such that only the regions responsible for interaction with the macrolide would be considered, the sequences were clustered at 70% amino acid identity using usearch v8.0.1445 with parameters \u2018-cluster_fast -id 0.7\u2019 [28]. Afterwards, the representative centroid sequences for each cluster were subjected to multiple sequence alignment and phylogenetic analysis using the Clustal omega v1.2.4 web client [29].", "As Erm sequences were shown to cluster into two distinct groups in the resulting phylogenetic tree (Fig. S1), it was decided to divide the sequences across two separate models, here denoted Erm type A (mostly sequences from Actinobacteria), and Erm type F (mostly sequences from Firmicutes). Combining all erm genes into a single model resulted in an overall lower sensitivity (results not shown). The models were built using \u2018fargene_model_creation\u2019 from fARGene v0.1 [26], from 16 and 12 representative protein sequences for type A and F, respectively, and a set of 19 protein sequences from the AdoMet MTase superfamily was used to estimate the specificity of both models. The third model, representing Mph macrolide 2\u2032-phosphotransferases, was built from 13 reference sequences, and the specificity was estimated using a set of 49 sequences representing homologues of homoserine kinase II. For all models, domain score thresholds were assigned with the criteria that both sensitivity and specificity should be as high as possible, but with high specificity taking priority over high sensitivity to ensure a low false-positive rate. To further assess the false-positive rates of the models when classifying fragmented data, a simulated metagenome was generated from 1000 randomly selected genomes from NCBI RefSeq, that were shown to not contain macrolide ARGs during the initial analysis. The chosen genomes were fragmented into 10000 paired-end reads 100 bases in length using ART Illumina v2.5 [30], with parameters \u2018-l 100 f 300 m 300 -qL 93 s 0 -na -p\u2019, and the simulated metagenome was analysed with all three HMMs using fARGene v0.1.", "Resistance gene prediction and phylogenetic analysis", "The gene models were used to predict macrolide resistance genes in all genomes from NCBI GenBank (downloaded October 2019) and 14 metagenomic datasets (Table 1) using fARGene v0.1. For each resistance mechanism, the predicted protein sequences and their corresponding reference sequences were clustered into gene families of 70% amino acid sequence identity using usearch v8.0.1445 with parameters \u2018-cluster_fast -id 0.7\u2019 [28]. An outgroup was added to the representative centroid sequences of each cluster, which were then aligned using mafft v7.23 [31], with default parameters. The outgroup used for the mph genes represented aph(2\u2019\u2019) genes (as in Pawlowski et al. [14]), and for the erm genes represented ksgA genes. Phylogenetic trees representing each macrolide resistance mechanism were generated from the alignments using FastTree v2.1.10 [32] using default parameters. The trees were re-rooted at the desired outgroup and visualized using the Interactive Tree of Life web client [33] and ggtree v2.0.1 [34]. From the analysis of the phylogenetic tree, it was noted that the Erm models still misclassified some KsgA sequences as Erm. These KsgA sequences could not be removed by adjusting the domain score threshold in fARGene without also discarding previously known erm genes, but the KsgA sequences were identifiably based on their location in the phylogenetic tree and omitted from further analysis. After analysis of the entire genomic and metagenomic dataset, the number of genes classified as KsgA totalled 0.67% of predicted ARG sequences for these profile HMMs, which was considered acceptable.", "Summary of predicted macrolide resistance genes and the analysed datasets. Numbers within brackets indicate the number of genomes or metagenomic samples associated with each dataset", "Erm Erm Mph Mph.", "Erm", "Erm", "Mph", "Mph", "Dataset Size (nt) Genes Families\na,b Genes Families\na,b Ref..", "Dataset", "Size (nt)", "Genes", "Families\na,b", "Genes", "Families\na,b", "Ref.", "Genomic.", "Genomic", "NCBI RefSeq [15,438] 6.21\u00d71010 330 10/21 1107 13/59 [68].", "NCBI RefSeq [15,438]", "6.21\u00d71010", "330", "10/21", "1107", "13/59", "[68]", "NCBI Assembly [412,184] 1.71\u00d71012 12423 29/314 14033 14/210 [69].", "NCBI Assembly [412,184]", "1.71\u00d71012", "12423", "29/314", "14033", "14/210", "[69]", "Metagenomic.", "Metagenomic", "HMP [757] 4.69\u00d71012 82 7/7 8 1/1 [42].", "HMP [757]", "4.69\u00d71012", "82", "7/7", "8", "1/1", "[42]", "Human gut 1 [170] 1.93\u00d71011 15 6/5 2 1/1 [44].", "Human gut 1 [170]", "1.93\u00d71011", "15", "6/5", "2", "1/1", "[44]", "Human gut 2 [114] 1.32\u00d71012 14 7/3 2 1/1 [43].", "Human gut 2 [114]", "1.32\u00d71012", "14", "7/3", "2", "1/1", "[43]", "Pig gut [295] 1.74\u00d71012 145 10/9 17 1/0 [45].", "Pig gut [295]", "1.74\u00d71012", "145", "10/9", "17", "1/0", "[45]", "Wild baboon gut [48] 1.37\u00d71011 0 0/0 0 0/0 [70].", "Wild baboon gut [48]", "1.37\u00d71011", "0", "0/0", "0", "0/0", "[70]", "Wild rhino gut [17] 6.21\u00d71010 0 0/0 0 0/0 [71].", "Wild rhino gut [17]", "6.21\u00d71010", "0", "0/0", "0", "0/0", "[71]", "WWTP [70] 4.82\u00d71011 49 6/35 8 4/4 [46].", "WWTP [70]", "4.82\u00d71011", "49", "6/35", "8", "4/4", "[46]", "Pune river [62] 3.91\u00d71011 45 6/33 13 4/7 [47].", "Pune river [62]", "3.91\u00d71011", "45", "6/33", "13", "4/7", "[47]", "Tara oceans [245] 4.89\u00d71012 2 0/2 1 0/1 [72].", "Tara oceans [245]", "4.89\u00d71012", "2", "0/2", "1", "0/1", "[72]", "Antarctic soil [3] 6.25\u00d7109 0 0/0 0 0/0 [73].", "Antarctic soil [3]", "6.25\u00d7109", "0", "0/0", "0", "0/0", "[73]", "Forest soil [36] 1.99\u00d71011 6 1/5 6 3/2 [48].", "Forest soil [36]", "1.99\u00d71011", "6", "1/5", "6", "3/2", "[48]", "Oilspill [13] 2.75\u00d71011 0 0/0 0 0/0 [74].", "Oilspill [13]", "2.75\u00d71011", "0", "0/0", "0", "0/0", "[74]", "Lake Hazen [8] 2.75\u00d71011 32 0/21 0 0/0 [49].", "Lake Hazen [8]", "2.75\u00d71011", "32", "0/21", "0", "0/0", "[49]", "Amazon river [106] 2.88\u00d71011 0 0/0 0 0/0 [75].", "Amazon river [106]", "2.88\u00d71011", "0", "0/0", "0", "0/0", "[75]", "Total 1.67\u00d71013 13143 30/392\n\nc 15197 14/227\nc.", "Total", "1.67\u00d71013", "13143", "30/392\n\nc", "15197", "14/227\nc", "", "a, Amino acid identity <70%.", "b, Known/new.", "c, Non-redundant.", "HMP, Human Microbiome Project; WWTP, Wastewater treatment plant.", "Experimental validation", "Potential macrolide ARGs were synthesized by the GeneArt gene synthesis service provided by Thermo Fisher Scientific. The genes were amplified by PCR using primers including the SacI and XbaI restriction sites to the 5\u2032 and 3\u2032 extremities, respectively. The PCR fragments were digested and cloned into the l-arabinose-inducible pBADb vector \u2013 previously digested with the same restriction enzymes \u2013 using the T4 DNA ligase (Thermo Fisher). Ligation products were transformed by heat shock into chemically competent \n\nE. coli\n\n TOP10 (Invitrogen, Thermo Fisher Scientific). The growth behaviour of the different clones was determined using a range of concentrations (0.125\u2013256 \u00b5g ml\u22121) of two macrolides antibiotics \u2013 erythromycin and azithromycin \u2013 using the Omnilog system (Biolog). Bacteria were grown in 96-well plates in Mueller\u2013Hinton broth supplemented with 0.1% of l-arabinose to express the cloned ARGs and ampicillin (50 \u00b5g ml\u22121) to maintain the recombinant plasmid during the incubation. Redox dye A (Biolog) was added to the wells to detect and quantify the number of living cells during the incubation. Metabolic activity was measured every 15 min by analysing the colour change caused by the reduction of the dye. Growth curves and standard deviations were calculated from the mean of three independent experiments. To optimize sensitivity, growth fold-changes were calculated from the Omnilog signal at 15 h of incubation at 32 \u00b5g l\u22121 erythromycin and 2 \u00b5g l\u22121 azithromycin for each tested ARG (representing the highest concentrations for which growth was observed in the control strain and a fixed time where the differences in growth between the strains, in general, were clear). The estimated fold-change was based on the mean of the three independent replicates of the tested ARG, and the mean of four independent replicates of a negative control with the native pBADb plasmid without inserted ARG.", "Statistical analysis", "To investigate whether different taxonomic groups were over- or under-represented among carriers of macrolide ARGs, phylum enrichment analysis was performed. All unique species that were found to carry at least one macrolide resistance gene were divided into groups based on their phylum, and whether they carried a known or a new resistance gene. A gene was classified as known if it displayed >79% amino acid identity to any known macrolide ARG, based on the established nomenclature [16]. The number of species within each group was then counted and compared to the total number of species from the same phylum represented in the database using Fisher\u2019s exact test. A test with a p-value <0.001 was considered significant.", "To test whether the ARGs selected for experimental validation resulted in a significant increase in growth, p-values were calculated using a one-sided two-sample t-test. This was done using the Omnilog signal of the replicates of ARG and negative control at 15 h of incubation, at 32 \u00b5g l\u22121 erythromycin and 2 \u00b5g l\u22121 azithromycin for each tested ARG.", "Genetic context analysis", "Genomes from NCBI GenBank that were found to contain new macrolide ARGs of high interest were downloaded and a region of up to 20 kb upstream and downstream of each ARG was retrieved and annotated using GEnView [35]. Sequences that were either indicated to represent mobile genetic elements or annotated as hypothetical proteins were searched using ISFinder (accessed Dec 2020) [36] and NCBI blastx v2.11.0 [37]. Further, all retrieved genetic regions were translated in all six reading frames using emboss Transeq v6.5.7.0 [29] and analysed with 22 profile HMMs designed to identify conjugation systems, acquired from the MacSyfinder CONJScan v2.0 module [38], using hmmer v3.1b2 [39]. Finally, the full contigs in which these ARGs were found were obtained from NCBI GenBank [27] and analysed using ResFinder v4.0 [40] to identify co-localized ARGs. To identify plasmid-types associated with specific resistance genes, contigs carrying these were obtained from NCBI and analysed using PlasmidFinder v2.0 [41]."]