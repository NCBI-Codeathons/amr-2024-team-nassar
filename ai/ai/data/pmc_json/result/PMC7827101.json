["2. Results", "2.1. Natural Product Annotation in UniProtKB", "UniProtKB now uses the Rhea knowledgebase of biochemical transformations and transport reactions, itself built on the chemical ontology ChEBI, as the standard for the annotation of enzymes and transporters (Figure 2) [23]. Rhea and ChEBI provide computationally tractable knowledge of small molecule metabolites and their transformations and movements in UniProtKB-facilitating metabolomic data integration with that from proteomics, transcriptomics, and genomics, as well as a broad range of data mining operations, some of which we will see later. At the time of writing (UniProtKB release 2020_06 of December 2020), UniProtKB/Swiss-Prot, the curated section of UniProtKB (see Section 4.2 and Section 4.3), contains 220,656 enzyme sequences annotated with Rhea reactions, while UniProtKB/TrEMBL, the unreviewed section of UniProtKB annotated using computational means, contains more than 22 million enzyme sequences linked to Rhea reactions (as described in Section 4.4). Enzyme annotations in UniProtKB as a whole cover 8708 unique Rhea reactions involving 8022 unique ChEBI compounds. Enzyme annotation in UniProtKB, like all curation, is an ongoing process with new data released every two months. Because of the biological and pharmaceutical potential of natural products as well as the interest expressed by the NP community, we are working to improve the coverage of natural product metabolism in UniProtKB using Rhea and recently launched a dedicated annotation program that focuses specifically on secondary metabolism in fungi and plants.", "ChEBI is a chemical ontology of a broad scope that includes both primary metabolites and secondary metabolites or natural products. To assess the coverage of natural products in ChEBI, Rhea, and UniProtKB, we compared all chemical structures in ChEBI to those in two reference resources of natural products, The Natural Product Atlas (www.npatlas.org) [15] and COCONUT (coconut.naturalproducts.net) [16,17]. We mapped chemical structures from ChEBI to The Natural Product Atlas and COCONUT using their InChIKeys\u2014a hash representation of the chemical structure that is particularly suited for chemical structure searching [26] (see Section 2.2.1 for more on InChIKeys, which can also be used to search UniProtKB). Of the 8022 unique ChEBI compounds used in UniProtKB-Rhea annotations, 1052 ChEBI entries (13% of the total) are found in either The Natural Product Atlas or COCONUT or both. In other words, we have linked 1052 presumed natural products from ChEBI to their cognate enzymes in UniProtKB to date. The Natural Products Atlas clusters compounds that share very high structural similarity, providing a way to quickly find other compounds that are closely related to a given compound of interest. Of the 1052 natural products from ChEBI that are curated in UniProtKB/Swiss-Prot, 261 are mapped to 171 clusters of natural product structures in The Natural Products Atlas: these clusters include a total of 4542 natural product structures. This defines a possible upper bound on the number of relevant enzyme-natural product structure links that can be derived using UniProtKB/Swiss-Prot and The Natural Products Atlas at the current time. ChEBI release 191 of September 2020 includes a total of 105,802 ChEBI entries with fully defined structures, of which 11,422 ChEBI entries (10.7% of the total) are found in either The Natural Product Atlas or COCONUT or both. UniProtKB/Swiss-Prot annotations currently cover around 10% of these, thus there is clearly great scope to expand the coverage of natural product structures in ChEBI, Rhea, and UniProtKB; some strategies for doing so are discussed in Section 3, \u201cConclusions and Perspectives\u201d.", "2.2. Data Access", "In this section, we look at ways to access protein knowledge relating to natural products either interactively, using the UniProt website, or programmatically, using the UniProt REST API or SPARQL endpoint.", "2.2.1. The UniProt Website", "The UniProt website (www.uniprot.org) constitutes the main point of entry for most UniProt users and provides a range of simple and advanced search options [23,27]. We demonstrate some of these options using examples from the patulin biosynthetic pathway (Figure 3). Patulin is an acetate-derived tetraketide mycotoxin produced by Penicillium expansum and several related fungal species. It is the most common mycotoxin found in apples and apple-derived products and shows antimicrobial properties against several bacteria. The patulin BGC from Penicillium expansum is composed of 15 genes encoding 11 enzymes, three transporters, and one BGC-specific transcription factor [28]. Its biosynthesis is quite well studied, and all relevant information has been captured in UniProtKB, Rhea, and ChEBI through expert curation.", "The easiest way to search UniProt is to use the simple search tool, which accepts text (including natural language or identifiers) and boolean operators. A query with a single term\u2014patulin\u2014returns a list of all UniProtKB protein sequence records containing this word in any annotation field or topic(s) (Figure S1). One way to limit the search to proteins that actually interact with or metabolize patulin itself is to search using the chemical structure of patulin encoded as an InChIKey, a hash representation of a chemical structure that is composed of three blocks [26]. These can be understood using the InChIKey for patulin, which is ZRWPUFFVAOMMNM-UHFFFAOYSA-N; the first block of 14 characters (ZRWPUFFVAOMMNM) encodes information on connectivity, the second block of 10 characters (UHFFFAOYSA) encodes information on stereochemistry, and the third block of one character (N) encodes information on charge (N for neutral, M for \u22121, O for +1, and so on). A more complete description of InChIKey is available at www.inchi-trust.org. Chemical structure searches in UniProtKB can be performed with full or partial InChIKey\u2014either the first block only (ZRWPUFFVAOMMNM for patulin) or both the first and second blocks (ZRWPUFFVAOMMNM-UHFFFAOYSA). These options allow users to deal with ambiguity surrounding stereochemistry and charge states, respectively.", "A second way to limit the search to proteins that actually interact with or metabolize patulin itself is to search using the chemical identifier for patulin from ChEBI (which is CHEBI:74926). Chemical identifier searches leverage the relationships encoded in the ChEBI ontology, allowing users to expand their search to include all members of defined chemical classes, such as the gamma lactones (CHEBI:37581), of which patulin is one member. Note that ChEBI assigns a distinct identifier to each charge state of a given structure; UniProt deals with this by mapping each ChEBI identifier searched to that of the major microspecies at pH 7.3, which is the form used in Rhea and UniProtKB annotations. This mapping is performed during the search, using a mapping file provided by Rhea (at www.rhea-db.org/help/download). Further information about chemical data search in UniProtKB can be found in our online documentation at www.uniprot.org/help/chemical_data_search.", "Users can refine searches by applying suggested filters (Figures S2 and S3), personalize the content displayed in columns (Figures S4 and S5), and download all or selected matched protein entries in a variety of formats (Figure S6) including XML, RDF/XML or text (for UniProt entries), FASTA (for UniProt sequences), tab-delimited or excel table (for personalized result lists), and GFF (for sequence features). Another way to perform more fine-grained searches is by using our advanced query builder (accessed from the front page), which allows users to define search fields for terms, to link search term/field combinations using boolean operators, and to specify the level of evidence required for a match\u2014such as requiring experimental evidence for some annotation. Figure 4 shows the advanced search tool on www.uniprot.org being used to build a query for fungal oxidoreductases that are proven to metabolize malonyl-CoA, a precursor of many polyketide natural products including patulin, and for which protein structure data are available. We search for malonyl-CoA using the first two layers of the InChIKey (LTYOQGRJFJAKNA-DVVLENMVSA, thereby disregarding charge), specify the fungal taxon using the appropriate identifier from the NCBI taxonomy (TaxID:4751), oxidoreductase function using the Gene Ontology (GO:0016491), and the required cross-reference to the PDB (without additional metadata).", "2.2.2. Programmatic Access to UniProt-REST API", "The UniProt website has RESTful URLs that can be bookmarked, linked, and used in programs for all entries, queries, and tools available through the website (see details at www.uniprot.org/help/programmatic_access). Table 1 provides the URLs for each of the queries described in the preceding section.", "2.2.3. Programmatic Access to UniProt-SPARQL", "All UniProt data are available in RDF, a core semantic web technology for the World Wide Web Consortium that is well suited to applications in distributed environments (see www.w3.org/RDF/ for more details). The UniProt SPARQL endpoint (sparql.uniprot.org/sparql) allows users to perform complex queries on UniProt RDF data and to combine UniProt RDF data in real time with RDF data from other resources providing SPARQL endpoints, through so-called \u201cfederated queries\u201d. Resources that provide SPARQL endpoints that may be of particular interest in natural product research and that are highly complementary to UniProt, include Rhea [23,24], the Integrated Database of Small Molecules (IDSM) [29], which supports chemical similarity and chemical substructure searches over ChEBI and other chemical structure databases, the OMA [30] and OrthoDB [31] resources of orthologous groups, and the MetaNetX resource of genome-scale metabolic models [32]. A tutorial for querying these resources with SPARQL is available at edu.sib.swiss/course/view.php?id=440.", "We illustrate some of the advantages of SPARQL using a sample federated query that uses the UniProt, Rhea, and IDSM SPARQL endpoints to perform chemical similarity searches, extending the simple InChIKey-based structure searches that are possible using the UniProt website and REST API (Figure 5 and Figure S7). Note that chemical similarity searching is not supported by the UniProt website or REST API-IDSM and Rhea \u201clend\u201d this functionality on the fly to the UniProt SPARQL endpoint, through query federation, allowing an end-user of the system to act as if they are using a single integrated database. The query shown in Figure S7 will retrieve all enzymes annotated in UniProtKB/Swiss-Prot that metabolize compounds similar to patulin\u2014but not necessarily identical to patulin. The query uses the SMILES representation (Simplified Molecular-Input Line-Entry System) (opensmiles.org) of patulin, as required for structure searches by IDSM, and uses the sachem:similaritySearch procedure call pattern developed by the IDSM team [33] with a similarity score threshold of 0.8 (the similarity score is based on Jaccard similarity of Morgan-style connectivity fingerprints). The query is designed with two nested services (\u201ccalls\u201d) as illustrated in Figure 5. It is run from the UniProt SPARQL endpoint, which first \u201ccalls\u201d the Rhea SPARQL endpoint, which itself \u201ccalls\u201d the IDSM SPARQL endpoint. The results of this query are available at tinyurl.com/sparql-uniprot and include enzymes that metabolize neopatulin (CHEBI:145111), such as patD and patF, and (E)-ascladiol (CHEBI:145112), such as patD and patE. To see SPARQL in action simply copy-paste the query shown in Figure S7 into sparql.uniprot.org/sparql and run it."]