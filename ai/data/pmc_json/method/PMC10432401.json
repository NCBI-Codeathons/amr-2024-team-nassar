["Materials and methods", "Origin and characteristics of the analyzed metagenomes", "For this study, we analyzed publicly available metagenomic DNA sequences of freshwater and wastewater bacterial communities downloaded from SRA (sequence read archive; https://www.ncbi.nlm.nih.gov/sra). The picked sequences exclusively represent DNA fragments generated by the shotgun technique which does not involve amplification of particular targets, that is, the \u201cselection\u201d attribute of the sequencing library had to be \u201crandom\u201d. For consistent processing and comparability, only samples that were sequenced on an Illumina instrument in paired-end layout were included. The latter integrate wastewater and freshwater samples from the temperate zone such that, in each category, at least five different countries are represented. The analyzed data consist of 324 distinct samples from the US, UK, New Zealand, China, Canada, Sweden, and Germany (Table\u00a01). Full accession and metainformation is provided in the supplement Table S1. In total, the data comprise about 7\u2009\u00d7\u2009109 high quality read pairs. Freshwater samples were subdivided into two categories (unpolluted, polluted) based on the exposure of the respective sampling sites to effluents from municipal wastewater treatment plant effluents where sufficient on-site information was available (dataset \u201cq\u201d in Table\u00a01). A further distinction was made between water and sediment samples.Table 1Characteristics of the analyzed data sets.MatrixCountryStudySamplesSitesReadsBasesRead length16SWWTP influentCDPRJNA768945 (a)813e\u2009+\u2009076e\u2009+\u2009092081e\u2009+\u200904WWTP influentCNPRJNA824545 (p)417e\u2009+\u2009072e\u2009+\u2009102309e\u2009+\u200904WWTP influentDEPRJNA524094 (d)1422e\u2009+\u2009086e\u2009+\u2009102615e\u2009+\u200905WWTP influentDEPRJNA942078 (r)1494e\u2009+\u2009081e\u2009+\u2009112591e\u2009+\u200906WWTP influentNZPRJNA904380 (e)911e\u2009+\u2009084e\u2009+\u2009102785e\u2009+\u200905WWTP influentUSPRJNA683044 (i)811e\u2009+\u2009084e\u2009+\u2009102694e\u2009+\u200905WWTP influentUSPRJNA691978 (n)312e\u2009+\u2009075e\u2009+\u2009092117e\u2009+\u200904WWTP effluentCDPRJNA768945 (a)813e\u2009+\u2009076e\u2009+\u2009092111e\u2009+\u200904WWTP effluentCNPRJNA824545 (p)418e\u2009+\u2009072e\u2009+\u2009102414e\u2009+\u200904WWTP effluentDEPRJNA524094 (d)1322e\u2009+\u2009086e\u2009+\u2009102731e\u2009+\u200905WWTP effluentDEPRJNA892917 (q)912e\u2009+\u2009085e\u2009+\u2009102631e\u2009+\u200905WWTP effluentNZPRJNA904380 (e)911e\u2009+\u2009084e\u2009+\u2009102812e\u2009+\u200905WWTP effluentSEPRJEB14051 (g)638e\u2009+\u2009071e\u2009+\u2009101449e\u2009+\u200904WWTP effluentUKPRJNA529503 (h)811e\u2009+\u2009083e\u2009+\u2009102412e\u2009+\u200905WWTP effluentUSPRJNA683044 (i)1012e\u2009+\u2009085e\u2009+\u2009102701e\u2009+\u200905River waterCNPRJNA559231 (b)30277e\u2009+\u2009082e\u2009+\u2009112718e\u2009+\u200905River waterCNPRJNA798157 (c)332e\u2009+\u2009084e\u2009+\u2009102572e\u2009+\u200905River waterDEPRJNA892917 (q)1494e\u2009+\u2009089e\u2009+\u2009102522e\u2009+\u200905River waterNZPRJNA668816 (f)226e\u2009+\u2009073e\u2009+\u2009104498e\u2009+\u200904River sedimentCNPRJNA559231 (b)32258e\u2009+\u2009082e\u2009+\u2009112614e\u2009+\u200905River sedimentCNPRJNA798157 (c)332e\u2009+\u2009085e\u2009+\u2009102438e\u2009+\u200904River sedimentDEPRJNA892917 (q)68182e\u2009+\u2009094e\u2009+\u2009112579e\u2009+\u200905River sedimentNZPRJNA668816 (f)621e\u2009+\u2009086e\u2009+\u2009104268e\u2009+\u200904River sedimentUKPRJNA529503 (h)719e\u2009+\u2009072e\u2009+\u2009102505e\u2009+\u200904River sedimentUSPRJEB23134 (m)1612e\u2009+\u2009086e\u2009+\u2009102681e\u2009+\u200905River sedimentUSPRJNA795480 (k)16151e\u2009+\u2009082e\u2009+\u2009102326e\u2009+\u200904Studies are denoted by their SRA identifiers; lower case letters were added for convenient references within this publication. The number of reads, bases, and the average read length represent the state after quality-trimming and merging of read pairs. The number of 16\u2009S rRNA gene copies is indicated in column \u201c16\u2009S\u201d. See Table S1 in the supplementary material for full metainformation on individual samples, including SRA run accession numbers.", "Characteristics of the analyzed data sets.", "Matrix Country Study Samples Sites Reads Bases Read length 16S.", "WWTP influent CD PRJNA768945 (a) 8 1 3e\u2009+\u200907 6e\u2009+\u200909 208 1e\u2009+\u200904.", "WWTP influent CN PRJNA824545 (p) 4 1 7e\u2009+\u200907 2e\u2009+\u200910 230 9e\u2009+\u200904.", "WWTP influent DE PRJNA524094 (d) 14 2 2e\u2009+\u200908 6e\u2009+\u200910 261 5e\u2009+\u200905.", "WWTP influent DE PRJNA942078 (r) 14 9 4e\u2009+\u200908 1e\u2009+\u200911 259 1e\u2009+\u200906.", "WWTP influent NZ PRJNA904380 (e) 9 1 1e\u2009+\u200908 4e\u2009+\u200910 278 5e\u2009+\u200905.", "WWTP influent US PRJNA683044 (i) 8 1 1e\u2009+\u200908 4e\u2009+\u200910 269 4e\u2009+\u200905.", "WWTP influent US PRJNA691978 (n) 3 1 2e\u2009+\u200907 5e\u2009+\u200909 211 7e\u2009+\u200904.", "WWTP effluent CD PRJNA768945 (a) 8 1 3e\u2009+\u200907 6e\u2009+\u200909 211 1e\u2009+\u200904.", "WWTP effluent CN PRJNA824545 (p) 4 1 8e\u2009+\u200907 2e\u2009+\u200910 241 4e\u2009+\u200904.", "WWTP effluent DE PRJNA524094 (d) 13 2 2e\u2009+\u200908 6e\u2009+\u200910 273 1e\u2009+\u200905.", "WWTP effluent DE PRJNA892917 (q) 9 1 2e\u2009+\u200908 5e\u2009+\u200910 263 1e\u2009+\u200905.", "WWTP effluent NZ PRJNA904380 (e) 9 1 1e\u2009+\u200908 4e\u2009+\u200910 281 2e\u2009+\u200905.", "WWTP effluent SE PRJEB14051 (g) 6 3 8e\u2009+\u200907 1e\u2009+\u200910 144 9e\u2009+\u200904.", "WWTP effluent UK PRJNA529503 (h) 8 1 1e\u2009+\u200908 3e\u2009+\u200910 241 2e\u2009+\u200905.", "WWTP effluent US PRJNA683044 (i) 10 1 2e\u2009+\u200908 5e\u2009+\u200910 270 1e\u2009+\u200905.", "River water CN PRJNA559231 (b) 30 27 7e\u2009+\u200908 2e\u2009+\u200911 271 8e\u2009+\u200905.", "River water CN PRJNA798157 (c) 3 3 2e\u2009+\u200908 4e\u2009+\u200910 257 2e\u2009+\u200905.", "River water DE PRJNA892917 (q) 14 9 4e\u2009+\u200908 9e\u2009+\u200910 252 2e\u2009+\u200905.", "River water NZ PRJNA668816 (f) 2 2 6e\u2009+\u200907 3e\u2009+\u200910 449 8e\u2009+\u200904.", "River sediment CN PRJNA559231 (b) 32 25 8e\u2009+\u200908 2e\u2009+\u200911 261 4e\u2009+\u200905.", "River sediment CN PRJNA798157 (c) 3 3 2e\u2009+\u200908 5e\u2009+\u200910 243 8e\u2009+\u200904.", "River sediment DE PRJNA892917 (q) 68 18 2e\u2009+\u200909 4e\u2009+\u200911 257 9e\u2009+\u200905.", "River sediment NZ PRJNA668816 (f) 6 2 1e\u2009+\u200908 6e\u2009+\u200910 426 8e\u2009+\u200904.", "River sediment UK PRJNA529503 (h) 7 1 9e\u2009+\u200907 2e\u2009+\u200910 250 5e\u2009+\u200904.", "River sediment US PRJEB23134 (m) 16 1 2e\u2009+\u200908 6e\u2009+\u200910 268 1e\u2009+\u200905.", "River sediment US PRJNA795480 (k) 16 15 1e\u2009+\u200908 2e\u2009+\u200910 232 6e\u2009+\u200904.", "Studies are denoted by their SRA identifiers; lower case letters were added for convenient references within this publication. The number of reads, bases, and the average read length represent the state after quality-trimming and merging of read pairs. The number of 16\u2009S rRNA gene copies is indicated in column \u201c16\u2009S\u201d. See Table S1 in the supplementary material for full metainformation on individual samples, including SRA run accession numbers.", "Bioinformatics", "Processing of raw sequence data and short read analyses", "All samples were processed through the same bioinformatics pipeline involving the simultaneous removal of purely technical sequences and the suppression of low quality reads using Trim Galore [34] (requested phred score: 28, minimum read length: 100\u2009bp). Paired-end reads were subsequently merged with pandaseq [35] employing the default configuration to obtain sequences with a typical average length of 262\u2009bp (see Table\u00a01 for variation). Using BLASTN (http://blast.ncbi.nlm.nih.gov), the merged sequences were aligned against a collection of the currently known dfrB sequences (Table S2) and against the resfinder [36] database of acquired antibiotic resistance genes available from the Center for Genomic Epidemiology (http://www.genomicepidemiology.org/). Only high quality alignments were retained by requesting a minimum match length of 50\u2009bp and a sequence identity \u226595%. The merged reads were further processed through metaxa2 [37] to analyze the composition of the bacterial community based on 16\u2009S rRNA gene fragments. Reads being tested positive for dfrB were also scanned for the signatures of integrons using the IntegronFinder [38] application provided by the Pasteur Institute, France, as a galaxy-based web service (https://galaxy.pasteur.fr). The same reads were also aligned against the ISfinder [39] database of insertion sequences maintained by the Laboratoire de Microbiologie et G\u00e9n\u00e9tique Mol\u00e9culaires, Toulouse, France, using their web service at https://www-is.biotoul.fr/index.php.", "Assembly and analysis of the flanking regions of dfrB genes", "Because of the limited read length, it is difficult to identify the genetic context of dfrB genes exclusively from original short read data. Consequently, gene context analyses call for metagenome assembly which is challenging, not least due to the exceptionally high demand for computer memory (RAM). Even if the assembly succeeds technically, a substantial extension of the sequences of primary interest is not necessarily guaranteed. This is especially so for low-coverage metagenomes of highly diverse microbial communities [40]. Consequently, we implemented an algorithm that specifically targets the assembly of the flanking regions of dfrB-like sequences. Briefly, a collection of the reads giving specific hits for dfrB variants was built by an initial run of BLASTN. Those reads served as \u201cseeds\u201d in a subsequent process of iterative sequence extension. In each iteration, the algorithm searches the remaining pool of yet \u201cunused\u201d reads for candidates allowing for a plausible extension of the seed sequence (in iteration 1) or the outcome of earlier iterations according to sequence similarity in overlapping parts (min. 50\u2009bp overlap). The algorithm relies on BLASTN as the workhorse for sequence alignments and, due to the targeted focus on specific seeds, RAM usage remains very low. The source code of the seed-based assembler was made publicly available at https://github.com/dkneis/close2gene together with basic documentation and a minimum working example. Overall, our seed-based approach turned out to be very close to the one implemented in GenSeed [41], a software which we only detected later.", "From the assembled contigs, the seeds (i.e., the dfrB) were finally removed and the remaining flanking sequences were fed into BLASTX (http://blast.ncbi.nlm.nih.gov) to identify the genetic context of dfrB at protein level. The flanking sequences were also scanned for insertion sequences as outlined for the original short reads. Very short assemblies of <250\u2009bp after removal of the dfrB seed sequence were excluded from downstream analysis.", "Statistical analysis", "General methods", "Statistical data analysis and visualization was performed in R [42] version 4.2.1. Principal component analysis was performed in base R (prcomp) using power-transformed relative abundances as input (power 0.2). Shifts in locations were assessed by means of the non-parametric Wilcoxon rank sum test (wilcox.test). The significance of differences in odds ratios was analyzed with Fisher\u2019s exact test (fisher.test). Finally, confidence of relative abundance estimates were obtained from an exact binomial test (binom.test). Whenever multiple, logically connected hypotheses were tested simultaneously, the corresponding p values were adjusted to control the false discovery rate [43].", "Correlations between ARGs and 16S rRNA-based species markers", "Demonstrating statistical associations between ARG abundances and bacterial community composition is difficult when sample sizes are unequal. The intuitive solution is to employ normalization so as to achieve comparable counts of ARGs and taxonomic markers across samples, that is, the counts are divided by the total number of 16\u2009S rRNA gene copies in the respective sample. While such normalization is very common, it is often overlooked that the obtained relative abundances are unsuitable for correlation analysis [44]. Unfortunately, valid alternatives to correlation like, for example, log ratio analyses, are not applicable either because the number of detected ARG copies is zero in a notable fraction of samples. In view of this challenge, we performed correlation analyses on the original count data (i.e., without normalization) using a downsampling approach to account for unequal sample sizes. Specifically, we identified the 10% quantile of 16\u2009S rRNA gene copies across the considered samples (Q10). Samples with fewer than Q10 copies were subsequently discarded. For the remaining samples, we studied the correlation between ARG counts and 16\u2009S rRNA gene counts attributed to a certain bacterial group after random-driven truncation to the common length Q10. The process was repeated 250 times and the median of the correlation coefficient (Spearman\u2019s rho) was finally evaluated."]