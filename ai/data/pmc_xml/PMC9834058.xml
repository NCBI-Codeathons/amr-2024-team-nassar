<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" article-type="research-article" dtd-version="1.3"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Ecol Evol</journal-id><journal-id journal-id-type="iso-abbrev">Nat Ecol Evol</journal-id><journal-title-group><journal-title>Nature Ecology &#x00026; Evolution</journal-title></journal-title-group><issn pub-type="epub">2397-334X</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">9834058</article-id><article-id pub-id-type="pmid">36604553</article-id><article-id pub-id-type="publisher-id">1932</article-id><article-id pub-id-type="doi">10.1038/s41559-022-01932-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Detecting macroevolutionary genotype&#x02013;phenotype associations using error-corrected rates of protein convergence</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2353-9274</contrib-id><name><surname>Fukushima</surname><given-names>Kenji</given-names></name><address><email>kenji.fukushima@uni-wuerzburg.de</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7627-4214</contrib-id><name><surname>Pollock</surname><given-names>David D.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.8379.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 1958 8658</institution-id><institution>Institute for Molecular Plant Physiology and Biophysics, </institution><institution>University of W&#x000fc;rzburg, </institution></institution-wrap>W&#x000fc;rzburg, Germany </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.430503.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0703 675X</institution-id><institution>Department of Biochemistry and Molecular Genetics, </institution><institution>University of Colorado School of Medicine, </institution></institution-wrap>Aurora, CO USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.451303.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2218 3491</institution-id><institution>Biological Sciences Division, Earth and Biological Sciences Directorate, </institution><institution>Pacific Northwest National Laboratory, </institution></institution-wrap>Richland, WA USA </aff></contrib-group><pub-date pub-type="epub"><day>5</day><month>1</month><year>2023</year></pub-date><pub-date pub-type="pmc-release"><day>5</day><month>1</month><year>2023</year></pub-date><pub-date pub-type="ppub"><year>2023</year></pub-date><volume>7</volume><issue>1</issue><fpage>155</fpage><lpage>170</lpage><history><date date-type="received"><day>31</day><month>3</month><year>2022</year></date><date date-type="accepted"><day>12</day><month>10</month><year>2022</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2023</copyright-statement><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">On macroevolutionary timescales, extensive mutations and phylogenetic uncertainty mask the signals of genotype&#x02013;phenotype associations underlying convergent evolution. To overcome this problem, we extended the widely used framework of non-synonymous to synonymous substitution rate ratios and developed the novel metric <italic>&#x003c9;</italic><sub><italic>C</italic></sub>, which measures the error-corrected convergence rate of protein evolution. While <italic>&#x003c9;</italic><sub><italic>C</italic></sub> distinguishes natural selection from genetic noise and phylogenetic errors in simulation and real examples, its accuracy allows an exploratory genome-wide search of adaptive molecular convergence without phenotypic hypothesis or candidate genes. Using gene expression data, we explored over 20 million branch combinations in vertebrate genes and identified the joint convergence of expression patterns and protein sequences with amino acid substitutions in functionally important sites, providing hypotheses on undiscovered phenotypes. We further extended our method with a heuristic algorithm to detect highly repetitive convergence among computationally non-trivial higher-order phylogenetic combinations. Our approach allows bidirectional searches for genotype&#x02013;phenotype associations, even in lineages that diverged for hundreds of millions of years.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">The authors develop a new metric to measure the error-corrected convergence rate of protein evolution, together with a heuristic algorithm to detect signals of adaptive protein convergence.</p></abstract><kwd-group kwd-group-type="npg-subject"><title>Subject terms</title><kwd>Molecular evolution</kwd><kwd>Comparative genomics</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001691</institution-id><institution>MEXT | Japan Society for the Promotion of Science (JSPS)</institution></institution-wrap></funding-source><award-id>18J00178</award-id><principal-award-recipient><name><surname>Fukushima</surname><given-names>Kenji</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/100005156</institution-id><institution>Alexander von Humboldt-Stiftung (Alexander von Humboldt Foundation)</institution></institution-wrap></funding-source><award-id>Sofja Kovalevskaja programme 2018</award-id><principal-award-recipient><name><surname>Fukushima</surname><given-names>Kenji</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000854</institution-id><institution>Human Frontier Science Program (HFSP)</institution></institution-wrap></funding-source><award-id>RGY0082/2021</award-id><principal-award-recipient><name><surname>Fukushima</surname><given-names>Kenji</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000002</institution-id><institution>U.S. Department of Health &#x00026; Human Services | National Institutes of Health (NIH)</institution></institution-wrap></funding-source><award-id>GM083127</award-id><principal-award-recipient><name><surname>Pollock</surname><given-names>David D.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s), under exclusive licence to Springer Nature Limited 2023</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Main</title><p id="Par3">A central aim of modern biology is to differentiate the huge amount of non-functional genetic noise from phenotypically important changes. Evolutionary processes at the molecular level are largely neutral and stochastic, but natural selection can constrain evolutionary pathways available to the organism. If similar environmental conditions recur in divergent lineages, the adaptive response may also be similar, leading to convergence, the repeated emergence of similar features in distantly related organisms<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. The prevalence of phenotypic convergence is demonstrated by various examples throughout the tree of life, such as the camera eyes of vertebrates and cephalopods, powered flight of birds and bats and trap leaves of distantly related carnivorous plants. Because the repeated emergence of such complex traits by neutral evolution alone is extremely unlikely, convergence at the phenotypic level is considered strong evidence for natural selection.</p><p id="Par4">Phenotypic convergence is necessarily caused by molecular events and often coincides with detectably excess levels of convergent molecular changes in gene regulation, gene sequences, gene repertoires and other hierarchies of biological organization<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. A meta-analysis reported that 111 out of 1,008 loci had been convergently modified to attain common phenotypic innovations, sometimes even between different phyla<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, illustrating that genotype&#x02013;phenotype associations are frequently observed on macroevolutionary scales. For example, several lineages of mammals, reptiles, amphibians and insects acquired resistance to toxic cardiac glycosides using largely overlapping sets of amino acid substitutions in a sodium pump<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Another example illustrated how human cancer cells and plants employed common amino acid substitutions in topoisomerase I to cope with a common toxic cellular environment generated by plant-derived anticancer drugs<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>.</p><p id="Par5">Genome sequences are becoming more available for diverse lineages from the entire tree of life<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, making it possible to explore macroevolutionary genotype&#x02013;phenotype associations on large scales. However, because many molecular changes are nearly neutral (that is, almost no effect on fitness) and essentially non-functional in nature<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, false positive convergence in the form of stochastic, non-adaptive, convergent events is particularly problematic when conducting a genome-scale search. Furthermore, false positives can arise from methodological biases. For molecular convergence, a major source of bias occurs because such inference is sensitive to the topology of the phylogenetic tree on which substitution events are placed<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>), while alternative methods that do not place substitutions on phylogenetic trees suffer even more severe rates of false positives<sup><xref ref-type="bibr" rid="CR10">10</xref>&#x02013;<xref ref-type="bibr" rid="CR12">12</xref></sup> (Supplementary Text <xref rid="MOESM1" ref-type="media">1</xref>). A correctly inferred tree avoids false positives due to phylogeny<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, but topological misinference due to technical errors, insufficient data or biological factors such as introgression, horizontal gene transfer (HGT), paralogy, incomplete lineage sorting and within-locus recombination can all create substantial amounts of false convergence signals even when adaptive convergence did not actually occur<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. Importantly, false convergence events driven by topological errors tend to similarly affect both non-synonymous and synonymous substitutions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>). By contrast, truly adaptive convergence should occur almost exclusively in non-synonymous substitutions (amino acid-changing substitutions), as positive selection on synonymous substitutions is negligible or at least not prevalent<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). Therefore, synonymous convergence can potentially serve as a reliable reference for measuring the rate of expected non-synonymous convergence due to phylogenetic inference error.<fig id="Fig1"><label>Fig. 1</label><caption><title>Challenges and solutions for the detection of molecular convergence.</title><p><bold>a</bold>, False convergence is caused by tree topology errors. <bold>b</bold>, The overview of CSUBST. This programme processes substitution probabilities to derive observed (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>) and expected (<italic>E</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> and <italic>E</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>) numbers of non-synonymous and synonymous convergence and evaluate their rates (<italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> and <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub>) in branch combinations in a phylogenetic tree. <bold>c</bold>, Generation of simulated datasets for performance evaluation in different evolutionary scenarios. The numbers of observed non-synonymous and synonymous convergence are indicated above trees (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>, respectively; mean &#x000b1; standard deviation). <bold>d</bold>, The estimated rates of protein convergence in different scenarios. Each box plot corresponds to the results of 1,000 simulations. Dashed lines indicate the theoretical expectation (=&#x02009;1.0) except for the ratio of convergence and divergence events (<italic>C</italic>/<italic>D</italic>) (refs. <sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>) for which no theoretical expectation is available. Values greater than the 95th percentile in the Neutral scenario are defined as true and false positives in Convergent and other scenarios, respectively, and are indicated at the top of the plot in pink (true) and blue (false). Box plot elements are defined as follows: centre line, median; box limits, upper and lower quartiles; whiskers, 1.5&#x02009;&#x000d7;&#x02009;interquartile range. <bold>e</bold>, Performance of convergence metrics in empirical datasets. Known examples of protein convergences and HGTs are analysed with <italic>C</italic>/<italic>D</italic>, <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub>, <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> and <italic>&#x003c9;</italic><sub><italic>C</italic></sub>. Median values (bars) are overlaid on individual data points that correspond to gene trees. In trees where convergence occurred in more than two lineages, the median of all focal branch pairs is reported. The branch pairs sister to the focal branches are shown as a control<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, except in cases where there is no substitution at all or the sister branches are phylogenetically not independent. Divergence time is according to timetree.org<sup><xref ref-type="bibr" rid="CR95">95</xref></sup>. The comparison with the background levels for each dataset is shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>. The characteristics of the datasets are summarized in Supplementary Table <xref rid="MOESM3" ref-type="media">3</xref>. MYA, million years ago. Image credits for panel <bold>e</bold>: <italic>Cenchrus echinatus</italic>, Chutima Chaimratana/Shutterstock; <italic>Tetraopes tetrophthalmus</italic>, Paul Reeves Photography/Shutterstock; <italic>Myotis myotis</italic>, Agami Photo Agency/Shutterstock; <italic>Colobus guereza</italic>, Radek Karko/Shutterstock; <italic>Alloteropsis semialata</italic> Alexey Yakovlev under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons license CC BY 4.0</ext-link>; <italic>Cuscuta europaea</italic>, ChWeiss/Shutterstock; alll other images except for <italic>Nepenthes</italic> cf. <italic>alata</italic> and <italic>Cephalotus follicularis</italic> from freepik.com.</p></caption><graphic xlink:href="41559_2022_1932_Fig1_HTML" id="d32e559"/></fig></p><p id="Par6">A widely used framework for understanding how functionally constrained proteins evolve compared with completely unconstrained expectations is to contrast rates of non-synonymous and synonymous substitutions. The ratio of these rates within a protein-coding sequence accounts for mutation biases and is often denoted as <italic>&#x003c9;</italic>, <italic>dN</italic>/<italic>dS</italic> or <italic>K</italic><sub><italic>a</italic></sub>/<italic>K</italic><sub><italic>S</italic></sub> (ref. <sup><xref ref-type="bibr" rid="CR16">16</xref></sup>). Here we extend this framework to derive the new metric ratio <italic>&#x003c9;</italic><sub><italic>C</italic></sub> and implement it to measure phylogenetic error-corrected rates of convergence. Simulation and empirical data analysis show that this new metric has high sensitivity while suppressing false positives. We further show its capability to detect factors that affect protein convergence rates and to identify likely adaptive protein evolution in a genome-scale dataset by an exploratory analysis without a pre-existing hypothesis. We also develop a heuristic algorithm to explore convergent signals with high signal-to-noise ratios in exponentially increasing numbers of higher-order phylogenetic combinations.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Extending the substitution rate ratio framework to convergence</title><p id="Par7">One of the most commonly accepted measures of the rate of protein evolution compared with completely unconstrained expectations is the ratio between non-synonymous and synonymous substitution rates, denoted as <italic>dN</italic> and <italic>dS</italic>, respectively<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. In a model-based framework, the ratio <italic>dN</italic>/<italic>dS</italic> is parameterized as <italic>&#x003c9;</italic>.</p><p id="Par8">Inspired by <italic>&#x003c9;</italic>, we developed a similar metric, <italic>&#x003c9;</italic><sub><italic>C</italic></sub>, that applies to substitutions that occurred repeatedly on a combination of separate phylogenetic branches (combinatorial substitutions; Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref> and Supplementary Text <xref rid="MOESM1" ref-type="media">2</xref>). The metric <italic>&#x003c9;</italic><sub><italic>C</italic></sub> estimates the relative rates of convergence obtained by contrasting the rates of non-synonymous and synonymous convergence (<italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> and <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub>, respectively). Using this ratio, important biological fluctuations, such as among-site rate heterogeneity and codon equilibrium frequencies, are taken into account (Supplementary Text <xref rid="MOESM1" ref-type="media">3</xref> and Methods). Note that in neutrally evolving genes, the theoretical expectation of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> is 1.0, even if <italic>&#x003c9;</italic> in the underlying codon substitution matrix is not 1.0 (usually lower). Similar to previously proposed convergence metrics<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, <italic>&#x003c9;</italic><sub><italic>C</italic></sub> is calculated from substitutions at multiple codon sites across protein-coding sequences. As a result, one <italic>&#x003c9;</italic><sub><italic>C</italic></sub> value is obtained for each gene for each branch pair (or for a combination of more than two branches) in the phylogenetic tree. A unique feature of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> setting it apart from other metrics is its error tolerance. For example, if one of the branches in a branch combination is in error, <italic>&#x003c9;</italic><sub><italic>C</italic></sub> is a measure of the ratio of false convergence events of both kinds falsely attributed to a non-existent branch combination. In this way, the <italic>&#x003c9;</italic><sub><italic>C</italic></sub> values remain close to the neutral expectation of 1.0, even when topology errors are involved. Our method is implemented in the Python programme CSUBST (<ext-link ext-link-type="uri" xlink:href="https://github.com/kfuku52/csubst">https://github.com/kfuku52/csubst</ext-link>), which takes as input a rooted phylogenetic tree and a codon sequence alignment (Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>).</p></sec><sec id="Sec4"><title>The robustness of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> in simulated molecular evolution</title><p id="Par9">Conventionally, observed levels of convergent amino acid substitutions have been contrasted either to the amount of convergence expected under a substitution model (e.g., the convergence measure <italic>R</italic><sup><xref ref-type="bibr" rid="CR18">18</xref></sup>) or to other combinations of amino acid substitution patterns that are similarly affected by site-specific constraint (that is, double divergence; <italic>C</italic>/<italic>D</italic> (refs. <sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>)) (Supplementary Table <xref rid="MOESM3" ref-type="media">1</xref> and Supplementary Text <xref rid="MOESM1" ref-type="media">4</xref>). Here we focus on whether <italic>&#x003c9;</italic><sub><italic>C</italic></sub> performs better as a measure of convergence between branches in comparison to alternative metrics. Accordingly, we generated simulated sequences with 500 codons along a balanced phylogenetic tree ending with 32 sequences at the tips (or leaves), in all cases comparing two deeply separated tip lineages (shown as dots in Fig. <xref rid="Fig1" ref-type="fig">1c</xref>; Supplementary Table <xref rid="MOESM3" ref-type="media">2</xref>). In this analysis, we compared <italic>C</italic>/<italic>D</italic>, <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub>, <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> and <italic>&#x003c9;</italic><sub><italic>C</italic></sub> under four evolutionary scenarios of relationships between the two tips being compared: (1) full neutral evolution along all branches (Neutral); (2) neutral evolution for nearly all branches but with convergent selection along the two deeply separated tip lineages (Convergent); (3) neutral evolution with phylogenetic tree topology error in the form of a copy-and-paste transfer from one of the two deeply separated lineages to the other, overwriting its genetic information (Transfer) or (4) neutral evolution but using a randomly reconstructed phylogenetic tree to detect convergence (Random). The metric <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> is obtained by dividing the observed value of non-synonymous convergence (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>) by the expected value (<italic>E</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>) and is essentially equivalent to the previously proposed metric called <italic>R</italic><sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, but we use the <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> notation here to clarify its relationship to <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub>, the ratio of observed to expected values of synonymous convergence (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>&#x02009;/&#x02009;<italic>E</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>).</p><p id="Par10">During neutral evolution, sequences evolved under a constant codon substitution model without any adaptive convergence or constraint on amino acid substitutions other than those imposed by the structure of the genetic code and relative codon frequencies. In the Neutral scenario (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>), the trees used for simulation and reconstruction were identical. <italic>C</italic>/<italic>D</italic> was much lower than 1.0, as expected, while the other three metrics (<italic>d</italic><italic>N</italic><sub><italic>C</italic></sub>, <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> and <italic>&#x003c9;</italic><sub><italic>C</italic></sub>) were close to but lower than the theoretical expectation of 1.0 (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). This observation is probably due to the fact that the convergent events must be inferred and are not actually observed, as investigated previously for the convergence measure <italic>R</italic><sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. In the Convergent scenario, adaptive convergence on the focal pair of deeply separated branches (red branches in Fig. <xref rid="Fig1" ref-type="fig">1c</xref>) was mimicked by convergently evolving 5% of codon sites (25 sites) in the two branches under substitution models biased towards codons encoding the same randomly selected amino acid. This generated an average of four excess non-synonymous convergent substitutions on these two branch pairs (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> in Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). In the Convergent scenario, the three protein convergence metrics, <italic>C</italic><italic>/</italic><italic>D</italic>, <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> and <italic>&#x003c9;</italic><sub><italic>C</italic></sub>, yielded values substantially higher than they did under the Neutral scenario, while the synonymous change measure <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> remained comfortably well below 1.0. Using the distribution of metric values under the Neutral scenario as a reference, we see that 70&#x02013;80% of the detection metric values in the Convergent scenario are above the 95th percentile of the 1,000 simulations in their respective neutral distributions, while only 3.5% of <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> values are above this threshold, indicating that this level of convergence is usually detected by all three of the protein convergence metrics (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). In <italic>&#x003c9;</italic><sub><italic>C</italic></sub>, this level of detection was achievable with only two to three non-synonymous convergent substitutions, and the positive rates exceeded 95% with seven or more convergent substitutions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>). To be thorough, we considered that <italic>&#x003c9;</italic><sub><italic>C</italic></sub> metrics can in general be derived for nine types of combinatorial substitution (that is, substitutions occurring at the same protein site in multiple independent branches; Supplementary Text <xref rid="MOESM1" ref-type="media">2</xref>) based on whether the ancestral and descendant states are the same or different, or in any state among multiple branches (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref>). In the Convergent scenario, only the <italic>&#x003c9;</italic><sub><italic>C</italic></sub> metrics involved in convergence (that is, not divergence) showed a response, confirming its specificity (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref>).</p><p id="Par11">We next considered Transfer and Random scenarios that include phylogenetic error. In the Transfer scenario, we transferred one of the focal tip sequences to the other focal tip sequence in the simulation, but the phylogenetic tree used in the analysis remained unchanged, as might happen with HGT events (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). In the Random scenario, we fully randomized the entire reconstructed tree relative to the true tree (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Excess convergence detected in either of these scenarios is considered a false positive. We determined that both <italic>C</italic><italic>/</italic><italic>D</italic> and <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> (and thus <italic>R</italic> too) are sensitive to the errors (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). By contrast, and as intended, <italic>&#x003c9;</italic><sub><italic>C</italic></sub> values were close to the neutral expectation because the rise in <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> due to phylogenetic error is matched by a similar increase of <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub>, and they cancel each other out in the <italic>&#x003c9;</italic><sub><italic>C</italic></sub> metric (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). Further simulations supported the robustness of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> against the rate of protein evolution, model misspecification, tree size and protein size (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b&#x02013;f</xref>). Still, care must be taken when using simple codon substitution models, such as MG and GY models (Supplementary Text <xref rid="MOESM1" ref-type="media">5</xref>). Furthermore, <italic>&#x003c9;</italic><sub><italic>C</italic></sub> showed low false positive rates in sister branches that serve as a control for the focal branch pairs<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4g</xref>). Taken together, our simulation showed that <italic>&#x003c9;</italic><sub><italic>C</italic></sub> effectively counteracts false positives caused by phylogenetic errors without loss of power.</p></sec><sec id="Sec5"><title><italic>&#x003c9;</italic><sub><italic>C</italic></sub> is robust to false convergence in empirical datasets</title><p id="Par12">To test whether <italic>&#x003c9;</italic><sub><italic>C</italic></sub> performs well with real data, we collected protein-coding sequence datasets from known molecular convergence events in various pairs of lineages covering insects, tetrapods and flowering plants (Fig. <xref rid="Fig1" ref-type="fig">1e</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref> and Supplementary Table <xref rid="MOESM3" ref-type="media">3</xref>). Insects that feed on milkweed (Apocynaceae) harbour amino acid substitutions in a sodium pump subunit (ATPalpha1) that confer cardiac glycoside resistance<sup><xref ref-type="bibr" rid="CR19">19</xref>&#x02013;<xref ref-type="bibr" rid="CR21">21</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5a</xref>). Echolocating bats and whales share amino acid substitutions in the hearing-related motor protein prestin to enable high-frequency hearing<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5b</xref>). An extensive molecular convergence occurred in the mitochondrial genomes of agamid lizards and snakes, presumably due to physiological adaptations for radical fluctuations in their aerobic metabolic rates<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Specialized digestive physiology of herbivorous mammals<sup><xref ref-type="bibr" rid="CR24">24</xref>&#x02013;<xref ref-type="bibr" rid="CR26">26</xref></sup> and carnivorous plants<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> led to the molecular convergence of digestive enzymes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5c&#x02013;g</xref>). Phosphoenolpyruvate carboxylase (PEPC), a key enzyme for carbon fixation in C<sub>4</sub> photosynthesis, shares multiple amino acid convergence<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5h</xref>). In all these examples, <italic>&#x003c9;</italic><sub><italic>C</italic></sub> successfully detected convergent lineages, while it was always lower and in many cases close to the neutral expectation in the branch pairs sister to the focal lineages, which serve as a negative control<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1e</xref> and Supplementary Table <xref rid="MOESM3" ref-type="media">4</xref>). Moreover, the <italic>&#x003c9;</italic><sub><italic>C</italic></sub> values of the focal branch pairs tended to be high compared with background levels in the phylogenetic trees (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5i</xref>). Analysis of different categories of combinatorial substitutions correctly recovered a trend consistent with the action of intramolecular epistasis, which did not appear in the simulations (Supplementary Text <xref rid="MOESM1" ref-type="media">6</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">5j,k</xref>).</p><p id="Par13">To test robustness against phylogenetic errors, we also employed reported cases of HGTs associated with C<sub>4</sub> photosynthesis<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> and plant parasitism<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. We reconstructed the phylogenetic trees of the HGT genes with a constraint that enforces species tree-like topologies (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). This operation separates the HGT donor and acceptor lineages and creates false convergence (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>). Consistent with the simulation results, <italic>&#x003c9;</italic><sub><italic>C</italic></sub> values in HGTs were lower than the adaptive convergence events (Fig. <xref rid="Fig1" ref-type="fig">1e</xref>). By contrast, <italic>C</italic><italic>/</italic><italic>D</italic> and <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> showed values higher in HGTs than in the adaptive convergence events. Together with the simulations, these results show that the consideration of synonymous substitutions is essential for the accurate detection of molecular convergence in the presence of phylogenetic error and that <italic>&#x003c9;</italic><sub><italic>C</italic></sub> outperforms current alternative methods.</p></sec><sec id="Sec6"><title><italic>&#x003c9;</italic><sub><italic>C</italic></sub> probes a high-confidence set of convergently evolved genes</title><p id="Par14">Discovering adaptive molecular convergence in genome-scale datasets, which may be translated into genotype&#x02013;phenotype associations, has been challenging since it is a rare phenomenon and false positives are high<sup><xref ref-type="bibr" rid="CR10">10</xref>&#x02013;<xref ref-type="bibr" rid="CR12">12</xref></sup>. To examine whether the application of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> can generate plausible hypotheses of adaptive molecular convergence, we analysed the 21 vertebrate genomes covering a range from fish to humans (Fig. <xref rid="Fig2" ref-type="fig">2a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">8a</xref>) and calculated <italic>&#x003c9;</italic><sub><italic>C</italic></sub> and other metrics for all independent branch pairs in 16,724 orthogroups classified by OrthoFinder<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. CSUBST completed the analysis even for the largest orthogroup (OG0000000) containing 682 genes encoding zinc finger proteins and 901,636 independent branch pairs (alignment length including gaps: 31,665&#x02009;bp). We obtained a total of 20,150,538 branch pairs from all orthogroups, and subsequent analyses revealed that convergence probability decreased over time probably due to intramolecular epistasis (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">5l</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">8b,c</xref> and Supplementary Text <xref rid="MOESM1" ref-type="media">7</xref>), that gene duplication also reduced convergence probability (Fig. <xref rid="Fig2" ref-type="fig">2c</xref> and Supplementary Text <xref rid="MOESM1" ref-type="media">8</xref>) and that <italic>&#x003c9;</italic><sub><italic>C</italic></sub> is robust for potential artifacts by falsely placed gene duplications and false gene grouping (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8d,e</xref> and Supplementary Text <xref rid="MOESM1" ref-type="media">9</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Biological variation of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> in a genome-scale dataset.</title><p><bold>a</bold>, Phylogenetic relationships of the selected species. Supplementary Fig. <xref rid="MOESM1" ref-type="media">8a</xref> provides the complete phylogeny. The tree and divergence time estimates were obtained from timetree.org<sup><xref ref-type="bibr" rid="CR95">95</xref></sup>. <bold>b</bold>, Temporal variation of convergence rates. The numbers of branch pairs (<italic>N</italic>) and Spearman&#x02019;s correlation coefficient (<italic>&#x003c1;</italic>) are shown. The bin range was determined to assign an equal number of branch pairs to each bin. To reduce the noise originating from branches where almost no substitutions occurred, branch pairs with both <italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup> greater than 1.0 were analysed (that is, at least one convergent substitution each). Box plot elements are defined as follows: centre line, median; box limits, upper and lower quartiles; whiskers, 1.5&#x02009;&#x000d7;&#x02009;interquartile range. <bold>c</bold>, Convergence rates depending on gene duplications. Branch pairs were categorized into speciation events (SS) and branch pairs after two independent gene duplications (DD) according to the presence of preceding gene duplications in no or both branches, respectively. Branch pairs with one preceding duplication were excluded from the analysis. Dashed lines indicate the theoretical expectation (=&#x02009;1.0). Icon credits for panel <bold>a</bold>: PhyloPic.com.</p></caption><graphic xlink:href="41559_2022_1932_Fig2_HTML" id="d32e1398"/></fig></p><p id="Par15">We first extracted the branch pairs with the top 1% of <italic>C</italic><italic>/</italic><italic>D</italic>, <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> or <italic>&#x003c9;</italic><sub><italic>C</italic></sub> values with a cut-off for a minimum of three non-synonymous and synonymous convergence (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>&#x02009;&#x02265;&#x02009;3.0 and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>&#x02009;&#x02265;&#x02009;3.0) (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). The top 1% threshold allows different convergence metrics to be compared without introducing arbitrary thresholds in each metric. The overlap between each set of branch pairs was moderate, with 1,348 branch pairs satisfying all three criteria out of 5,659 pairs with the top 1% <italic>&#x003c9;</italic><sub><italic>C</italic></sub> values.<fig id="Fig3"><label>Fig. 3</label><caption><title>Joint convergence of gene expression patterns and protein sequences.</title><p><bold>a</bold>, Comparison of convergent branch pairs obtained by different methods in the vertebrate dataset. Branch pairs with <italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>&#x02009;&#x02265;&#x02009;3.0 and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>&#x02009;&#x02265;&#x02009;3.0 were analysed. The stochastic equality of the data was tested by a two-sided Brunner&#x02013;Munzel test with <italic>W</italic> as the test statistic<sup><xref ref-type="bibr" rid="CR96">96</xref></sup>. Box plot elements are defined as follows: centre line, median; box limits, upper and lower quartiles; whiskers, 1.5&#x02009;&#x000d7;&#x02009;interquartile range. <bold>b</bold>, A schematic illustration of convergent expression evolution modelled with a multi-optima Ornstein&#x02013;Uhlenbeck process. <bold>c</bold>, Venn diagrams showing the extent of overlap between protein and expression convergence. Circles represent the sets of branch pairs. <bold>d</bold>&#x02013;<bold>g</bold>, Examples of the likely adaptive joint convergence. Aldo-keto reductase family 1 (AKR1, <bold>d</bold>), Nudix hydrolase 16 like 1 (NUDT16L1, <bold>e</bold>), Myeloid associated differentiation marker (MYADM, <bold>f</bold>) and dihydrodiol dehydrogenase (DHDH, <bold>g</bold>) are shown. The silhouettes represent the species (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8a</xref>) that carries the gene, and the clades involved in the joint convergence are indicated with an enlarged size. The colours of branches and animal silhouettes indicate expression regimes. Branches involved in joint convergence are highlighted with thick lines, connected by the colour of the expression regime and annotated with convergence metrics. Localization of convergent and divergent substitutions on the protein structure is shown along with a close-up view of functionally important sites. Substrates and their analogues are shown as green sticks. Side chains forming the substrate-binding site are also shown as sticks. Note that these are the side chains in the protein from databases, so amino acid substitutions in the convergent lineages may result in distinct structures and arrangements. Site numbers correspond to those in the Protein Data Bank (PDB) entry or the AlphaFold structure (from <bold>d</bold> to <bold>g</bold>: 1Q13, 5W6X, AF-Q6DFR5-F1-model_v2 and 2O48). Icon credits for panels <bold>d</bold>&#x02013;<bold>g</bold>: <italic>Rattus norvegicus</italic>, Rebecca Groom, under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/3.0/">Creative Commons license CC BY 3.0</ext-link>; <italic>Astyanax mexicanus</italic>, Milton Tan/PhyloPic under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons license CC BY -NC-SA 3.0</ext-link>; all other images are from PhyloPic.com or were created by the author.</p></caption><graphic xlink:href="41559_2022_1932_Fig3_HTML" id="d32e1546"/></fig></p><p id="Par16">To examine which metrics better enrich for likely adaptive convergence, we compared the topological confidence scores of the selected branches. If artifacts due to tree topology errors are included, low confidence branches should be enriched. Analysis of the bootstrap-based confidence values<sup><xref ref-type="bibr" rid="CR33">33</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup> showed that <italic>&#x003c9;</italic><sub><italic>C</italic></sub> selects branch pairs with higher confidence than the other two metrics (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). Furthermore, we examined the synonymous convergence rate (<italic>d</italic><italic>S</italic><sub><italic>C</italic></sub>), which is not expected to be greater than the theoretical expectation in the adaptive convergence, and established that only <italic>&#x003c9;</italic><sub><italic>C</italic></sub> satisfies such an assumption (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). These results indicate that <italic>&#x003c9;</italic><sub><italic>C</italic></sub> has excellent properties for finding adaptive protein convergence in genome-scale analyses.</p></sec><sec id="Sec7"><title>Detecting convergent genes associated with a particular phenotype</title><p id="Par17">As convergence metrics have been used to search for genes associated with phenotypes of interest, we next examined whether <italic>&#x003c9;</italic><sub><italic>C</italic></sub> might be used to discover candidate genes underlying phenotypic convergence. Here we analysed a pair of herbivorous animal lineages as an example of a search for genes associated with a complex trait (that is, herbivory): ruminants (the stem branch of the clade including cattle (<italic>Bos taurus</italic>) and red sheep (<italic>Ovis aries</italic>)) versus rabbits (the terminal branch connected to <italic>Oryctolagus cuniculus</italic>). Using minimum thresholds for the number of convergent amino acid substitutions (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>&#x02009;&#x02265;&#x02009;3.0) and protein convergence rate (<italic>&#x003c9;</italic><sub><italic>C</italic></sub>&#x02009;&#x02265;&#x02009;3.0), we obtained 352 candidate gene branch pairs corresponding to the above pair of lineages in a genome-scale analysis of the 21 vertebrates (Supplementary Table <xref rid="MOESM3" ref-type="media">5</xref>). By mapping the positions of substitutions onto known conformations of homologous proteins, we identified particularly compelling cases of likely adaptive convergence that generated genotypes linked to particular phenotypes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). Examples included olfactory receptors in which convergent substitutions are located in the interior of the receptor barrel (Olfactory Receptor Family 7 Subfamily A (OR7A), Olfactory Receptor Family 2 Subfamily M Member 2 (OR2M2) and Olfactory Receptor Family 1 Subfamily B Member 1 (OR1B1), where substitutions may change ligand preference associated with herbivorous behaviour.</p><p id="Par18">Similarly, the barrel-like structure of some solute carriers harboured convergent substitutions in their interior sides (Solute Carrier Family 5 Member 12 (SLC5A12), SLC51A, SLC22A and SLC44A1), suggesting their involvement in the uptake or transport of plant-derived compounds. Among these, SLC51A (also known as organic solute transporter &#x003b1; (OST&#x003b1;)) may be a particularly attractive candidate. This protein plays a major role in bile acid absorption and, hence, in dietary lipid absorption<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. The convergence in SLC51A may be coupled with another convergent event detected in CYP7A1, a cytochrome P450 protein known to serve as a critical regulatory enzyme of bile acid biosynthesis<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. Cytochrome P450 Family 7 Subfamily A Member 1 (CYP7A1) harboured two convergent substitutions in its substrate-binding sites (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). While most herbivores secrete bile acids mainly in a glycine-conjugated form, ruminant bile is mostly in the form of taurine-conjugated bile acids, which remain soluble in highly acidic conditions<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. The predominance of taurine-conjugated forms is also observed in rabbits, depending on species and developmental stage<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. Thus, convergence in these proteins may be related to such nutritional physiology characteristic in these herbivorous animals.</p><p id="Par19">Other examples of detected convergence included two convergent substitutions in the DNA-binding sites of a member of the zinc finger protein family, which functions as a transcriptional regulator<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). Convergence in the substrate-binding sites of pancreatic elastase<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> and pancreatic DNase I (ref. <sup><xref ref-type="bibr" rid="CR41">41</xref></sup>) may be related to their specialized digestion (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). In DNase I, amino acid sites exposed on the surface of protein structures displayed additional convergent substitutions that change the charge of their target amino acid residues (E124K, G172D and H208N), possibly resulting in convergent changes in the biochemical properties of the protein, such as optimal pH, resistance to proteolysis and post-translational modifications. Consistent with this idea, bovine and rabbit DNase I proteins are known to be more resistant to degradation by pepsin than their homologues in other animals<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. Furthermore, E124K was shown to be important for the phosphorylation of bovine DNase I (ref. <sup><xref ref-type="bibr" rid="CR43">43</xref></sup>). Other convergent substitutions will be promising candidates for future characterization. Taken together, these results show how our approach can detect genetic changes (for example, molecular convergence in SLC51A, CYP7A1 and DNase I) associated with phenotypes (for example, specialized digestion for herbivory) on the macroevolutionary scale.</p></sec><sec id="Sec8"><title>Exploratory analysis of molecular convergence</title><p id="Par20">We further exploited the 21 vertebrate genomes to examine whether <italic>&#x003c9;</italic><sub><italic>C</italic></sub> might be used to discover adaptive molecular convergence that may generate hypotheses of linked phenotypes. Because convergence at multiple levels of biological organization can provide strong evidence for adaptive evolution, we searched for simultaneous convergence in protein sequences and gene expression in an exploratory manner without a predefined hypothesis on convergently evolved genes and lineages. Using the same thresholds applied to the analysis of herbivores above (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>&#x02009;&#x02265;&#x02009;3.0 and <italic>&#x003c9;</italic><sub><italic>C</italic></sub>&#x02009;&#x02265;&#x02009;3.0), we obtained 53,805 candidate branch pairs from all orthogroups.</p><p id="Par21">Although this was an exploratory analysis in which all independent branch pairs were exhaustively analysed, many studies of convergent evolution involve only a few groups of focal species. If such a research design is applied to this dataset (similar to the analysis of herbivores), the number of detected branch pairs will be much smaller. For example, because there are 861 branch pairs in the species tree, on average, 62.5 cases of protein convergence will be obtained in our genome-scale dataset for any particular analysis of two groups of species, although the numbers of analysable branch pairs and hence of detected convergence depend on several factors (Supplementary Text <xref rid="MOESM1" ref-type="media">10</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>).</p><p id="Par22">To detect convergent gene expression evolution, we employed the amalgamated transcriptomes for six organs in the 21 vertebrate species<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Using this previously published dataset, we subjected curated gene expression levels (SVA-log-TMM-FPKM, log<sub>2</sub>-transformed values of fragments per kilobase of exon per million reads mapped, corrected by trimmed mean of M-values and surrogate variable analysis) to multi-optima phylogenetic Ornstein&#x02013;Uhlenbeck (OU) modelling, in which expression evolution is inferred as regime shifts of estimated optimal expression levels<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Phylogenetic positions and the numbers of expression regime shifts were determined by a LASSO (least absolute shrinkage and selection operator)-based algorithm with Akaike Information Criterion, which was also used for finding convergent shifts towards similar optimal values. In total, we detected 12,017 cases of expression convergence in 4,308 orthogroups. Setting the thresholds for gene expression specificity at <italic>&#x003c4;</italic>&#x02009;&#x02265;&#x02009;0.67 (ref. <sup><xref ref-type="bibr" rid="CR46">46</xref></sup>) and expression levels at <italic>&#x003bc;</italic><sub>max</sub>&#x02009;&#x02265;&#x02009;2.0 (the maximum value of fitted SVA-log-TMM-FPKM)<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, we obtained a set of 2,917 high-confidence branch pairs for potentially adaptive convergence of expression patterns (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>).</p><p id="Par23">By taking the intersection of protein convergence and expression convergence, we discovered 33 cases of potentially adaptive joint convergence of expression patterns and protein sequences in 31 orthogroups (Fig. <xref rid="Fig3" ref-type="fig">3c</xref> and Supplementary Table <xref rid="MOESM3" ref-type="media">6</xref>). Gene duplication was frequently associated with joint convergence, with at least one branch experiencing gene duplication in 23 out of the 33 branch pairs (<italic>P</italic>&#x02009;=&#x02009;3.11&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;25</sup>, <italic>&#x003c7;</italic><sup><italic>2</italic></sup>&#x02009;=&#x02009;107.7, <italic>&#x003c7;</italic><sup><italic>2</italic></sup> test of independence). While gene duplication generally reduced the convergence rate, as discussed earlier (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>), some of the independently generated duplicates may tend to evolve into the same sequence space when similar expression evolution takes place. Convergence of testis-specific genes was most frequently observed (19/33 orthogroups) and significantly enriched, with the effect size highest among six tissues (Supplementary Table <xref rid="MOESM3" ref-type="media">7</xref>). The mechanism by which the testis serves as a major place for functional evolution of duplicated genes has been explained by several factors, including the ease with which expression is acquired in spermatogenic cells<sup><xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. This phenomenon is called the out-of-the-testis hypothesis, and our results suggest that predictable protein evolution may be enriched in this evolutionary pathway. While adaptive evolution may explain this evolutionary scenario, it is possible that partially relaxed constraints may also be involved in protein convergence, particularly at protein sites that were so constrained that almost no amino acid substitutions occurred before relaxation.</p><p id="Par24">To infer the functional effect of convergent amino acid substitutions, we mapped the positions of substitutions onto known conformations of homologous proteins. Strikingly, we observed convergently evolved proteins where clusters of substitutions are localized to functionally important sites (Fig. <xref rid="Fig3" ref-type="fig">3d&#x02013;g</xref> and Supplementary Text <xref rid="MOESM1" ref-type="media">11</xref>). For example, an orthogroup of dihydrodiol dehydrogenase (DHDH) showed joint convergence of expression and proteins (Fig. <xref rid="Fig3" ref-type="fig">3g</xref>). Possible physiological roles of this enzyme included the detoxification of cytotoxic dicarbonyl compounds, such as 3-deoxyglucosone derived from glycation<sup><xref ref-type="bibr" rid="CR49">49</xref>,<xref ref-type="bibr" rid="CR50">50</xref></sup>. Although the domain structure of proteins was well conserved among species (Supplementary Fig. <xref rid="MOESM1" ref-type="media">11a</xref>), the gene expression patterns of the encoding genes tended to vary. DHDH is known to show distinct tissue-specific expression patterns in mammals: kidney in monkeys (<italic>Macaca mulatta</italic>)<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>, kidney and liver in dogs (<italic>Canis lupus</italic>)<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>, liver and lens in rabbits<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> and various tissues in pigs (<italic>Sus scrofa</italic>)<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. Our amalgamated transcriptomes showed largely consistent species-specific expression patterns (Fig. <xref rid="Fig3" ref-type="fig">3g</xref>). The OU analysis recovered four lineage-specific regime shifts categorized into two pairs of convergent expression evolution. One of them, the convergence of gene expression that occurred between frogs (<italic>Xenopus</italic>) and the blind cave fish (<italic>Astyanax</italic>), which diverged approximately 435 million years ago<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>, is characterized by kidney-specific expression. The <italic>Xenopus</italic> gene ENSXETG00000033613 appeared to have arisen from a more widely expressed ancestral gene after a lineage-specific gene duplication. By contrast, the <italic>Astyanax</italic> gene ENSAMXG00000005808 may have acquired kidney-specific expression without any detectable duplication. In this branch pair, we detected a protein convergence rate that cannot be explained by neutral evolution alone, with a convergence of five amino acid sites (Supplementary Fig. <xref rid="MOESM1" ref-type="media">11a</xref>). These convergent substitutions localized around the active site, while we did not observe such a trend for the double divergence (Fig. <xref rid="Fig3" ref-type="fig">3g</xref>). This result suggests that the convergent substitutions may have occurred adaptively to change ancestral catalytic function.</p><p id="Par25">DHDH has broad substrate specificity for carbonyl compounds. This protein oxidizes <italic>trans</italic>-cyclohexanediol, <italic>trans</italic>-dihydrodiols of aromatic hydrocarbons and monosaccharides including D-xylose, while it reduces dicarbonyl compounds, aldehydes and ketones<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. Its active site is predominantly formed by hydrophobic residues, suggesting their role in catabolizing aromatic hydrocarbons<sup><xref ref-type="bibr" rid="CR55">55</xref>,<xref ref-type="bibr" rid="CR56">56</xref></sup>. Notably, the convergent substitutions in the substrate-binding pocket tended to increase amino acid hydrophobicity (Supplementary Fig. <xref rid="MOESM1" ref-type="media">11b</xref>), suggesting that the remodelling of the active site may have led to the acquisition of new substrates, and hence a novel detoxification ability, in <italic>Xenopus</italic> and <italic>Astyanax</italic>.</p><p id="Par26">In summary, <italic>&#x003c9;</italic><sub><italic>C</italic></sub> was not only robust against phylogenetic errors, outperforming other methods in simulation and empirical data, but also allowed us to discover plausible adaptive convergence from a genome-scale dataset without a pre-existing hypothesis. The genotypes detected by molecular convergence analysis provide opportunities for the phenotypic association, mechanistic assessment and experimental validation in vivo. This holds even if internal branches are involved in a detected convergence event, because most species in the clade will tend to retain the convergent genotypes identified, and most species in the clade will tend to retain the phenotypic change that drove the molecular convergence. Therefore, molecular convergence revealed by our exploratory analysis will provide a basis for understanding overlooked phenotypes that are in common among species in clades descended from branches where the convergent events occurred.</p></sec><sec id="Sec9"><title>Heuristic detection of highly repetitive adaptive convergence</title><p id="Par27">Convergent events observed on even more than two independent lineages are exceptionally good signals of adaptive evolution, if they exist, because three or more combined convergences should be extremely rare in random noise. Conventionally, convergence in more than two branches has been analysed as multiple pairwise comparisons for which there is a prior hypothesis of convergence. The difficulty in analysing higher-order combinatorial substitutions without specific prior hypotheses lies in the need to explore a vast combinatorial space that exponentially expands as the number of branches to be combined (<italic>K</italic>) increases. For example, an evenly branching tree with 64 tips has 7,359 independent branch pairs (that is, at <italic>K</italic>&#x02009;=&#x02009;2), but the number of branch combinations exponentially increases to 333,375 and 6,976,859 in triple (<italic>K</italic>&#x02009;=&#x02009;3) and quadruple (<italic>K</italic>&#x02009;=&#x02009;4) combinations, respectively, making it impractical to exhaustively search highly repetitive convergence even in a single phylogenetic tree when a hypothesis on focal lineages is unavailable.</p><p id="Par28">To overcome this limitation, we developed an efficient branch-and-bound algorithm<sup><xref ref-type="bibr" rid="CR57">57</xref></sup> that progressively searches for higher-order branch combinations (Fig. <xref rid="Fig4" ref-type="fig">4a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">12a</xref>). For the performance evaluation, we used the PEPC tree (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>) because it has repeated adaptive convergence for its use in C<sub>4</sub> photosynthesis (Fig. <xref rid="Fig1" ref-type="fig">1e</xref>). While the exhaustive search required 156&#x02009;minutes with <italic>K</italic>&#x02009;=&#x02009;3 to analyse 307,432 branch combinations using two central processing units (CPUs), our branch-and-bound algorithm required only 21&#x02009;seconds. At <italic>K</italic>&#x02009;=&#x02009;4, the exhaustive search completed within a practical time by using 16 CPUs (46&#x02009;hours for nearly 8 million combinations) but failed to complete at K&#x02009;=&#x02009;5 (152 million combinations). By sharp contrast, the heuristic search took about 5&#x02009;minutes for the entire analysis, of which the higher-order analysis with <italic>K</italic> ranging from 3 to 6 took only about 1&#x02009;minute to analyse as few as 390 combinations with two CPUs (Supplementary Table <xref rid="MOESM3" ref-type="media">8</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Heuristic search of higher-order branch combinations for adaptive protein convergence.</title><p><bold>a</bold>, Branch-and-bound algorithm for higher-order branch combinations. This method explores the higher-order combinatorial space until there are no more convergent branch combinations. <bold>b</bold>, The maximum-likelihood phylogenetic tree of PEPCs in flowering plants. The catalytic function of PEPC, which is crucial in C<sub>4</sub> photosynthesis, is illustrated. Photographs of representative C<sub>4</sub> photosynthetic lineages are shown. The bar indicates 0.1 nucleotide substitutions per nucleotide site. The complete tree is shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>. <bold>c</bold>, Higher-order convergence enriches C<sub>4</sub>-type PEPCs. The Venn diagrams show the proportion of convergent branch combinations of C<sub>4</sub>-type and non-C<sub>4</sub>-type lineages (red and grey, respectively). Branch combinations containing both were included in non-C<sub>4</sub>. In the phylogenetic trees, convergent branch combinations are shown as edges connecting branches. <bold>d</bold>, Improvement of the signal-to-noise ratio in higher-order branch combinations. The line graph shows the median values of the total probabilities (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>) and the rates (<italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> and <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub>) of non-synonymous and synonymous convergence in the convergent branch combinations of C<sub>4</sub> lineages. Points correspond to branch combinations. Image credits for panel <bold>b</bold>: <italic>Suaeda aralocaspica</italic> from ref. <sup><xref ref-type="bibr" rid="CR97">97</xref></sup> and <italic>Alternanthera pungens</italic> by monkeyjodey under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons lincense CC BY 4.0</ext-link>; <italic>Fimbristylis littoralis</italic>, Supratchai Pimpaeng/Shutterstock; all other images from freepik.com.</p></caption><graphic xlink:href="41559_2022_1932_Fig4_HTML" id="d32e2057"/></fig></p><p id="Par29">The analysed tree covered nine independent origins of C<sub>4</sub>-type PEPC, and the corresponding branch pairs of C<sub>4</sub> lineages accounted for 1.1% of all possible pairs (94/8,308). Convergent branch pairs defined by a threshold (<italic>&#x003c9;</italic><sub><italic>C</italic></sub>&#x02009;&#x02265;&#x02009;5.0 and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>&#x02009;&#x02265;&#x02009;2.0) enriched for the C<sub>4</sub> lineages at <italic>K</italic>&#x02009;=&#x02009;2 (29.9%, 26/87; Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). The convergence of non-C<sub>4</sub> lineages (61/87, including pairs of C<sub>4</sub> and non-C<sub>4</sub> branches) can be interpreted as false positives or adaptive convergence associated with other currently unknown functions. The subsequent higher-order analysis resulted in the discovery of highly repetitive convergence in combinations of as many as six branches (that is, <italic>K</italic>&#x02009;=&#x02009;3 to <italic>K</italic>&#x02009;=&#x02009;6). As the order increased, the lineages of C<sub>4</sub>-type PEPCs rapidly predominated and accounted for all the combinations detected at <italic>K</italic>&#x02009;&#x02265;&#x02009;5 (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>), even though the heuristic algorithm was not given any information about the C<sub>4</sub> lineages.</p><p id="Par30">In the higher-order C<sub>4</sub> branch combinations, the detected convergence events were almost entirely non-synonymous (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>), while synonymous convergence (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>) was negligible (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>). As a result, the rate of synonymous convergence (<italic>d</italic><italic>S</italic><sub><italic>C</italic></sub>) quickly approached zero (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>). Notably, the higher-order convergent substitutions were located at functionally important protein sites. In the convergent branch combinations with <italic>K</italic>&#x02009;=&#x02009;6, we identified three amino acid sites with a joint posterior probability of non-synonymous convergence greater than 0.5: V627I, H665N, and A780S (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12b&#x02013;d</xref>). The H665N substitution generates a putative <italic>N</italic>-glycosylation site that may be important for protein folding<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. The A780S substitution, for which the signature of positive selection had been detected previously<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR58">58</xref>,<xref ref-type="bibr" rid="CR59">59</xref></sup>, has been shown to change the enzyme kinetics related to the first committed step of C<sub>4</sub> carbon fixation<sup><xref ref-type="bibr" rid="CR60">60</xref>&#x02013;<xref ref-type="bibr" rid="CR62">62</xref></sup> and is therefore considered a diagnostic substitution of C<sub>4</sub>-type PEPC<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. The third substitution, C627I, might be a good focus for future experimentation. Application of the heuristic search to the 21 animal genomes revealed that while likely adaptive higher-order convergence could be detected, false detections arising from inconsistently represented splicing variants should be carefully avoided when performing genome-scale analyses (Supplementary Text <xref rid="MOESM1" ref-type="media">12</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">13</xref> and Supplementary Table <xref rid="MOESM3" ref-type="media">9</xref>). Nevertheless, these results demonstrate that higher-order analysis can substantially increase the signal-to-noise ratio in convergence analysis when there is repeated selective pressure to evolve similar biochemical functions.</p></sec></sec><sec id="Sec10" sec-type="discussion"><title>Discussion</title><p id="Par31">In this study, we introduced a measure of convergent protein evolution, <italic>&#x003c9;</italic><sub><italic>C</italic></sub>, designed to account for false signals due to phylogenetic error. We showed, through simulation and analysis of real biological data, that <italic>&#x003c9;</italic><sub><italic>C</italic></sub> mostly eliminates false positives without reduction in power to detect true signals. We also developed an approach to estimate the rates of highly repetitive convergence (that is, on more than two lineages) fully accounting for phylogenetic combinatorics and demonstrated that the specificity of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> increases further in the higher-order analysis. Because of its improved accuracy, <italic>&#x003c9;</italic><sub><italic>C</italic></sub> should further drive macroevolutionary analyses where uncorrected measures have been used to identify responsible genotypes for particular phenotypes in a way similar to genome-wide association studies (GWASs). It is noteworthy that there are more direct extensions of the GWAS approaches to analyse among-species variations. Those methods, including PhyloGWAS<sup><xref ref-type="bibr" rid="CR63">63</xref></sup>, can be applied to closely related species to detect convergent selection on ancestral variation or through introgression<sup><xref ref-type="bibr" rid="CR64">64</xref></sup>. Although those methods are powerful, the applicability to distantly related species is limited. In our method, as in alleles identified by GWASs or the above-mentioned comparable approaches (or genes in gene-level association tests<sup><xref ref-type="bibr" rid="CR65">65</xref></sup>), genes with excess convergence serve as clues to study macroevolutionary traits for which the molecular basis is unknown (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Furthermore, the accuracy of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> even allows exploratory analysis (Fig. <xref rid="Fig5" ref-type="fig">5</xref>), as demonstrated here in vertebrate genomes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). By conducting a genome-wide search of convergent branch combinations, we detected signatures of likely adaptive convergence, which leads to hypothesis generation on responsible phenotypes. This outcome was possible because <italic>&#x003c9;</italic><sub><italic>C</italic></sub>, unlike <italic>P</italic>-values from GWASs, does not require phenotypic traits as input. Convergently evolved genes identified by exploratory analysis will, in turn, lead to the discovery of overlooked phenotypes through future experimentation.<fig id="Fig5"><label>Fig. 5</label><caption><title>Analysis of the genotype&#x02013;phenotype association within and between species.</title><p>The proposed method improves the accuracy of the hypothesis-driven approach in the macroevolutionary scale and enables exploratory approaches. Note that for visualization purposes, the number of individuals and species shown here is smaller than the actual number required for analysis. Focal phenotypes and associated mutations are shown in pink and orange, other phenotypes are shown in black and unrelated mutations and substitutions are shown in grey. Icons from freepik.com. Credits for protein shapes: Smart Servier Medical Art under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons license CC BY -SA 3.0</ext-link>.</p></caption><graphic xlink:href="41559_2022_1932_Fig5_HTML" id="d32e2294"/></fig></p><p id="Par32">Although <italic>&#x003c9;</italic><sub><italic>C</italic></sub> is a powerful means to detect convergence while removing the effect of phylogenetic error, there are other sources of stochastic error that can mask small signals. We successfully captured multiple known convergence events here, even with only two or three amino acid substitutions involved in small proteins (Fig. <xref rid="Fig1" ref-type="fig">1e</xref> and Supplementary Table <xref rid="MOESM3" ref-type="media">3</xref>). However, a convergent amino acid substitution at a single site in only two lineages may not reliably be identified as resulting from adaptation rather than random homoplasy, by <italic>&#x003c9;</italic><sub><italic>C</italic></sub> or any other measure. Therefore, the number of observed non-synonymous convergence (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>) should always be considered in addition to the phylogenetic error-corrected convergence rate (<italic>&#x003c9;</italic><sub><italic>C</italic></sub>), especially in a genome-scale screening with only two or three focal lineages. If many amino acid sites and/or many separate lineages are involved, true convergence is, in general, more easily detected. However, it should be noted that errors due to splicing variants may not be completely eliminated in higher-order branch combinations (Supplementary Text <xref rid="MOESM1" ref-type="media">12</xref>). In this study, we used different threshold values of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>, depending on the application, and our recommended usage is provided in Supplementary Text <xref rid="MOESM1" ref-type="media">13</xref>.</p><p id="Par33">Although it is well established that phenotypes are associated with genotypes, the genetic basis for particular convergently evolved phenotypes may arise from distinct, non-convergent genetic changes<sup><xref ref-type="bibr" rid="CR66">66</xref>,<xref ref-type="bibr" rid="CR67">67</xref></sup>. These specific cases may sometimes occur because of convergent mechanisms, such as the use of similar but not identical amino acids, and the use of similar changes at adjacent residues in the protein structure<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>. The accumulation of knowledge about which mutations are repeatedly selected and which are not during convergent evolution may provide insight into the evolvability and constraints that govern the diversification of organisms.</p><p id="Par34">While some evolutionary innovations may be unique, many traits arose convergently<sup><xref ref-type="bibr" rid="CR69">69</xref></sup>. Fascinating examples not mentioned above include endothermy, hibernation, burrowing, diving, venom injection, electrogenic organs, eusociality, anhydrobiosis, bioluminescence, biomineralization, plant parasitism, mycoheterotrophy and multicellularity. In the past, the observation of similar phenotypes in multiple species led to the theory of evolution by natural selection<sup><xref ref-type="bibr" rid="CR70">70</xref></sup>. The analysis of protein sequences in multiple species gave rise to the formulation of the nearly neutral theory of molecular evolution<sup><xref ref-type="bibr" rid="CR71">71</xref>,<xref ref-type="bibr" rid="CR72">72</xref></sup>. Likewise, cross-species genotype&#x02013;phenotype associations illuminated through the analysis of molecular convergence, coupled with experimental evaluation of mutational effects (Supplementary Text <xref rid="MOESM1" ref-type="media">14</xref>), may lead to new conceptual frameworks on the constraint and adaptive changes at the molecular level that drive phenotypic change among species.</p></sec><sec id="Sec11"><title>Methods</title><sec id="Sec12"><title>Simulated codon sequence evolution</title><p id="Par35">With the input phylogenetic tree (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>), codon sequences of specified length (500 codons) were generated with the &#x02018;simulate&#x02019; function of CSUBST (<ext-link ext-link-type="uri" xlink:href="https://github.com/kfuku52/csubst">https://github.com/kfuku52/csubst</ext-link>), which internally utilizes the Python package pyvolve for simulated sequence evolution<sup><xref ref-type="bibr" rid="CR73">73</xref></sup>. An empirical codon substitution model with multiple nucleotide substitutions<sup><xref ref-type="bibr" rid="CR74">74</xref></sup> was adjusted with observed codon frequencies (ECMK07+F) in the vertebrate genes encoding phosphoglycerol kinases (available from the &#x02018;dataset&#x02019; function of CSUBST). The conventional <italic>&#x003c9;</italic> (<italic>d</italic><italic>N</italic>/<italic>d</italic><italic>S</italic>) was set to 0.2. In the Convergent scenario, 5% of codon sites were evolved convergently in focal lineages (the pair of terminal branches in Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). At convergent codon sites, the frequency of non-synonymous substitutions to codons encoding a single randomly selected amino acid was increased so that non-synonymous substitutions to the selected codons accounted for approximately 90% of the total. This operation increases the probability of amino acid convergence without changing relative frequencies among synonymous codons. The site-specific substitution rate at convergent codon sites was also doubled (that is, <italic>r</italic><sub><italic>l</italic></sub>&#x02009;=&#x02009;2), and a higher non-synonymous/synonymous substitution rate ratio was applied (that is, <italic>&#x003c9;</italic>&#x02009;=&#x02009;5) to mimic adaptive evolution. The simulation parameters for the other scenarios are summarized in Supplementary Table <xref rid="MOESM3" ref-type="media">2</xref>. For the Random scenario, randomized trees were generated in 1,000 simulations with the &#x02018;shuffle&#x02019; function of NWKIT v0.10.0 and the --label option (<ext-link ext-link-type="uri" xlink:href="https://github.com/kfuku52/nwkit">https://github.com/kfuku52/nwkit</ext-link>).</p></sec><sec id="Sec13"><title>In-frame codon sequence alignment</title><p id="Par36">Retrieved coding sequences (<xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>) were formatted into in-frame sequences using the &#x02018;pad&#x02019; function of CDSKIT v0.9.1 (<ext-link ext-link-type="uri" xlink:href="https://github.com/kfuku52/cdskit">https://github.com/kfuku52/cdskit</ext-link>). Stop codons and ambiguous codons were replaced with gaps with the &#x02018;mask&#x02019; function of CDSKIT. Amino acid sequences from translated coding sequences were aligned using MAFFT v7.455 with the --auto option<sup><xref ref-type="bibr" rid="CR75">75</xref></sup>, trimmed with ClipKIT v0.1.2 with default parameters and reverse-translated with the &#x02018;backtrim&#x02019; function of CDSKIT. Gappy codon sites were excluded with the &#x02018;hammer&#x02019; function of CDSKIT.</p></sec><sec id="Sec14"><title>Phylogenetic tree reconstruction</title><p id="Par37">The gene tree was first reconstructed using IQ-TREE v2.0.3 with the general time-reversible nucleotide substitution model and four gamma categories of among-site rate variation (ASRV). To suppress branch attraction in the trees containing HGTs, topological constraints consistent with species classification were generated from the National Center for Biotechnology Information (NCBI) Taxonomy<sup><xref ref-type="bibr" rid="CR76">76</xref></sup> using the &#x02018;constrain&#x02019; function of NWKIT and used for tree search. Ultrafast bootstrapping with 1,000 replicates was performed to evaluate the credibility of tree topology<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> with further optimization of each bootstrapping tree (-bnni option)<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. To improve tree topology, some datasets were subjected to phylogeny reconciliation with the species tree using GeneRax v1.2.2 (ref. <sup><xref ref-type="bibr" rid="CR77">77</xref></sup>) (Supplementary Table <xref rid="MOESM3" ref-type="media">3</xref>). Branching events in gene trees were categorized into speciation or gene duplication by a species-overlap method<sup><xref ref-type="bibr" rid="CR78">78</xref></sup> (<xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>). <italic>Arabidopsis thaliana</italic> orthologues in each clade were inferred from the tree topology. Minor differences in the methods applied to each dataset, from sequence retrieval to phylogenetic analysis, are summarized in Supplementary Table <xref rid="MOESM3" ref-type="media">3</xref>.</p></sec><sec id="Sec15"><title>Detecting convergent expression evolution</title><p id="Par38">Using the dated species tree and rooted gene trees as inputs, the divergence time of individual gene trees was estimated by RADTE (<ext-link ext-link-type="uri" xlink:href="https://github.com/kfuku52/RADTE">https://github.com/kfuku52/RADTE</ext-link>) as described previously<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Evolution of gene expression levels (SVA-log-TMM-FPKM)<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> in brain, heart, kidney, liver, ovary and testis samples was modelled on the dated gene tree with phylogenetic multi-optima Ornstein&#x02013;Uhlenbeck models (that is, Hansen models<sup><xref ref-type="bibr" rid="CR79">79</xref></sup>) with the &#x02018;estimate_shift_configuration&#x02019; function in the R package <italic>l</italic>1ou v1.40 (ref. <sup><xref ref-type="bibr" rid="CR45">45</xref></sup>) as described previously<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Convergent regime shifts were then detected as multiple regime shifts that lead to similar expression levels, as judged by the &#x02018;estimate_convergent_regimes&#x02019; function<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>.</p></sec><sec id="Sec16"><title>Classification of combinatorial substitutions</title><p id="Par39">Combinatorial substitutions were collectively defined as substitutions at the same protein site that occur in multiple independent branches in a phylogenetic tree. When this occurs only in two branches, it is called a paired substitution. In unambiguous notation, we consider paired substitutions along two branches with the same specific state (spe), different states (dif) or any state (any) at the ancestral and derived nodes. The five combinatorial states that are frequently considered in the literature are paired substitutions (any&#x02192;any), double divergence (any&#x02192;dif), convergence (any&#x02192;spe), discordant convergence (dif&#x02192;spe) and congruent convergence (spe&#x02192;spe) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref>). Convergence is discussed throughout this report because it is of particular importance in testing evolutionary genotype&#x02013;phenotype associations.</p></sec><sec id="Sec17"><title>Ancestral state reconstruction and parameter estimation</title><p id="Par40">Our method estimates convergent substitution via ancestral reconstruction. Whereas ancestral amino acid reconstruction has been used in previous reports<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, here we used codon sequence reconstruction. Using the input phylogenetic tree and observed codon sequences, CSUBST internally uses IQ-TREE to estimate the posterior probabilities (PP) of ancestral sequences by the empirical Bayesian method<sup><xref ref-type="bibr" rid="CR80">80</xref></sup> with the ECMK07+F+R4 model by default. At the same time, the parameters used in CSUBST are estimated: equilibrium frequencies of codon state <italic>i</italic> (&#x003c0;<sub><italic>i</italic></sub>), ASRV for a codon site <italic>l</italic> (<italic>r</italic><sub><italic>l</italic></sub>), non-synonymous per synonymous substitution ratio (<italic>&#x003c9;</italic>), and transition per transversion substitution ratio (<italic>&#x003ba;</italic>).</p></sec><sec id="Sec18"><title>Multidimensional array structures for substitution history</title><p id="Par41">CSUBST stores the coding sequences and the reconstructed probable ancestral states in a three-dimensional array whose size is <italic>M</italic>&#x02009;&#x000d7;&#x02009;<italic>L</italic>&#x02009;&#x000d7;&#x02009;61 for a phylogenetic tree with <italic>M</italic> nodes (excluding the root node) generated from an alignment of coding sequences with <italic>L</italic> codon sites, each of which can take a distribution of 61 different codon states (in the universal genetic code), excluding stop codons. We denote by <italic>P</italic><sub><italic>mlj</italic></sub>(<italic>X</italic>|<italic>D</italic>,<italic>&#x003b8;</italic>) the PP of codon <italic>X</italic> for codon state <italic>j</italic> at site <italic>l</italic> on node <italic>m</italic>. The three-dimensional array for codon states is then converted to a four-dimensional array that stores the probability of substitutions with the size of <italic>B</italic>&#x02009;&#x000d7;&#x02009;<italic>L</italic>&#x02009;&#x000d7;&#x02009;61&#x02009;&#x000d7;&#x02009;61, where <italic>B</italic> denotes the number of branches excluding the root branch. This array stores the PP of substitution <italic>P</italic><sub><italic>blij</italic></sub>(<italic>S</italic>|<italic>D</italic>,<italic>&#x003b8;</italic>) for single substitution <italic>S</italic> from ancestral codon state <italic>i</italic> to derived codon state <italic>j</italic> for a codon site <italic>l</italic> in branch <italic>b</italic>. For a site <italic>l</italic> in branch <italic>b</italic> connecting ancestral node <italic>n</italic> with codon state <italic>i</italic> and descendant node <italic>m</italic> with codon state <italic>j</italic>, the PP of substitution matrix <italic>P</italic><sub><italic>ij</italic></sub>(<italic>S</italic>|<italic>D</italic>,<italic>&#x003b8;</italic>) is derived as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{P}_{ij}(S|D,\theta )={P}_{i}(X|D,\theta )\times {P}_{j}{(X|D,\theta )}\\=\left(\begin{array}{c}\begin{array}{c}{i}_{1}\\ {i}_{2}\\ \vdots \end{array}\\ {i}_{61}\end{array}\right)\times (\begin{array}{cccc}{j}_{1} &#x00026; {j}_{2} &#x00026; \cdots &#x00026; {j}_{61}\end{array})=\left(\begin{array}{cccc}{i}_{1}{j}_{1} &#x00026; {i}_{1}{j}_{2} &#x00026; \cdots &#x00026; {i}_{1}{j}_{61}\\ {i}_{2}{j}_{1} &#x00026; {i}_{2}{j}_{2} &#x00026; \cdots &#x00026; {i}_{2}{j}_{61}\\ \vdots &#x00026; \vdots &#x00026; \ddots &#x00026; \vdots \\ {i}_{61}{j}_{1} &#x00026; {i}_{61}{j}_{2} &#x00026; \cdots &#x00026; {i}_{61}{j}_{61}\end{array}\right).\end{array}$$\end{document}</tex-math><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mo>&#x022ee;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022f1;</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ee;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par42">As the transition between the same codon state is not considered a substitution, the diagonal elements (<italic>ij</italic><sub><italic>i</italic>=<italic>j</italic></sub>) are filled with 0. Although equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>) is an approximation that does not take into account the non-independence between nodes of a phylogenetic tree, we confirmed that the effect was negligible (Supplementary Text <xref rid="MOESM1" ref-type="media">15</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref>). For efficient processing of non-synonymous and synonymous substitution probabilities with the array operation of NumPy<sup><xref ref-type="bibr" rid="CR81">81</xref></sup>, the four-dimensional array is converted into a pair of five-dimensional arrays (<italic>A</italic><sup><italic>N</italic></sup> and <italic>A</italic><sup><italic>S</italic></sup> for non-synonymous and synonymous substitutions, respectively) whose individual size is <italic>B</italic>&#x02009;&#x000d7;&#x02009;<italic>L</italic>&#x02009;&#x000d7;&#x02009;<italic>G</italic>&#x02009;&#x000d7;&#x02009;<italic>I</italic>&#x02009;&#x000d7;&#x02009;<italic>J</italic>, where codon states are grouped into <italic>G</italic> categories (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2a</xref>). Stored values range between 0 and 1, denoted by <italic>P</italic><sub><italic>blgij</italic></sub>(<italic>S</italic>|<italic>D</italic>,<italic>&#x003b8;</italic>), the probability of single substitution <italic>S</italic> from ancestral codon <italic>i</italic> to derived codon <italic>j</italic> (<italic>i</italic>&#x02009;&#x02260;&#x02009;<italic>j</italic>) in codon group <italic>g</italic> at site <italic>l</italic> of branch <italic>b</italic>, given the observed sequence data <italic>D</italic> and model parameters <italic>&#x003b8;</italic> that include the phylogenetic tree. The elements in the array <italic>A</italic><sup><italic>N</italic></sup> dictate <italic>P</italic><sub><italic>blgij</italic></sub>(<italic>S</italic><sup><italic>N</italic></sup>|<italic>D</italic>,<italic>&#x003b8;</italic>), the probabilities of non-synonymous substitutions (<italic>S</italic><sup><italic>N</italic></sup>), whereas those in the array <italic>A</italic><sup><italic>S</italic></sup> correspond to <italic>P</italic><sub><italic>blgij</italic></sub>(<italic>S</italic><sup><italic>S</italic></sup>|<italic>D</italic>,<italic>&#x003b8;</italic>), the probabilities of synonymous substitutions (<italic>S</italic><sup><italic>S</italic></sup>). In <italic>A</italic><sup><italic>N</italic></sup>, where the PPs of synonymous codons are merged, a single 20&#x02009;&#x000d7;&#x02009;20 matrix records all the substitution probabilities, and therefore <italic>G</italic>&#x02009;=&#x02009;1 and <italic>I</italic>&#x02009;=&#x02009;<italic>J</italic>&#x02009;=&#x02009;20. Synonymous substitutions occur only between codons that code for the same amino acid. Because there are 20 different amino acids, <italic>G</italic> equals 20 in <italic>A</italic><sup><italic>S</italic></sup>. In the case of the universal genetic code, the maximum number of codons encoding the same amino acid is six, for leucine, serine and arginine, so <italic>I</italic>&#x02009;=&#x02009;<italic>J</italic>&#x02009;=&#x02009;6. In the matrix corresponding to these three amino acids, all values are between 0 and 1, but for amino acids with a smaller number of codons, the out-of-range indices are filled with zero. Missing sites in the sequence alignment are also treated as zero. For simplicity, we explain the case where there is no missing site in the observed sequences and ancestral states in the following sections, but the implementation in CSUBST appropriately takes into account the missing sites by subtracting its numbers from <italic>L</italic> at every necessary step in individual branches or branch combinations.</p></sec><sec id="Sec19"><title>Tree rescaling</title><p id="Par43">During the ancestral state reconstruction, IQ-TREE estimates the branch length as the number of nucleotide substitutions per codon site. Because our model requires the number of codon substitutions rather than the number of nucleotide substitutions, and because branch lengths are required separately for both synonymous and non-synonymous substitutions, we obtained rescaled branch length <italic>t</italic><sub><italic>b</italic></sub> of branch <italic>b</italic> from the substitution probabilities as follows:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{b}=\frac{{\sum }_{l=1}^{L}{\sum }_{g=1}^{G}{\sum }_{i=1}^{I}{\sum }_{j=1}^{J}{P}_{blgij}(S|D,\theta)}{L}.$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><italic>t</italic><sub><italic>b</italic></sub><sup><italic>N</italic></sup> and <italic>t</italic><sub><italic>b</italic></sub><sup><italic>S</italic></sup> for non-synonymous and synonymous substitutions were obtained with <italic>P</italic><sub><italic>blgij</italic></sub>(<italic>S</italic><sup><italic>N</italic></sup>|<italic>D</italic>,<italic>&#x003b8;</italic>) and <italic>P</italic><sub><italic>blgij</italic></sub>(<italic>S</italic><sup><italic>S</italic></sup>|<italic>D</italic>,<italic>&#x003b8;</italic>), respectively. For example, the total branch lengths of the vertebrate phosphoglycerol kinase tree before and after rescaling are 7.57 nucleotide-substitutions/codon-site and 7.21 codon-substitutions/codon-site (1.59 non-synonymous and 5.62 synonymous codon substitutions per codon site).</p></sec><sec id="Sec20"><title>Observed number of combinatorial substitutions</title><p id="Par44">The only true observations are the gene sequences of the extant species, and the PPs of ancestral sequences and codon substitutions are estimates. However, we refer to the PPs as &#x02018;observations&#x02019;<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> to unambiguously distinguish them from the expected values described in the next section. Here we denote by <italic>P</italic><sub><italic>l</italic></sub>(<italic>S</italic><sub><italic>C</italic></sub>|<italic>D</italic>,<italic>&#x003b8;</italic>) the probability of combinatorial substitution <italic>S</italic><sub><italic>C</italic></sub> at codon site <italic>l</italic> given observed sequences <italic>D</italic> and model <italic>&#x003b8;</italic>. The probabilities of non-synonymous and synonymous combinatorial substitutions at site <italic>l</italic> are separately obtained as <italic>P</italic><sub><italic>l</italic></sub>(<italic>S</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>|<italic>D</italic>,<italic>&#x003b8;</italic>) and <italic>P</italic><sub><italic>l</italic></sub>(<italic>S</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>|<italic>D</italic>,<italic>&#x003b8;</italic>), respectively, with the following equations:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{l}\!^{{\rm{any}}\to {\rm{any}}}({S}_{C}|D,\theta )=\mathop{\sum }\limits_{g=1}^{G}\mathop{\prod }\limits_{k=1}^{K}\mathop{\sum }\limits_{i=1}^{I}\mathop{\sum }\limits_{j=1}^{J}{P}_{klgij}(S|D,\theta )\,{\rm{for}}\,{\rm{paired}}\,{\rm{substitutions}},$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">any</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">paired</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">substitutions</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{l}\!^{{\rm{any}}\to {\rm{spe}}}({S}_{C}|D,\theta )=\mathop{\sum }\limits_{g=1}^{G}\sum\limits_{\mathop {j=1}\limits_{{j}_{{k}_{1}}={j}_{{k}_{2}}} }^j\mathop{\prod }\limits_{k=1}^{K}\mathop{\sum }\limits_{i=1}^{I}{P}_{klgij}(S|D,\theta)\,{\rm{for}}\,{\rm{convergence}},$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big"> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>j=1</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">convergence</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{P}_{l}\!^{{\rm{spe}}\to {\rm{spe}}}({S}_{C}|D,\theta )=\\\mathop{\sum }\limits_{g=1}^{G}\sum\limits_{\mathop {i=1}\limits_{{i}_{{k}_{1}}={i}_{{k}_{2}}} }^I\sum\limits_{\mathop {j=1}\limits_{{j}_{{k}_{1}}={j}_{{k}_{2}}} }^J \mathop{\prod }\limits_{k=1}^{K}{P}_{klgij}(S|D,\theta )\,{\rm{for}}\,{\rm{concordant}}\,{\rm{convergence}},\end{array}$$\end{document}</tex-math><mml:math id="M10"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">spe</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big"> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>i=1</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big"> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>j=1</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">concordant</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">convergence</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>k</italic> represents a branch of interest. We denote by <italic>K</italic> the degree of combinatorial substitutions or the number of branches to be compared. Because two branches are often compared in conventional convergence analysis, we explain here the case of <italic>K</italic>&#x02009;=&#x02009;2. A part of array operations in equations (<xref rid="Equ3" ref-type="disp-formula">3</xref>)&#x02013;(<xref rid="Equ5" ref-type="disp-formula">5</xref>) are illustrated in Supplementary Fig. <xref rid="MOESM1" ref-type="media">2b</xref>. The total probabilities of observed substitution pairs across sites in the branch pair are calculated as<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{C}=\mathop{\sum }\limits_{l=1}^{L}{P}_{l}({S}_{C}|D,\theta ).$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><italic>O</italic><sub><italic>C</italic></sub> is separately obtained for non-synonymous and synonymous combinatorial substitutions (<italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>, respectively). By definition (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref>), the values of <italic>O</italic><sub><italic>C</italic></sub> for double divergence and discordant convergence are derived as follows at <italic>K</italic>&#x02009;=&#x02009;2:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O_{C}\!^{{{{\mathrm{any}}}} \to {{{\mathrm{dif}}}}} = O_{C}\!^{{{{\mathrm{any}}}} \to {{{\mathrm{any}}}}} - O_{C}\!^{{{{\mathrm{any}}}} \to {{{\mathrm{spe}}}}}\;{{{\mathrm{for}}}}\;{{{\mathrm{double}}}}\;{{{\mathrm{divergence}}}}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">dif</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">any</mml:mi></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">double</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">divergence</mml:mi></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O_{C}\!^{{{{\mathrm{dif}}}} \to {{{\mathrm{spe}}}}} = O_{C}\!^{{{{\mathrm{any}}}} \to {{{\mathrm{spe}}}}} - O_{C}\!^{{{{\mathrm{spe}}}} \to {{{\mathrm{spe}}}}}\;{{{\mathrm{for}}}}\;{{{\mathrm{discordant}}}}\;{{{\mathrm{convergence}}}}.$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">dif</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">spe</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">discordant</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">convergence</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><italic>C</italic>/<italic>D</italic><sup><xref ref-type="bibr" rid="CR17">17</xref></sup> corresponds to <inline-formula id="IEq1"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O_{N}\!^\mathrm{any \to spe}/O_{N}\!^\mathrm{any \to dif}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any&#x02192;spe</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any&#x02192;dif</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq1.gif"/></alternatives></inline-formula> in our notation.</p></sec><sec id="Sec21"><title>Expected number of combinatorial substitutions</title><p id="Par45">To estimate the rate of combinatorial substitutions, the observed number <italic>O</italic><sub><italic>C</italic></sub> is contrasted with the expected number <italic>E</italic><sub><italic>C</italic></sub>. <italic>E</italic><sub><italic>C</italic></sub> is derived from codon substitution models in a way similar to the previous application of amino acid substitution models<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. The tested codon substitution models include the empirical models ECMK07 and ECMrest<sup><xref ref-type="bibr" rid="CR74">74</xref></sup> and the mechanistic models MG<sup><xref ref-type="bibr" rid="CR82">82</xref></sup> and GY<sup><xref ref-type="bibr" rid="CR83">83</xref></sup>. The same model was consistently used in the ancestral state reconstruction and in deriving the model-based expectations of combinatorial substitutions. In the method described below, empirical equilibrium codon frequencies, the rescaled branch length and ASRV are also taken into account. In the empirical models, the codon substitution rate matrix <italic>Q</italic> is derived according to previous literature<sup><xref ref-type="bibr" rid="CR74">74</xref>,<xref ref-type="bibr" rid="CR84">84</xref></sup> as follows:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q = \left\{ {q_{ij}} \right\} = \left( {\begin{array}{*{20}{c}} - &#x00026; {s_{1,2}} &#x00026; \cdots &#x00026; {s_{1,61}} \\ {s_{2,1}} &#x00026; - &#x00026; \cdots &#x00026; {s_{2,61}} \\ \vdots &#x00026; \vdots &#x00026; \ddots &#x00026; \vdots \\ {s_{61,1}} &#x00026; {s_{61,2}} &#x00026; \cdots &#x00026; - \end{array}} \right) \times\mathrm{diag}\left( {\begin{array}{*{20}{c}} {\pi_1} &#x00026; {\pi _2} &#x00026; \cdots &#x00026; {\pi _{61}} \end{array}} \right),$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mo>&#x02212;</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>61</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x02212;</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>61</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022f1;</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ee;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x02212;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>&#x000d7;</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <italic>s</italic><sub><italic>i</italic></sub><sub>,<italic>j</italic></sub> denotes the exchangeabilities of codon pairs <italic>i</italic> and <italic>j</italic> (<italic>s</italic><sub><italic>ij</italic></sub>&#x02009;=&#x02009;<italic>s</italic><sub><italic>ji</italic></sub>) and &#x003c0;<sub><italic>i</italic></sub> represents the equilibrium frequencies of 61 codons estimated from the input alignment. In the mechanistic models, mechanistic substitution parameters are used instead of the exchangeabilities. In the MG model, <italic>q</italic><sub><italic>ij</italic></sub> is obtained with &#x003c0;<sub><italic>i</italic></sub> and non-synonymous per synonymous substitution ratio <italic>&#x003c9;</italic>, whereas transition per transversion substitution ratio <italic>&#x003ba;</italic> is also taken into account in the GY model. <italic>Q</italic> is then rescaled as<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop {\sum }\limits_{i = 1}^{61} \sum\limits_{\mathop {j = 1}\limits_{{j \ne i}} }^{61} \pi _iq_{ij} = 1.$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big"> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>j=1</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>Finally, the diagonal elements of <italic>Q</italic> are completed as<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{ii} = - \sum\limits_{\mathop {j = 1}\limits_{j \ne i} }^{61} q_{ij}.$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>j=1</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>With substitution rate <italic>r</italic><sub><italic>l</italic></sub> pre-estimated by IQ-TREE, the codon transition probability matrix <italic>P</italic><sub><italic>ij</italic></sub>(<italic>t</italic><sub><italic>b</italic></sub>,<italic>r</italic><sub><italic>l</italic></sub>) after time <italic>t</italic><sub><italic>b</italic></sub> are obtained using matrix exponentiation as<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{ij}\left( {t_b,r_l} \right) = {e}^{Qt_br_l},$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>where CSUBST uses the rescaled branch lengths <italic>t</italic><sub><italic>b</italic></sub><sup><italic>N</italic></sup> or <italic>t</italic><sub><italic>b</italic></sub><sup><italic>S</italic></sup> in place of <italic>t</italic><sub><italic>b</italic></sub>. The distribution of expected substitutions at site <italic>l</italic> in branch <italic>b</italic> connecting ancestral node <italic>n</italic> with codon state <italic>i</italic> and a descendant node is therefore given by<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{ij}({S}^{{\rm{expected}}}|D,\theta )={P}_{i}(X|D,\theta )\times {P}_{ij}(t_b,r_l).$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>Using <italic>P</italic><sub><italic>klgij</italic></sub>(<italic>S</italic><sup>expected</sup>|<italic>D</italic>,<italic>&#x003b8;</italic>) in place of <italic>P</italic><sub><italic>klgij</italic></sub>(<italic>S</italic>|<italic>D</italic>,<italic>&#x003b8;</italic>), the total probabilities of expected substitution pairs across sites in the branch pair denoted by <italic>E</italic><sub><italic>C</italic></sub> are obtained by the same procedure used to obtain <italic>O</italic><sub><italic>C</italic></sub> (equations (<xref rid="Equ3" ref-type="disp-formula">3</xref>)&#x02013;(<xref rid="Equ8" ref-type="disp-formula">8</xref>)). Similar to <italic>O</italic><sub><italic>C</italic></sub>, the expected numbers of combinatorial substitutions (<italic>E</italic><sub><italic>C</italic></sub>) are separately calculated for non-synonymous and synonymous substitutions (<italic>E</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> and <italic>E</italic><sub><italic>C</italic></sub><sup><italic>S</italic></sup>, respectively). By definition (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref>), the following relationships hold at <italic>K</italic>&#x02009;=&#x02009;2:<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_C^{{{{\mathrm{any}}}} \to {{{\mathrm{dif}}}}} = E_C^{{{{\mathrm{any}}}} \to {{{\mathrm{any}}}}} - E_C^{{{{\mathrm{any}}}} \to {{{\mathrm{spe}}}}}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_C^{{{{\mathrm{dif}}}} \to {{{\mathrm{spe}}}}} = E_C^{{{{\mathrm{any}}}} \to {{{\mathrm{spe}}}}} - E_C^{{{{\mathrm{spe}}}} \to {{{\mathrm{spe}}}}}.$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec22"><title>Non-synonymous and synonymous combinatorial substitution rates</title><p id="Par46">With the observed and expected numbers of combinatorial substitutions (<italic>O</italic><sub><italic>C</italic></sub> and <italic>E</italic><sub><italic>C</italic></sub>, respectively), the rates of non-synonymous and synonymous combinatorial substitutions are obtained, respectively, by<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dN_C = O_C^N/E_C^N$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dS_C = O_C^S/E_C^S.$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>Both <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> and <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> are the observed number divided by the expected number. If the theoretically expected number derived from the codon substitution model fully explains the observed number, then both <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> and <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> values would be 1.0. <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> can be regarded as equivalent to <italic>R</italic> with the per-gene equilibrium amino acid frequencies (their <italic>f</italic><sub>gene</sub>), but note that some features are different from the corresponding parts for <italic>R</italic>. In particular, we used the standard procedure to derive codon transition probabilities (equations (<xref rid="Equ12" ref-type="disp-formula">12</xref>) and (<xref rid="Equ13" ref-type="disp-formula">13</xref>) and equation 1.2 in ref. <sup><xref ref-type="bibr" rid="CR16">16</xref></sup>), whereas no matrix exponentiation is applied for <italic>R</italic>. In the 21 vertebrate genome dataset, the total expected convergence (<inline-formula id="IEq2"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{C}\!^{{N},{{{\mathrm{any}}}} \to {{{\mathrm{spe}}}}}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq2.gif"/></alternatives></inline-formula>&#x02009;=&#x02009;6,051,985) corresponds to 87.2% of the total observed convergence (<inline-formula id="IEq3"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O_{C}\!^{{N},{{{\mathrm{any}}}} \to {{{\mathrm{spe}}}}}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq3.gif"/></alternatives></inline-formula>&#x02009;=&#x02009;6,939,070). This expectation matches the observation with better accuracy than the previously published results with the <italic>Drosophila</italic> genomes (582.8/942&#x02009;=&#x02009;61.9% with their JTT-<italic>f</italic><sub>gene</sub> model)<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>.</p></sec><sec id="Sec23"><title>Accounting for a range of combinatorial substitution rates</title><p id="Par47">Under purifying selection, which is the default evolutionary mode of many proteins, the rate of synonymous substitutions is faster than that of non-synonymous substitutions. Therefore, saturation of synonymous substitutions becomes a potential problem, especially in a counting method that cannot properly account for the effects of multiple substitutions. To account for this issue, we applied a transformation of <italic>dS</italic><sub><italic>C</italic></sub> using quantile values (<italic>U</italic><sub><italic>p</italic></sub>) as follows:<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}S_{{C}}\!^{{{{{\mathrm{corrected}}}}}} = \left\{ {\begin{array}{*{20}{c}} {{d}S_{C}\!^{{{{\mathrm{uncorrected}}}}},\mathrm{if}\;{d}S_{{C}}\!^{{{{\mathrm{uncorrected}}}}} \ge{d}N_{C}} \\ U_{p^{dS_{C}}}^{dN_{C}},{\mathrm{otherwise}} \end{array}} \right.,$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">corrected</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">uncorrected</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.16em"/><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">uncorrected</mml:mi></mml:mrow></mml:msup><mml:mo>&#x02265;</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">otherwise</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq4"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{p^{dS_{C}}}^{dN_{C}}$$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq4.gif"/></alternatives></inline-formula> denotes the quantile value of the empirical <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub> distribution at <inline-formula id="IEq5"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^{\mathrm{d}S_{C}}$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq5.gif"/></alternatives></inline-formula>, the quantile rank of the <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> value, among all branch combinations at <italic>K</italic>. This operation rescales <italic>d</italic><italic>S</italic><sub><italic>C</italic></sub> to match its distribution range with that of <italic>d</italic><italic>N</italic><sub><italic>C</italic></sub>, and the resulting <italic>&#x003c9;</italic><sub><italic>C</italic></sub> becomes robust for outlier values (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>). Because of the need for quantile values, this transformation is only applicable when the branch combinations are exhaustively searched. In this work, <inline-formula id="IEq6"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dS_{C}\!^\mathrm{corrected}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">corrected</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq6.gif"/></alternatives></inline-formula> is used at <italic>K</italic>&#x02009;=&#x02009;2 unless otherwise mentioned.</p></sec><sec id="Sec24"><title>Non-synonymous per synonymous combinatorial substitution rate ratio</title><p id="Par48">A non-synonymous per synonymous combinatorial substitution rate ratio for <italic>K</italic> branches is given by<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{C} = \frac{{{d}N_\mathrm{C}}}{{{d}S_{C}}} = \frac{{O_{C}\!^{N}/E_{C}\!^{N}}}{{O_{C}\!^{S}/E_{C}\!^{S}}}.$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41559_2022_1932_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula><italic>&#x003c9;</italic><sub><italic>C</italic></sub> can be separately calculated for different categories of combinatorial substitutions, for example, <inline-formula id="IEq7"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{C}\!^{{{{\mathrm{any}}}} \to {{{\mathrm{any}}}}}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">any</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq7.gif"/></alternatives></inline-formula> for paired substitutions, <inline-formula id="IEq8"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{C}\!^{{{{\mathrm{any}}}} \to {{{\mathrm{spe}}}}}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq8.gif"/></alternatives></inline-formula> for double divergence, <inline-formula id="IEq9"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{C}\!^{{{{\mathrm{any}}}} \to {{{\mathrm{dif}}}}}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">any</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">dif</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq9.gif"/></alternatives></inline-formula> for convergence, <inline-formula id="IEq10"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{C}\!^{{{{\mathrm{dif}}}} \to {{{\mathrm{spe}}}}}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">dif</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq10.gif"/></alternatives></inline-formula> for discordant convergence and <inline-formula id="IEq11"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{C}\!^{{{{\mathrm{spe}}}} \to {{{\mathrm{spe}}}}}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">spe</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">spe</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq11.gif"/></alternatives></inline-formula> for concordant convergence. For simplicity, the derivation of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> was explained above for the combinatorial substitutions illustrated in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref>. However, our method can be applied to other categories of combinatorial substitutions as well. For example, phenotypic convergence may be associated with the same ancestral amino acid substituted to different amino acids<sup><xref ref-type="bibr" rid="CR85">85</xref></sup>, in which case <inline-formula id="IEq12"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{C}\!^{{{{\mathrm{spe}}}} \to {{{\mathrm{any}}}}}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">spe</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="normal">any</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41559_2022_1932_Article_IEq12.gif"/></alternatives></inline-formula> may be useful for analysis.</p></sec><sec id="Sec25"><title>Branch combinations</title><p id="Par49">Combinatorial substitutions are a collection of independently occurring evolutionary events (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref>). Branch combinations containing an ancestor&#x02013;descendant relationship did not satisfy the evolutionary independence and were therefore excluded from the analysis. Although convergent substitutions occurring in sister branch pairs satisfy the evolutionary independence, they are difficult to discriminate and are often treated as a single ancestral substitution. For this reason, sister branches were also excluded from the analysis (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12a</xref>).</p></sec><sec id="Sec26"><title>Analysis of higher-order branch combinations</title><p id="Par50"><italic>O</italic><sub><italic>C</italic></sub> and <italic>E</italic><sub><italic>C</italic></sub>, and hence <italic>&#x003c9;</italic><sub><italic>C</italic></sub>, can also be obtained for combinations of more than two branches (<italic>K</italic>&#x02009;&#x0003e;&#x02009;2). The higher-order analysis is particularly useful when analysing traits with extensively repetitive convergence, such as C<sub>4</sub> photosynthesis, which is thought to have evolved at least 62 times independently<sup><xref ref-type="bibr" rid="CR86">86</xref></sup>. To efficiently explore the higher-order dimensions of branch combinations, we devised a branch-and-bound algorithm that combines the convergence metric cut-off, and the generation of <italic>K</italic>&#x02009;+&#x02009;1 branch combinations from the branch overlaps at <italic>K</italic>&#x02009;&#x02212;&#x02009;1 (Fig. <xref rid="Fig4" ref-type="fig">4a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">12a</xref>). The higher-order analysis starts with an exhaustive comparison of branch pairs (that is, <italic>K</italic>&#x02009;=&#x02009;2). Next, convergent branch pairs are extracted with an <italic>&#x003c9;</italic><sub><italic>C</italic></sub> cut-off value (&#x02265;5.0 in Fig. <xref rid="Fig4" ref-type="fig">4</xref>). At this time, branch pairs with a small number of convergent substitutions are excluded by applying an <italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup> cut-off value (&#x02265;2.0 in Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The convergent branch pairs are then subjected to the all-versus-all comparison. When a shared branch is found, their union is generated as a combination of three branches to be analysed. Before proceeding to the analysis at <italic>K</italic>&#x02009;=&#x02009;3, branch combinations containing a sister or ancestor&#x02013;descendant relationship are discarded. In this way, <italic>K</italic> is sequentially increased by one at a time. As such, the algorithm searches only for higher-order branch combinations that are guaranteed to have sufficient convergence metrics in lower-order combinations. In each round, convergent branch combinations are first extracted by the cut-offs, and then the <italic>K</italic>&#x02009;+&#x02009;1 combinations are generated by the <italic>K</italic>&#x02009;&#x02009;&#x02212;&#x02009;1 overlap, as in the analysis at <italic>K</italic>&#x02009;=&#x02009;2. For example, two, three and four branches should be shared at <italic>K</italic>&#x02009;=&#x02009;3, <italic>K</italic>&#x02009;=&#x02009;4 and <italic>K</italic>&#x02009;=&#x02009;5, respectively. The increase in <italic>K</italic> continues until the algorithm no longer finds a branch combination that satisfies the criteria of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> and <italic>O</italic><sub><italic>C</italic></sub><sup><italic>N</italic></sup>.</p></sec><sec id="Sec27"><title>Implementation of CSUBST</title><p id="Par51">The proposed methods, including the calculation of <italic>&#x003c9;</italic><sub><italic>C</italic></sub> and the branch-and-bound algorithm for higher-order combinations, were implemented in the &#x02018;analyze&#x02019; function of CSUBST, which was written in Python 3 (<ext-link ext-link-type="uri" xlink:href="https://www.python.org/">https://www.python.org/</ext-link>). Phylogenetic tree processing was implemented with the Python package ETE 3 (ref. <sup><xref ref-type="bibr" rid="CR87">87</xref></sup>). Numpy<sup><xref ref-type="bibr" rid="CR81">81</xref></sup>, SciPy<sup><xref ref-type="bibr" rid="CR88">88</xref></sup> and pandas (<ext-link ext-link-type="uri" xlink:href="https://pandas.pydata.org/">https://pandas.pydata.org/</ext-link>) were used for array and table data processing. Parallel computation was performed by multiprocessing with Joblib (<ext-link ext-link-type="uri" xlink:href="https://joblib.readthedocs.io/en/latest/">https://joblib.readthedocs.io/en/latest/</ext-link>). The intensive calculation was optimized with Cython<sup><xref ref-type="bibr" rid="CR89">89</xref></sup>.</p></sec><sec id="Sec28"><title>Mapping combinatorial substitutions to protein structures</title><p id="Par52">For the analysis of protein structures, a streamlined pipeline was implemented in the &#x02018;site&#x02019; function of CSUBST. Using the &#x02018;--pdb besthit&#x02019; option, CSUBST requests an online MMseqs2 search<sup><xref ref-type="bibr" rid="CR90">90</xref></sup> against the RSCB Protein Data Bank (PDB)<sup><xref ref-type="bibr" rid="CR91">91</xref></sup> to obtain three-dimensional conformation data of closely related proteins. If no hit is obtained, a BLASTP search against the UniProt database is run on the QBLAST server to identify the best hit protein for which AlphaFold-predicted structure is available<sup><xref ref-type="bibr" rid="CR92">92</xref>,<xref ref-type="bibr" rid="CR93">93</xref></sup>. For some proteins, structural data were manually selected because more appropriate structures were available (for example, with substrate). Subsequently, CSUBST internally uses MAFFT to generate protein alignments to determine the homologous positions of amino acids and to write a PyMOL session file. The protein structures were visualized using Open-Source PyMOL v2.4.0 (<ext-link ext-link-type="uri" xlink:href="https://github.com/schrodinger/pymol-open-source">https://github.com/schrodinger/pymol-open-source</ext-link>).</p></sec><sec id="Sec29"><title>Reporting summary</title><p id="Par53">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p></sec></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec30"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41559_2022_1932_MOESM1_ESM.pdf"><label>Supplementary Information</label><caption><p>Supplementary Methods, Texts 1&#x02013;17, Figs. S1&#x02013;S16 and References.</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41559_2022_1932_MOESM2_ESM.pdf"><caption><p>Reporting Summary.</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="41559_2022_1932_MOESM3_ESM.pdf"><caption><p>Peer Review File.</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="41559_2022_1932_MOESM4_ESM.xlsx"><label>Supplementary Tables</label><caption><p>Supplementary Tables S1&#x02013;S10.</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Publisher&#x02019;s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><sec id="FPar1" sec-type="supplementary-material"><title>Supplementary information</title><p id="Par54">The online version contains supplementary material available at 10.1038/s41559-022-01932-7.</p></sec></sec><ack><title>Acknowledgements</title><p>We acknowledge the following sources for funding: MEXT/JSPS KAKENHI 18J00178 (K.F.), the Sofja Kovalevskaja programme of the Alexander von Humboldt Foundation (K.F.), a Human Frontier Science Program Young Investigators Grant RGY0082/2021 (K.F.) and National Institutes of Health (NIH) R01 GM083127 (D.D.P.). Computations were partially performed on the National Institute of Genetics supercomputer.</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>K.F. conceptualized the study. K.F. designed and wrote all programmes and performed data analysis. D.D.P. contributed to conceptualizing and helping guide the analysis. K.F. and D.D.P. wrote the paper.</p></notes><notes notes-type="peer-review"><title>Peer review</title><sec id="FPar2"><title>Peer review information</title><p id="Par55"><italic>Nature Ecology &#x00026; Evolution</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. <xref rid="MOESM3" ref-type="media">Peer reviewer reports</xref> are available.</p></sec></notes><notes notes-type="data-availability"><title>Data availability</title><p>Raw data and results are available at 10.5061/dryad.tx95x6b0v<sup><xref ref-type="bibr" rid="CR94">94</xref></sup>.</p></notes><notes notes-type="data-availability"><title>Code availability</title><p>CSUBST is available from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/kfuku52/csubst">https://github.com/kfuku52/csubst</ext-link>). The results reported in this study can be reproduced with CSUBST v0.20.17. The notation in this paper is consistent with CSUBST v1.0.0. Scripts used in this study are available at 10.5061/dryad.tx95x6b0v<sup><xref ref-type="bibr" rid="CR94">94</xref></sup>.</p></notes><notes id="FPar3" notes-type="COI-statement"><title>Competing interests</title><p id="Par56">The authors declare no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Losos, J. B. <italic>Improbable Destinies: Fate, Chance, and the Future of Evolution</italic> (Riverhead Books, 2017).</mixed-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stern</surname><given-names>DL</given-names></name></person-group><article-title>The genetic causes of convergent evolution</article-title><source>Nat. Rev. Genet.</source><year>2013</year><volume>14</volume><fpage>751</fpage><lpage>764</lpage><pub-id pub-id-type="doi">10.1038/nrg3483</pub-id><pub-id pub-id-type="pmid">24105273</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storz</surname><given-names>JF</given-names></name></person-group><article-title>Causes of molecular convergence and parallelism in protein evolution</article-title><source>Nat. Rev. Genet.</source><year>2016</year><volume>17</volume><fpage>239</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1038/nrg.2016.11</pub-id><pub-id pub-id-type="pmid">26972590</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>A</given-names></name><name><surname>Orgogozo</surname><given-names>V</given-names></name></person-group><article-title>The loci of repeated evolution: a catalog of genetic hotspots of phenotypic variation</article-title><source>Evolution</source><year>2013</year><volume>67</volume><fpage>1235</fpage><lpage>1250</lpage><pub-id pub-id-type="pmid">23617905</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ujvari</surname><given-names>B</given-names></name><etal/></person-group><article-title>Widespread convergence in toxin resistance by predictable molecular evolution</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2015</year><volume>112</volume><fpage>11911</fpage><lpage>11916</lpage><pub-id pub-id-type="doi">10.1073/pnas.1511706112</pub-id><pub-id pub-id-type="pmid">26372961</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sirikantaramas</surname><given-names>S</given-names></name><name><surname>Yamazaki</surname><given-names>M</given-names></name><name><surname>Saito</surname><given-names>K</given-names></name></person-group><article-title>Mutations in topoisomerase I as a self-resistance mechanism coevolved with the production of the anticancer alkaloid camptothecin in plants</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2008</year><volume>105</volume><fpage>6782</fpage><lpage>6786</lpage><pub-id pub-id-type="doi">10.1073/pnas.0801038105</pub-id><pub-id pub-id-type="pmid">18443285</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewin</surname><given-names>HA</given-names></name><etal/></person-group><article-title>The Earth BioGenome Project 2020: starting the clock</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2022</year><volume>119</volume><fpage>e2115635118</fpage><pub-id pub-id-type="doi">10.1073/pnas.2115635118</pub-id><pub-id pub-id-type="pmid">35042800</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohta</surname><given-names>T</given-names></name></person-group><article-title>Near-neutrality in evolution of genes and gene regulation</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2002</year><volume>99</volume><fpage>16134</fpage><lpage>16137</lpage><pub-id pub-id-type="doi">10.1073/pnas.252626899</pub-id><pub-id pub-id-type="pmid">12461171</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname><given-names>FK</given-names></name><name><surname>Hahn</surname><given-names>Y</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name></person-group><article-title>Gene tree discordance can generate patterns of diminishing convergence over time</article-title><source>Mol. Biol. Evol.</source><year>2016</year><volume>33</volume><fpage>3299</fpage><lpage>3307</lpage><pub-id pub-id-type="doi">10.1093/molbev/msw197</pub-id><pub-id pub-id-type="pmid">27634870</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foote</surname><given-names>AD</given-names></name><etal/></person-group><article-title>Convergent evolution of the genomes of marine mammals</article-title><source>Nat. Genet.</source><year>2015</year><volume>47</volume><fpage>272</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1038/ng.3198</pub-id><pub-id pub-id-type="pmid">25621460</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>GWC</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name></person-group><article-title>Determining the null model for detecting adaptive convergence from genomic data: a case study using echolocating mammals</article-title><source>Mol. Biol. Evol.</source><year>2015</year><volume>32</volume><fpage>1232</fpage><lpage>1236</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv013</pub-id><pub-id pub-id-type="pmid">25631926</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><article-title>No genome-wide protein sequence convergence for echolocation</article-title><source>Mol. Biol. Evol.</source><year>2015</year><volume>32</volume><fpage>1237</fpage><lpage>1241</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv014</pub-id><pub-id pub-id-type="pmid">25631925</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castoe</surname><given-names>TA</given-names></name><etal/></person-group><article-title>Evidence for an ancient adaptive episode of convergent molecular evolution</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2009</year><volume>106</volume><fpage>8986</fpage><lpage>8991</lpage><pub-id pub-id-type="doi">10.1073/pnas.0900233106</pub-id><pub-id pub-id-type="pmid">19416880</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname><given-names>FK</given-names></name><name><surname>Livera</surname><given-names>AP</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name></person-group><article-title>The perils of intralocus recombination for inferences of molecular convergence</article-title><source>Philos. Trans. R. Soc. B</source><year>2019</year><volume>374</volume><fpage>20180244</fpage><pub-id pub-id-type="doi">10.1098/rstb.2018.0244</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>GWC</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name><name><surname>Hahn</surname><given-names>Y</given-names></name></person-group><article-title>The effects of increasing the number of taxa on inferences of molecular convergence</article-title><source>Genome Biol. Evol.</source><year>2017</year><volume>9</volume><fpage>213</fpage><lpage>221</lpage><pub-id pub-id-type="pmid">28057728</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">Yang, Z. <italic>Computational Molecular Evolution</italic> (Oxford Univ. Press, 2006).</mixed-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldstein</surname><given-names>RA</given-names></name><name><surname>Pollard</surname><given-names>ST</given-names></name><name><surname>Shah</surname><given-names>SD</given-names></name><name><surname>Pollock</surname><given-names>DD</given-names></name></person-group><article-title>Nonadaptive amino acid convergence rates decrease over time</article-title><source>Mol. Biol. Evol.</source><year>2015</year><volume>32</volume><fpage>1373</fpage><lpage>1381</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv041</pub-id><pub-id pub-id-type="pmid">25737491</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><article-title>Are convergent and parallel amino acid substitutions in protein evolution more prevalent than neutral expectations?</article-title><source>Mol. Biol. Evol.</source><year>2015</year><volume>32</volume><fpage>2085</fpage><lpage>2096</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv091</pub-id><pub-id pub-id-type="pmid">25862140</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobler</surname><given-names>S</given-names></name><name><surname>Dalla</surname><given-names>S</given-names></name><name><surname>Wagschal</surname><given-names>V</given-names></name><name><surname>Agrawal</surname><given-names>AA</given-names></name></person-group><article-title>Community-wide convergent evolution in insect adaptation to toxic cardenolides by substitutions in the Na,K-ATPase</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2012</year><volume>109</volume><fpage>13040</fpage><lpage>13045</lpage><pub-id pub-id-type="doi">10.1073/pnas.1202111109</pub-id><pub-id pub-id-type="pmid">22826239</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>L</given-names></name><etal/></person-group><article-title>Predictability in the evolution of Orthopteran cardenolide insensitivity</article-title><source>Philos. Trans. R. Soc. B</source><year>2019</year><volume>374</volume><fpage>20180246</fpage><pub-id pub-id-type="doi">10.1098/rstb.2018.0246</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhen</surname><given-names>Y</given-names></name><name><surname>Aardema</surname><given-names>ML</given-names></name><name><surname>Medina</surname><given-names>EM</given-names></name><name><surname>Schumer</surname><given-names>M</given-names></name><name><surname>Andolfatto</surname><given-names>P</given-names></name></person-group><article-title>Parallel molecular evolution in an herbivore community</article-title><source>Science</source><year>2012</year><volume>337</volume><fpage>1634</fpage><lpage>1637</lpage><pub-id pub-id-type="doi">10.1126/science.1226630</pub-id><pub-id pub-id-type="pmid">23019645</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Convergent sequence evolution between echolocating bats and dolphins</article-title><source>Curr. Biol.</source><year>2010</year><volume>20</volume><fpage>R53</fpage><lpage>R54</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2009.11.058</pub-id><pub-id pub-id-type="pmid">20129036</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Qi</surname><given-names>F-Y</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Ren</surname><given-names>H-Q</given-names></name><name><surname>Shi</surname><given-names>P</given-names></name></person-group><article-title>Parallel sites implicate functional convergence of the hearing gene prestin among echolocating mammals</article-title><source>Mol. Biol. Evol.</source><year>2014</year><volume>31</volume><fpage>2415</fpage><lpage>2424</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu194</pub-id><pub-id pub-id-type="pmid">24951728</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname><given-names>CB</given-names></name><name><surname>Schilling</surname><given-names>JW</given-names></name><name><surname>Wilson</surname><given-names>AC</given-names></name></person-group><article-title>Adaptive evolution in the stomach lysozymes of foregut fermenters</article-title><source>Nature</source><year>1987</year><volume>330</volume><fpage>401</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1038/330401a0</pub-id><pub-id pub-id-type="pmid">3120013</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><article-title>Parallel adaptive origins of digestive RNases in Asian and African leaf monkeys</article-title><source>Nat. Genet.</source><year>2006</year><volume>38</volume><fpage>819</fpage><lpage>823</lpage><pub-id pub-id-type="doi">10.1038/ng1812</pub-id><pub-id pub-id-type="pmid">16767103</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name></person-group><article-title>Detection of convergent and parallel evolution at the amino acid sequence level</article-title><source>Mol. Biol. Evol.</source><year>1997</year><volume>14</volume><fpage>527</fpage><lpage>536</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025789</pub-id><pub-id pub-id-type="pmid">9159930</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fukushima</surname><given-names>K</given-names></name><etal/></person-group><article-title>Genome of the pitcher plant <italic>Cephalotus</italic> reveals genetic changes associated with carnivory</article-title><source>Nat. Ecol. Evol.</source><year>2017</year><volume>1</volume><fpage>0059</fpage><pub-id pub-id-type="doi">10.1038/s41559-016-0059</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Besnard</surname><given-names>G</given-names></name><etal/></person-group><article-title>Phylogenomics of C<sub>4</sub> photosynthesis in sedges (Cyperaceae): multiple appearances and genetic convergence</article-title><source>Mol. Biol. Evol.</source><year>2009</year><volume>26</volume><fpage>1909</fpage><lpage>1919</lpage><pub-id pub-id-type="doi">10.1093/molbev/msp103</pub-id><pub-id pub-id-type="pmid">19461115</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christin</surname><given-names>P-A</given-names></name><name><surname>Salamin</surname><given-names>N</given-names></name><name><surname>Savolainen</surname><given-names>V</given-names></name><name><surname>Duvall</surname><given-names>MR</given-names></name><name><surname>Besnard</surname><given-names>G</given-names></name></person-group><article-title>C<sub>4</sub> photosynthesis evolved in grasses via parallel adaptive genetic changes</article-title><source>Curr. Biol.</source><year>2007</year><volume>17</volume><fpage>1241</fpage><lpage>1247</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2007.06.036</pub-id><pub-id pub-id-type="pmid">17614282</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunning</surname><given-names>LT</given-names></name><etal/></person-group><article-title>Lateral transfers of large DNA fragments spread functional genes among grasses</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2019</year><volume>116</volume><fpage>4416</fpage><lpage>4425</lpage><pub-id pub-id-type="doi">10.1073/pnas.1810031116</pub-id><pub-id pub-id-type="pmid">30787193</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Convergent horizontal gene transfer and cross-talk of mobile nucleic acids in parasitic plants</article-title><source>Nat. Plants</source><year>2019</year><volume>5</volume><fpage>991</fpage><lpage>1001</lpage><pub-id pub-id-type="doi">10.1038/s41477-019-0458-0</pub-id><pub-id pub-id-type="pmid">31332314</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emms</surname><given-names>DM</given-names></name><name><surname>Kelly</surname><given-names>S</given-names></name></person-group><article-title>OrthoFinder: phylogenetic orthology inference for comparative genomics</article-title><source>Genome Biol.</source><year>2019</year><volume>20</volume><fpage>238</fpage><pub-id pub-id-type="doi">10.1186/s13059-019-1832-y</pub-id><pub-id pub-id-type="pmid">31727128</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoang</surname><given-names>DT</given-names></name><name><surname>Chernomor</surname><given-names>O</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Vinh</surname><given-names>LS</given-names></name></person-group><article-title>UFBoot2: improving the ultrafast bootstrap approximation</article-title><source>Mol. Biol. Evol.</source><year>2018</year><volume>35</volume><fpage>518</fpage><lpage>522</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx281</pub-id><pub-id pub-id-type="pmid">29077904</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Nguyen</surname><given-names>MAT</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name></person-group><article-title>Ultrafast approximation for phylogenetic bootstrap</article-title><source>Mol. Biol. Evol.</source><year>2013</year><volume>30</volume><fpage>1188</fpage><lpage>1195</lpage><pub-id pub-id-type="doi">10.1093/molbev/mst024</pub-id><pub-id pub-id-type="pmid">23418397</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ballatori</surname><given-names>N</given-names></name><etal/></person-group><article-title>OST&#x003b1;-OST&#x003b2;: a major basolateral bile acid and steroid transporter in human intestinal, renal, and biliary epithelia</article-title><source>Hepatology</source><year>2005</year><volume>42</volume><fpage>1270</fpage><lpage>1279</lpage><pub-id pub-id-type="doi">10.1002/hep.20961</pub-id><pub-id pub-id-type="pmid">16317684</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiang</surname><given-names>JYL</given-names></name><name><surname>Ferrell</surname><given-names>JM</given-names></name></person-group><article-title>Up to date on cholesterol 7 alpha-hydroxylase (CYP7A1) in bile acid synthesis</article-title><source>Liver Res.</source><year>2020</year><volume>4</volume><fpage>47</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1016/j.livres.2020.05.001</pub-id><pub-id pub-id-type="pmid">34290896</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="other">Noble, R. C. in <italic>Lipid Metabolism in Ruminant Animals</italic> (ed. Christie, W. W.) 57&#x02013;93 (Pergamon, 1981).</mixed-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagey</surname><given-names>LR</given-names></name><name><surname>Schteingart</surname><given-names>CD</given-names></name><name><surname>Rossi</surname><given-names>SS</given-names></name><name><surname>Ton-Nu</surname><given-names>H-T</given-names></name><name><surname>Hofmann</surname><given-names>AF</given-names></name></person-group><article-title>An <italic>N</italic>-acyl glycyltaurine conjugate of deoxycholic acid in the biliary bile acids of the rabbit</article-title><source>J. Lipid Res.</source><year>1998</year><volume>39</volume><fpage>2119</fpage><lpage>2124</lpage><pub-id pub-id-type="doi">10.1016/S0022-2275(20)32466-4</pub-id><pub-id pub-id-type="pmid">9799797</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patel</surname><given-names>A</given-names></name><etal/></person-group><article-title>DNA conformation induces adaptable binding by tandem zinc finger proteins</article-title><source>Cell</source><year>2018</year><volume>173</volume><fpage>221</fpage><lpage>233</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.02.058</pub-id><pub-id pub-id-type="pmid">29551271</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mulchande</surname><given-names>J</given-names></name><etal/></person-group><article-title>The efficiency of C-4 substituents in activating the &#x003b2;-lactam scaffold towards serine proteases and hydroxide ion</article-title><source>Org. Biomol. Chem.</source><year>2007</year><volume>5</volume><fpage>2617</fpage><lpage>2626</lpage><pub-id pub-id-type="doi">10.1039/b706622h</pub-id><pub-id pub-id-type="pmid">18019537</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weston</surname><given-names>SA</given-names></name><name><surname>Lahm</surname><given-names>A</given-names></name><name><surname>Suck</surname><given-names>D</given-names></name></person-group><article-title>X-ray structure of the DNase I-d(GGTATACC)<sub>2</sub> complex at 2.3&#x000c5; resolution</article-title><source>J. Mol. Biol.</source><year>1992</year><volume>226</volume><fpage>1237</fpage><lpage>1256</lpage><pub-id pub-id-type="doi">10.1016/0022-2836(92)91064-V</pub-id><pub-id pub-id-type="pmid">1518054</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujihara</surname><given-names>J</given-names></name><name><surname>Yasuda</surname><given-names>T</given-names></name><name><surname>Ueki</surname><given-names>M</given-names></name><name><surname>Iida</surname><given-names>R</given-names></name><name><surname>Takeshita</surname><given-names>H</given-names></name></person-group><article-title>Comparative biochemical properties of vertebrate deoxyribonuclease I</article-title><source>Comp. Biochem. Physiol. B</source><year>2012</year><volume>163</volume><fpage>263</fpage><lpage>273</lpage><pub-id pub-id-type="doi">10.1016/j.cbpb.2012.07.002</pub-id><pub-id pub-id-type="pmid">22885404</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nishikawa</surname><given-names>A</given-names></name><name><surname>Gregory</surname><given-names>W</given-names></name><name><surname>Frenz</surname><given-names>J</given-names></name><name><surname>Cacia</surname><given-names>J</given-names></name><name><surname>Kornfeld</surname><given-names>S</given-names></name></person-group><article-title>The phosphorylation of bovine DNase I Asn-linked oligosaccharides is dependent on specific lysine and arginine residues</article-title><source>J. Biol. Chem.</source><year>1997</year><volume>272</volume><fpage>19408</fpage><lpage>19412</lpage><pub-id pub-id-type="doi">10.1074/jbc.272.31.19408</pub-id><pub-id pub-id-type="pmid">9235940</pub-id></element-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fukushima</surname><given-names>K</given-names></name><name><surname>Pollock</surname><given-names>DD</given-names></name></person-group><article-title>Amalgamated cross-species transcriptomes reveal organ-specific propensity in gene expression evolution</article-title><source>Nat. Commun.</source><year>2020</year><volume>11</volume><fpage>4459</fpage><pub-id pub-id-type="doi">10.1038/s41467-020-18090-8</pub-id><pub-id pub-id-type="pmid">32900997</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khabbazian</surname><given-names>M</given-names></name><name><surname>Kriebel</surname><given-names>R</given-names></name><name><surname>Rohe</surname><given-names>K</given-names></name><name><surname>An&#x000e9;</surname><given-names>C</given-names></name></person-group><article-title>Fast and accurate detection of evolutionary shifts in Ornstein&#x02013;Uhlenbeck models</article-title><source>Methods Ecol. Evol.</source><year>2016</year><volume>7</volume><fpage>811</fpage><lpage>824</lpage><pub-id pub-id-type="doi">10.1111/2041-210X.12534</pub-id></element-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yanai</surname><given-names>I</given-names></name><etal/></person-group><article-title>Genome-wide midrange transcription profiles reveal expression level relationships in human tissue specification</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>650</fpage><lpage>659</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bti042</pub-id><pub-id pub-id-type="pmid">15388519</pub-id></element-citation></ref><ref id="CR47"><label>47.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaessmann</surname><given-names>H</given-names></name></person-group><article-title>Origins, evolution, and phenotypic impact of new genes</article-title><source>Genome Res.</source><year>2010</year><volume>20</volume><fpage>1313</fpage><lpage>1326</lpage><pub-id pub-id-type="doi">10.1101/gr.101386.109</pub-id><pub-id pub-id-type="pmid">20651121</pub-id></element-citation></ref><ref id="CR48"><label>48.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleene</surname><given-names>KC</given-names></name></person-group><article-title>Sexual selection, genetic conflict, selfish genes, and the atypical patterns of gene expression in spermatogenic cells</article-title><source>Dev. Biol.</source><year>2005</year><volume>277</volume><fpage>16</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2004.09.031</pub-id><pub-id pub-id-type="pmid">15572136</pub-id></element-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="other">Nakayama, T. et al. in <italic>Enzymology and Molecular Biology of Carbonyl Metabolism 3</italic> (eds Weiner, H. et al.) 187&#x02013;196 (Springer US, 1991).</mixed-citation></ref><ref id="CR50"><label>50.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>K</given-names></name><etal/></person-group><article-title>Monkey 3-deoxyglucosone reductase: tissue distribution and purification of three multiple forms of the kidney enzyme that are identical with dihydrodiol dehydrogenase, aldehyde reductase, and aldose reductase</article-title><source>Arch. Biochem. Biophys.</source><year>1993</year><volume>307</volume><fpage>286</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1006/abbi.1993.1591</pub-id><pub-id pub-id-type="pmid">8274014</pub-id></element-citation></ref><ref id="CR51"><label>51.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakagawa</surname><given-names>M</given-names></name><etal/></person-group><article-title>Dimeric dihydrodiol dehydrogenase in monkey kidney. Substrate specificity, stereospecificity of hydrogen transfer, and distribution</article-title><source>J. Biochem.</source><year>1989</year><volume>106</volume><fpage>1104</fpage><lpage>1109</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.jbchem.a122973</pub-id><pub-id pub-id-type="pmid">2697716</pub-id></element-citation></ref><ref id="CR52"><label>52.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>K</given-names></name><etal/></person-group><article-title>Purification and characterization of dimeric dihydrodiol dehydrogenase from dog liver</article-title><source>J. Biochem.</source><year>1994</year><volume>116</volume><fpage>711</fpage><lpage>717</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.jbchem.a124585</pub-id><pub-id pub-id-type="pmid">7852295</pub-id></element-citation></ref><ref id="CR53"><label>53.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arimitsu</surname><given-names>E</given-names></name><etal/></person-group><article-title>Cloning and sequencing of the cDNA species for mammalian dimeric dihydrodiol dehydrogenases</article-title><source>Biochem. J.</source><year>1999</year><volume>342</volume><fpage>721</fpage><lpage>728</lpage><pub-id pub-id-type="doi">10.1042/bj3420721</pub-id><pub-id pub-id-type="pmid">10477285</pub-id></element-citation></ref><ref id="CR54"><label>54.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedges</surname><given-names>SB</given-names></name><name><surname>Marin</surname><given-names>J</given-names></name><name><surname>Suleski</surname><given-names>M</given-names></name><name><surname>Paymer</surname><given-names>M</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name></person-group><article-title>Tree of life reveals clock-like speciation and diversification</article-title><source>Mol. Biol. Evol.</source><year>2015</year><volume>32</volume><fpage>835</fpage><lpage>845</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv037</pub-id><pub-id pub-id-type="pmid">25739733</pub-id></element-citation></ref><ref id="CR55"><label>55.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carbone</surname><given-names>V</given-names></name><name><surname>Hara</surname><given-names>A</given-names></name><name><surname>El-Kabbani</surname><given-names>O</given-names></name></person-group><article-title>Structural and functional features of dimeric dihydrodiol dehydrogenase</article-title><source>Cell. Mol. Life Sci.</source><year>2008</year><volume>65</volume><fpage>1464</fpage><lpage>1474</lpage><pub-id pub-id-type="doi">10.1007/s00018-008-7508-5</pub-id><pub-id pub-id-type="pmid">18264804</pub-id></element-citation></ref><ref id="CR56"><label>56.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carbone</surname><given-names>V</given-names></name><etal/></person-group><article-title>Structures of dimeric dihydrodiol dehydrogenase apoenzyme and inhibitor complex: probing the subunit interface with site-directed mutagenesis</article-title><source>Proteins Struct. Funct. Bioinf.</source><year>2008</year><volume>70</volume><fpage>176</fpage><lpage>187</lpage><pub-id pub-id-type="doi">10.1002/prot.21566</pub-id></element-citation></ref><ref id="CR57"><label>57.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Land</surname><given-names>AH</given-names></name><name><surname>Doig</surname><given-names>AG</given-names></name></person-group><article-title>An automatic method of solving discrete programming problems</article-title><source>Econometrica</source><year>1960</year><volume>28</volume><fpage>497</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.2307/1910129</pub-id></element-citation></ref><ref id="CR58"><label>58.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hermans</surname><given-names>J</given-names></name><name><surname>Westhoff</surname><given-names>P</given-names></name></person-group><article-title>Homologous genes for the C<sub>4</sub> isoform of phosphoenolpyruvate carboxylase in a C<sub>3</sub> and a C<sub>4</sub>
<italic>Flaveria</italic> species</article-title><source>Mol. Gener. Genet.</source><year>1992</year><volume>234</volume><fpage>275</fpage><lpage>284</lpage><pub-id pub-id-type="doi">10.1007/BF00283848</pub-id></element-citation></ref><ref id="CR59"><label>59.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poetsch</surname><given-names>W</given-names></name><name><surname>Hermans</surname><given-names>J</given-names></name><name><surname>Westhoff</surname><given-names>P</given-names></name></person-group><article-title>Multiple cDNAs of phosphoenolpyruvate carboxylase in the C<sub>4</sub> dicot <italic>Flaveria trinervia</italic></article-title><source>FEBS Lett.</source><year>1991</year><volume>292</volume><fpage>133</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.1016/0014-5793(91)80850-3</pub-id><pub-id pub-id-type="pmid">1720398</pub-id></element-citation></ref><ref id="CR60"><label>60.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bl&#x000e4;sing</surname><given-names>OE</given-names></name><name><surname>Westhoff</surname><given-names>P</given-names></name><name><surname>Svensson</surname><given-names>P</given-names></name></person-group><article-title>Evolution of C4 phosphoenolpyruvate carboxylase in <italic>Flaveria</italic>, a conserved serine residue in the carboxyl-terminal part of the enzyme is a major determinant for C4-specific characteristics</article-title><source>J. Biol. Chem.</source><year>2000</year><volume>275</volume><fpage>27917</fpage><lpage>27923</lpage><pub-id pub-id-type="doi">10.1074/jbc.M909832199</pub-id><pub-id pub-id-type="pmid">10871630</pub-id></element-citation></ref><ref id="CR61"><label>61.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DiMario</surname><given-names>RJ</given-names></name><name><surname>Cousins</surname><given-names>AB</given-names></name></person-group><article-title>A single serine to alanine substitution decreases bicarbonate affinity of phospho<italic>enol</italic>pyruvate carboxylase in C<sub>4</sub>
<italic>Flaveria trinervia</italic></article-title><source>J. Exp. Bot.</source><year>2019</year><volume>70</volume><fpage>995</fpage><lpage>1004</lpage><pub-id pub-id-type="doi">10.1093/jxb/ery403</pub-id><pub-id pub-id-type="pmid">30517744</pub-id></element-citation></ref><ref id="CR62"><label>62.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engelmann</surname><given-names>S</given-names></name><name><surname>Bl&#x000e4;sing</surname><given-names>OE</given-names></name><name><surname>Westhoff</surname><given-names>P</given-names></name><name><surname>Svensson</surname><given-names>P</given-names></name></person-group><article-title>Serine 774 and amino acids 296 to 437 comprise the major C4 determinants of the C4 phospho<italic>enol</italic>pyruvate carboxylase of <italic>Flaveria trinervia</italic></article-title><source>FEBS Lett.</source><year>2002</year><volume>524</volume><fpage>11</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1016/S0014-5793(02)02975-7</pub-id><pub-id pub-id-type="pmid">12135733</pub-id></element-citation></ref><ref id="CR63"><label>63.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pease</surname><given-names>JB</given-names></name><name><surname>Haak</surname><given-names>DC</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name><name><surname>Moyle</surname><given-names>LC</given-names></name></person-group><article-title>Phylogenomics reveals three sources of adaptive variation during a rapid radiation</article-title><source>PLoS Biol.</source><year>2016</year><volume>14</volume><fpage>e1002379</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1002379</pub-id><pub-id pub-id-type="pmid">26871574</pub-id></element-citation></ref><ref id="CR64"><label>64.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>SD</given-names></name><name><surname>Pennell</surname><given-names>MW</given-names></name><name><surname>Dunn</surname><given-names>CW</given-names></name><name><surname>Edwards</surname><given-names>SV</given-names></name></person-group><article-title>Phylogenetics is the new genetics (for most of biodiversity)</article-title><source>Trends Ecol. Evol.</source><year>2020</year><volume>35</volume><fpage>415</fpage><lpage>425</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2020.01.005</pub-id><pub-id pub-id-type="pmid">32294423</pub-id></element-citation></ref><ref id="CR65"><label>65.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Rare variant contribution to human disease in 281,104 UK Biobank exomes</article-title><source>Nature</source><year>2021</year><volume>597</volume><fpage>527</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03855-y</pub-id><pub-id pub-id-type="pmid">34375979</pub-id></element-citation></ref><ref id="CR66"><label>66.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Concha</surname><given-names>C</given-names></name><etal/></person-group><article-title>Interplay between developmental flexibility and determinism in the evolution of mimetic <italic>Heliconius</italic> wing patterns</article-title><source>Curr. Biol.</source><year>2019</year><volume>29</volume><fpage>3996</fpage><lpage>4009.e4</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.10.010</pub-id><pub-id pub-id-type="pmid">31735676</pub-id></element-citation></ref><ref id="CR67"><label>67.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Natarajan</surname><given-names>C</given-names></name><etal/></person-group><article-title>Predictable convergence in hemoglobin function has unpredictable molecular underpinnings</article-title><source>Science</source><year>2016</year><volume>354</volume><fpage>336</fpage><lpage>339</lpage><pub-id pub-id-type="doi">10.1126/science.aaf9070</pub-id><pub-id pub-id-type="pmid">27846568</pub-id></element-citation></ref><ref id="CR68"><label>68.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castoe</surname><given-names>TA</given-names></name><name><surname>Jiang</surname><given-names>ZJ</given-names></name><name><surname>Gu</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>ZO</given-names></name><name><surname>Pollock</surname><given-names>DD</given-names></name></person-group><article-title>Adaptive evolution and functional redesign of core metabolic proteins in snakes</article-title><source>PLoS ONE</source><year>2008</year><volume>3</volume><fpage>e2201</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0002201</pub-id><pub-id pub-id-type="pmid">18493604</pub-id></element-citation></ref><ref id="CR69"><label>69.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vermeij</surname><given-names>GJ</given-names></name></person-group><article-title>Historical contingency and the purported uniqueness of evolutionary innovations</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2006</year><volume>103</volume><fpage>1804</fpage><lpage>1809</lpage><pub-id pub-id-type="doi">10.1073/pnas.0508724103</pub-id><pub-id pub-id-type="pmid">16443685</pub-id></element-citation></ref><ref id="CR70"><label>70.</label><mixed-citation publication-type="other">Darwin, C. R. <italic>On the Origin of Species by Means of Natural Selection, or the Preservation of Favoured Races in the Struggle for Life</italic> (John Murray, 1859).</mixed-citation></ref><ref id="CR71"><label>71.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><article-title>Evolutionary rate at the molecular level</article-title><source>Nature</source><year>1968</year><volume>217</volume><fpage>624</fpage><lpage>626</lpage><pub-id pub-id-type="doi">10.1038/217624a0</pub-id><pub-id pub-id-type="pmid">5637732</pub-id></element-citation></ref><ref id="CR72"><label>72.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohta</surname><given-names>T</given-names></name></person-group><article-title>Slightly deleterious mutant substitutions in evolution</article-title><source>Nature</source><year>1973</year><volume>246</volume><fpage>96</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1038/246096a0</pub-id><pub-id pub-id-type="pmid">4585855</pub-id></element-citation></ref><ref id="CR73"><label>73.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spielman</surname><given-names>SJ</given-names></name><name><surname>Wilke</surname><given-names>CO</given-names></name></person-group><article-title>Pyvolve: a flexible Python module for simulating sequences along phylogenies</article-title><source>PLoS ONE</source><year>2015</year><volume>10</volume><fpage>e0139047</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0139047</pub-id><pub-id pub-id-type="pmid">26397960</pub-id></element-citation></ref><ref id="CR74"><label>74.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosiol</surname><given-names>C</given-names></name><name><surname>Holmes</surname><given-names>I</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>An empirical codon model for protein sequence evolution</article-title><source>Mol. Biol. Evol.</source><year>2007</year><volume>24</volume><fpage>1464</fpage><lpage>1479</lpage><pub-id pub-id-type="doi">10.1093/molbev/msm064</pub-id><pub-id pub-id-type="pmid">17400572</pub-id></element-citation></ref><ref id="CR75"><label>75.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katoh</surname><given-names>K</given-names></name><name><surname>Standley</surname><given-names>DM</given-names></name></person-group><article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title><source>Mol. Biol. Evol.</source><year>2013</year><volume>30</volume><fpage>772</fpage><lpage>780</lpage><pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><pub-id pub-id-type="pmid">23329690</pub-id></element-citation></ref><ref id="CR76"><label>76.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schoch</surname><given-names>CL</given-names></name><etal/></person-group><article-title>NCBI Taxonomy: a comprehensive update on curation, resources and tools</article-title><source>Database</source><year>2020</year><volume>2020</volume><fpage>baaa062</fpage><pub-id pub-id-type="doi">10.1093/database/baaa062</pub-id><pub-id pub-id-type="pmid">32761142</pub-id></element-citation></ref><ref id="CR77"><label>77.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morel</surname><given-names>B</given-names></name><name><surname>Kozlov</surname><given-names>AM</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name><name><surname>Sz&#x000f6;ll&#x00151;si</surname><given-names>GJ</given-names></name></person-group><article-title>GeneRax: a tool for species-tree-aware maximum likelihood-based gene family tree inference under gene duplication, transfer, and loss</article-title><source>Mol. Biol. Evol.</source><year>2020</year><volume>37</volume><fpage>2763</fpage><lpage>2774</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa141</pub-id><pub-id pub-id-type="pmid">32502238</pub-id></element-citation></ref><ref id="CR78"><label>78.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name><etal/></person-group><article-title>The human phylome</article-title><source>Genome Biol.</source><year>2007</year><volume>8</volume><fpage>934</fpage><lpage>941</lpage><pub-id pub-id-type="doi">10.1186/gb-2007-8-6-r109</pub-id></element-citation></ref><ref id="CR79"><label>79.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hansen</surname><given-names>TF</given-names></name></person-group><article-title>Stabilizing selection and the comparative analysis of adaptation</article-title><source>Evolution</source><year>1997</year><volume>51</volume><fpage>1341</fpage><lpage>1351</lpage><pub-id pub-id-type="doi">10.2307/2411186</pub-id><pub-id pub-id-type="pmid">28568616</pub-id></element-citation></ref><ref id="CR80"><label>80.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname><given-names>BQ</given-names></name><etal/></person-group><article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title><source>Mol. Biol. Evol.</source><year>2020</year><volume>37</volume><fpage>1530</fpage><lpage>1534</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><pub-id pub-id-type="pmid">32011700</pub-id></element-citation></ref><ref id="CR81"><label>81.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CR</given-names></name><etal/></person-group><article-title>Array programming with NumPy</article-title><source>Nature</source><year>2020</year><volume>585</volume><fpage>357</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id><pub-id pub-id-type="pmid">32939066</pub-id></element-citation></ref><ref id="CR82"><label>82.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muse</surname><given-names>SV</given-names></name><name><surname>Gaut</surname><given-names>BS</given-names></name></person-group><article-title>A likelihood approach for comparing synonymous and nonsynonymous nucleotide substitution rates, with application to the chloroplast genome</article-title><source>Mol. Biol. Evol.</source><year>1994</year><volume>11</volume><fpage>715</fpage><lpage>724</lpage><pub-id pub-id-type="pmid">7968485</pub-id></element-citation></ref><ref id="CR83"><label>83.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>A codon-based model of nucleotide substitution for protein-coding DNA sequences</article-title><source>Mol. Biol. Evol.</source><year>1994</year><volume>11</volume><fpage>725</fpage><lpage>736</lpage><pub-id pub-id-type="pmid">7968486</pub-id></element-citation></ref><ref id="CR84"><label>84.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whelan</surname><given-names>S</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>A general empirical model of protein evolution derived from multiple protein families using a maximum-likelihood approach</article-title><source>Mol. Biol. Evol.</source><year>2001</year><volume>18</volume><fpage>691</fpage><lpage>699</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a003851</pub-id><pub-id pub-id-type="pmid">11319253</pub-id></element-citation></ref><ref id="CR85"><label>85.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kone&#x0010d;n&#x000e1;</surname><given-names>V</given-names></name><etal/></person-group><article-title>Parallel adaptation in autopolyploid <italic>Arabidopsis arenosa</italic> is dominated by repeated recruitment of shared alleles</article-title><source>Nat. Commun.</source><year>2021</year><volume>12</volume><fpage>4979</fpage><pub-id pub-id-type="doi">10.1038/s41467-021-25256-5</pub-id><pub-id pub-id-type="pmid">34404804</pub-id></element-citation></ref><ref id="CR86"><label>86.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sage</surname><given-names>RF</given-names></name><name><surname>Christin</surname><given-names>P-A</given-names></name><name><surname>Edwards</surname><given-names>EJ</given-names></name></person-group><article-title>The C<sub>4</sub> plant lineages of planet Earth</article-title><source>J. Exp. Bot.</source><year>2011</year><volume>62</volume><fpage>3155</fpage><lpage>3169</lpage><pub-id pub-id-type="doi">10.1093/jxb/err048</pub-id><pub-id pub-id-type="pmid">21414957</pub-id></element-citation></ref><ref id="CR87"><label>87.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name><name><surname>Serra</surname><given-names>F</given-names></name><name><surname>Bork</surname><given-names>P</given-names></name></person-group><article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title><source>Mol. Biol. Evol.</source><year>2016</year><volume>33</volume><fpage>1635</fpage><lpage>1638</lpage><pub-id pub-id-type="doi">10.1093/molbev/msw046</pub-id><pub-id pub-id-type="pmid">26921390</pub-id></element-citation></ref><ref id="CR88"><label>88.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P</given-names></name><etal/></person-group><article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title><source>Nat. Methods</source><year>2020</year><volume>17</volume><fpage>261</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><pub-id pub-id-type="pmid">32015543</pub-id></element-citation></ref><ref id="CR89"><label>89.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behnel</surname><given-names>S</given-names></name><etal/></person-group><article-title>Cython: the best of both worlds</article-title><source>Comput. Sci. Eng.</source><year>2011</year><volume>13</volume><fpage>31</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1109/MCSE.2010.118</pub-id></element-citation></ref><ref id="CR90"><label>90.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>S&#x000f6;ding</surname><given-names>J</given-names></name></person-group><article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title><source>Nat. Biotechnol.</source><year>2017</year><volume>35</volume><fpage>1026</fpage><lpage>1028</lpage><pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id><pub-id pub-id-type="pmid">29035372</pub-id></element-citation></ref><ref id="CR91"><label>91.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>HM</given-names></name><etal/></person-group><article-title>The Protein Data Bank</article-title><source>Nucleic Acids Res.</source><year>2000</year><volume>28</volume><fpage>235</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id><pub-id pub-id-type="pmid">10592235</pub-id></element-citation></ref><ref id="CR92"><label>92.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varadi</surname><given-names>M</given-names></name><etal/></person-group><article-title>AlphaFold Protein Structure Database: massively expanding the structural coverage of protein-sequence space with high-accuracy models</article-title><source>Nucleic Acids Res.</source><year>2022</year><volume>50</volume><fpage>D439</fpage><lpage>D444</lpage><pub-id pub-id-type="doi">10.1093/nar/gkab1061</pub-id><pub-id pub-id-type="pmid">34791371</pub-id></element-citation></ref><ref id="CR93"><label>93.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><etal/></person-group><article-title>Highly accurate protein structure prediction with AlphaFold</article-title><source>Nature</source><year>2021</year><volume>596</volume><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><pub-id pub-id-type="pmid">34265844</pub-id></element-citation></ref><ref id="CR94"><label>94.</label><mixed-citation publication-type="other">Fukushima, K. &#x00026; Pollock, D. D. Data from: Detecting macroevolutionary genotype-phenotype associations using error-corrected rates of protein convergence. <italic>Dryad</italic>10.5061/dryad.tx95x6b0v (2022).</mixed-citation></ref><ref id="CR95"><label>95.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedges</surname><given-names>SB</given-names></name><name><surname>Dudley</surname><given-names>J</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name></person-group><article-title>TimeTree: a public knowledge-base of divergence times among organisms</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>2971</fpage><lpage>2972</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl505</pub-id><pub-id pub-id-type="pmid">17021158</pub-id></element-citation></ref><ref id="CR96"><label>96.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunner</surname><given-names>E</given-names></name><name><surname>Munzel</surname><given-names>U</given-names></name></person-group><article-title>The nonparametric Behrens&#x02013;Fisher problem: asymptotic theory and a small-sample approximation</article-title><source>Biom. J.</source><year>2000</year><volume>42</volume><fpage>17</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1521-4036(200001)42:1&#x0003c;17::AID-BIMJ17&#x0003e;3.0.CO;2-U</pub-id></element-citation></ref><ref id="CR97"><label>97.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>L</given-names></name><etal/></person-group><article-title>A draft genome assembly of halophyte <italic>Suaeda aralocaspica</italic>, a plant that performs C<sub>4</sub> photosynthesis within individual cells</article-title><source>GigaScience</source><year>2019</year><volume>8</volume><fpage>giz116</fpage><pub-id pub-id-type="doi">10.1093/gigascience/giz116</pub-id><pub-id pub-id-type="pmid">31513708</pub-id></element-citation></ref></ref-list></back></article>