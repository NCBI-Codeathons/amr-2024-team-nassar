Introduction Cooperative interactions are not restricted to complex, higher organisms, but are also prevalent among microbial communities in many contexts (Kehe et al., 2021; Rakoff-Nahoum et al., 2016; Wenseleers and Ratnieks, 2006). Both natural selection and game theory predict that cooperative systems are vulnerable to non-cooperative cheaters that exploit the benefit, such as public goods including extracellular enzymes (Chen et al., 2019), siderophore (Griffin et al., 2004), or biofilm matrix (Dragoš and Kovács, 2017; Vlamakis et al., 2013) since these selfish individuals enjoy the common resources without paying their cost (Hardin, 1968; Martin et al., 2020; West et al., 2006). Intriguingly, cooperation principally survives cheating during evolutionary history (Travisano and Velicer, 2004), and a couple of mechanisms have been proposed to play significant roles in maintaining cooperation by preventing cheater invasion (Özkaya et al., 2017; Travisano and Velicer, 2004). These strategies mainly include kin selection/discrimination (Özkaya et al., 2017; Diggle et al., 2007; McNally et al., 2017), facultative cooperation regulated by a quorum-sensing (QS) system (Allen et al., 2016), or nutrient fitness cost (Sexton and Schuster, 2017), coupling production of public and private goods (Dandekar et al., 2012), punishment of cheating individuals by cooperator-produced antibiotics (García-Contreras et al., 2015; Wang et al., 2015), partial privatization of public goods under certain conditions (Jin et al., 2018; Otto et al., 2020), and spatial structuring (van Gestel et al., 2014). In general, the emergence of multiple sanction mechanisms is a consequence of natural selection, which suppresses social cheaters and enhances the altruistic behavior, thereby maintaining microbial community stability and improving their adaptation in different niches (Özkaya et al., 2017). In certain cases, microbial cooperation involves the division of labor, where subpopulations of cells are specialized to perform different tasks (Dragoš et al., 2018a; Strassmann and Queller, 2011). Division of labor requires three basic conditions: individuals exhibit different tasks (phenotypic variation); some individuals carry out cooperative tasks that benefit other individuals (cooperation); all individuals gain an inclusive fitness benefit from the interaction (adaptation) (Dragoš et al., 2018b; West and Cooper, 2016). For instance, Bacillus subtilis colony will phenotypically differentiate into surfactin-producing and matrix-producing cells during sliding motility, where the surfactin reduces the friction between cells and their substrate, while the matrix assembles into van Gogh bundles that drive the migration (Jordi et al., 2015). Another typical case is in early-stage biofilms, an extracellular matrix (ECM)-the enclosed multicellular community that sustains bacterial survival in diverse natural environments; it is known that B. subtilis cells can differentiate into motile cells and matrix-producing cells during biofilm formation (Vlamakis et al., 2008; Chai et al., 2008; Shank and Kolter, 2011; López and Kolter, 2010; López et al., 2009c; López et al., 2009a; van Gestel et al., 2015; Vlamakis et al., 2013; Kearns, 2008). The advantage of the division of labor is to efficiently integrate distinct cellular activities, thereby endowing a community with higher fitness than undifferentiated clones (West and Cooper, 2016; Zhang et al., 2016). Importantly, efficient division of labor relies on elaborate coordination of cell differentiation (Cremer et al., 2019; López et al., 2009b; Lord et al., 2019). In relative to the subpopulation producing a certain public good (e.g. cells producing ECM during biofilm formation), the nonproducing cells that can also enjoy this common good, actually become the ‘cheater-like’ individuals to some extent (although they may provide other contributions to the community) (Claessen et al., 2014; Otto et al., 2020; West and Cooper, 2016). Therefore, regulating the proportion of each cell type and alignment of interests, is important for maintaining the stability and fitness of the division of labor (West and Cooper, 2016), while an unbalanced cell differentiation will reduce the population productivity and even cause a collapse of the division of labor (Dragoš et al., 2018a). Despite the knowledge of pathways controlling cell differentiation in microbes, little is known about how the different cell types interact with each other and the fitness consequences of their interaction (van Gestel et al., 2015). Although a few studies have investigated the overlap between public goods production and cell cannibalism (González-Pastor et al., 2003; López et al., 2009c), as well as matrix privatization (Otto et al., 2020) during cell differentiation, the molecular mechanism involved in coordinating the cheater-like individuals in the division of labor, as well as the ecological significance of the policing system in regulating population stability and fitness, remain unclear. Accordingly, lacking these knowledge limits our understanding of cooperation and altruism within microbial social communities. Bacillus velezensis SQR9 (formerly B. amyloliquefaciens SQR9) is a well-studied beneficial rhizobacterium that forms robust and highly structured biofilms on the air-liquid interface and plant roots (Qiu et al., 2014; Xu et al., 2019a; Xu et al., 2013; Cao et al., 2011). Strain SQR9 harbors a novel genomic island 3 (GI3) consisting of four operons, where the second, third, and fourth operons are responsible for the production of the novel branched-chain fatty acids, BAs, while the first operon encodes an ABC transporter to export toxic BAs for self-immunity (Wang et al., 2019). Production of toxic BAs was proved to occur in the subfraction of cells with the self-immunity ability induced by BAs during biofilm formation, where the nonproducing siblings will be lysed by BAs (Huang et al., 2021; Wang et al., 2019). Based on the manifestation that the BA-mediated cannibalism enhanced the biofilm formation of strain SQR9, we hypothesized the ECM and BAs synthesis can be co-regulated to restrain the cheater-like individuals that don’t produce ECM, thereby optimizing the division of labor and altruistic behavior. Using a combination of single-cell tracking techniques, molecular approaches, and ecological evaluation, we demonstrated that ECM and BAs production are coordinated in the same subpopulation by the same regulator during biofilm formation, which enforces punishment of the cheater-like nonproducers to maintain community stabilization; also this genomic island-governed policing system is significant to promote community fitness in various conditions.