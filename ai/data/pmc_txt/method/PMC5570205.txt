MATERIALS AND METHODS Workflow The ARTS workflow in Figure 1 illustrates automated steps for known resistance screening and novel target analysis. Users provide DNA sequences of whole genomes or gene clusters in Genbank, FASTA or EMBL format as input; alternatively an NCBI accession number or antiSMASH job id can be used to retrieve data automatically. The first steps include identifying BGCs using antiSMASH, detecting known resistance models (19–22) and detecting essential core genes (see reference set and core gene detection). During the next steps the identified core and known resistance genes are screened for their location within BGCs. Finally core genes are screened for HGT. All screening results are then summarized into an interactive output table to rapidly cross reference known and putative novel targets. Figure 1.Workflow of the ARTS pipeline. Input query genome sequences and reference organisms are scanned for Biosynthetic Gene Clusters (BGCs), known resistance factors and essential genes. Screening criteria for duplication, co-localization with BGCs and phylogeny are then applied and integrated into the interactive output for target directed BGC prioritization and novel target discovery. Workflow of the ARTS pipeline. Input query genome sequences and reference organisms are scanned for Biosynthetic Gene Clusters (BGCs), known resistance factors and essential genes. Screening criteria for duplication, co-localization with BGCs and phylogeny are then applied and integrated into the interactive output for target directed BGC prioritization and novel target discovery. Reference set and core gene detection A reference set of complete genomes is used to identify essential genes, define duplication thresholds and infer HGT via species and gene tree reconciliation. The current Actinobacteria reference set is comprised of complete genomes from 189 species representing 22 different families that are available through NCBI's RefSeq (23) database (Supplementary File S1). Core genes are identified using protein families from the TIGRFAM database, where all protein models that are found in the vast majority of reference genomes are considered core genes. Unless ‘exploration mode’ is used, core genes are filtered for unlikely targets by removing regulatory, transport and biosynthetic functions associated with known BGCs. To facilitate HGT detection in later steps, alignments and gene trees are then built as detailed in the Supplementary Methods. Screening criteria BGC proximity BGCs are detected using antiSMASH v3. Then core and resistance genes with intersecting locations on the same scaffold are marked as BGC proximity hits. These are presented in the visual cluster annotation as well as in the interactive summary tables. Gene duplication Duplication thresholds are determined comparatively using the sum of median and standard deviation for each essential gene count in the reference set. All core genes over these thresholds are then marked and recorded in the summary and duplication sections. HGT Phylogenetic screening is used to highlight all query organism core genes that show evidence of HGT. This is accomplished by comparing core gene trees with the species tree to highlight incongruences. This consists of first building alignments and trees for all core genes. A species tree is then inferred using ubiquitous, single copy gene trees with a coalescent tree analysis. Incongruent gene trees that are more likely explained by HGT, instead of duplications and losses through generations, is then determined as detailed in the Supplementary Methods. Input options Users can provide custom essential genes and resistance models for more tailored searches using the upload sections in the advanced dropdown; essential gene search thresholds can be modified in this section as well. Options to disable certain screening criteria are available to accelerate analysis and can be helpful for certain input, such as disabling phylogenetic screening for non-reference phyla genomes. By default, all criteria and trusted cutoffs are used and currently the phylogenetic reference set is selected for Actinobacteria. Non-actinobacterial genomes can be submitted for analysis however the phylogeny criteria will not be applicable. The option for ‘exploration mode’ is used for an extended search which may include more false positives but screens a larger, unfiltered, set of core genes. Output and interactive layout The results are presented in various sections by criteria perspectives: core genes, resistance models, gene duplications, BGC proximity and phylogeny. Dynamic tables in sections can be searched and sorted allowing for rapid prioritization of properties and their combinations (Figure 2). For example, sorting the core gene table by positive BGC hits and phylogeny will yield all core genes found in a BGC with incongruent phylogeny. Details for each item can be investigated by expanding a row to reveal links to corresponding sections. Visualizations for cluster annotations and trees highlighting the query organism are also generated for rapid confirmation of these criteria. All tables, trees and core gene alignments can be exported and saved for additional analysis from the export section. Additional metadata are provided to assess the viability of a novel target prediction which include: functional classification, average selection pressure (dN/dS) values and how widespread the essential gene is relative to reference organisms (ubiquity). This can help eliminate less promising drug target predictions, such as one that is not universally shared. Examples of all inputs and detailed tutorials on output interpretation can be found at https://arts.ziemertlab.com/help. Figure 2.Example output screenshot highlighting three major sections: core gene table prioritization, BGC visualization and phylogenetic incongruence confirmation. Example output screenshot highlighting three major sections: core gene table prioritization, BGC visualization and phylogenetic incongruence confirmation.