MATERIALS AND METHODS Sampling and biomolecular extractions. Eight GFSs were sampled in early to mid-2019 from the New Zealand Southern Alps and the Russian Caucasus, respectively, for a total of 21 epilithic biofilms (Table S1). The biofilm samples were collected from each stream reach, depending on the stream geomorphology, i.e., the presence of boulders, as described previously by Busi et al. (18). One to three biofilm samples were collected per reach (Table S1), taken using sterilized metal spatulas to scrape rocks, followed by their immediate transfer to cryovials. Samples were immediately flash-frozen in liquid nitrogen and stored at −80°C until DNA was extracted. DNA from the epilithic biofilms was extracted using a previously established protocol (60) adapted to a smaller scale due to relatively high DNA concentrations. DNA quantification was performed for all samples with the Qubit dsDNA HS kit (Invitrogen). Sequencing and data processing for metagenomics. Random shotgun sequencing was performed on all epilithic biofilm DNA samples after library preparation using the NEBNext Ultra II FS library kit. Fifty nanograms of DNA was enzymatically fragmented for 12.5 min, and libraries were prepared with six PCR amplification cycles. An average insert of 450 bp was maintained for all libraries. Qubit was used to quantify the libraries followed by sequencing at the Functional Genomics Centre Zurich on a NovaSeq (Illumina) using a S4 flowcell. The metagenomic data were processed using the Integrated Meta-omic Pipeline (IMP v3.0; commit# 9672c874 available at https://git-r3lab.uni.lu/IMP/imp3) (61). IMP’s workflow includes preprocessing, contig assembly, genome reconstruction (metagenome-assembled genomes, i.e., MAGs), and taxonomic and additional functional analysis of genes based on custom databases in a reproducible manner (61). Eukaryotic binning was performed in addition to the processing with the IMP workflow as described in Busi et al. (18). Briefly, eukaryotic MAGs were binned using CONCOCT (62), using contigs that were identified as eukaryotic, including those not mapping to bacteria or viruses in the maxikraken2 database available at https://lomanlab.github.io/mockcommunity/mc_databases.html. The eukaryotic taxonomies were further assigned using the PhyloDB and MMETSP databases associated with EUKulele (commit# fb8726a; available at https://github.com/AlexanderLabWHOI/EUKulele). Subsequently, contigs binned in eukaryotic MAGs were independently validated using WHOkaryote (63), which distinguishes eukaryotic and prokaryotic contigs in metagenomes based on gene structure. Consensus taxonomy per contig was then used for downstream analyses and association with ARGs. Identification of antimicrobial resistance genes, antibiotic biosynthesis pathways, and BGCs. For the prediction of ARGs, the IMP-generated contigs were used as input for PathoFact (64). Identified ARGs were further collapsed into their respective AMR categories in accordance with the Comprehensive Antibiotic Resistance Database (CARD) (65). PathoFact utilizes two distinct tools: DeepARG-LS, a deep-learning model, and RGI, based on homology and SNP models, to identify ARGs, therefore possibly also detecting resistance genes within eukaryotic genomic fragments. Subsequently, the raw read counts per open reading frame (ORF), obtained from PathoFact, were determined using FeatureCounts (66). To identify pathways for the biosynthesis of antibiotics, we assigned KEGG orthology (KOs) identifiers to the ORFs using a hidden Markov model (HMM) (67) approach using hmmsearch from HMMER 3.1 (68) with a minimum bit score of 40. Additionally, we linked the identified KOs to their corresponding KEGG orthology pathways and extracted the pathways annotated as antibiotic biosynthesis pathways by KEGG. Both the identified ARGs and KEGG pathways were then further linked to associated bacterial taxonomies using the contig classification. We further identified BGCs within the MAGs using antiSMASH (ANTIbiotics & Secondary Metabolite Analysis SHell) (29) and annotated these using deepBGC (30). Owing to the possibility that a single tool such as deepBGC may not be ideal for identifying BGCs, we additionally used GECCO to (69) identify and annotate BGCs. Since GECCO was trained on the MiBiG database (70), we expected to improve our detection sensitivity with the additional approach. BGCs that were identified by both tools, including those unique to each, were used for downstream analyses. To link BGCs and ARGs, we linked the resistance genes to the assembled contigs, followed by identifying the corresponding bins (MAGs) to which said contigs belonged. We subsequently extracted the genomic coordinates from the individual GenBank (.gbk) files for each of the BGCs, based on the deepBGC and GECCO analyses. The genomic coordinates were used to establish the location of the BGCs with respect to the ARGs identified via PathoFact. For the analyses described above, we only considered ARGs and BGCs within a maximum distance of 2 genes from each other, which corresponded to up to 2.5 Kb. This was based on a previous report by Conway et al. (71), who reported that, on average, there are 1.98 genes in a bacterial operon. Validation and phylogenetic analyses of putative ARGs. To ensure the accuracy of the ARGs identified within both pro- and eukaryotes and assess their homology to sequences within existing databases, the respective ARG sequences were retrieved and the following analyses performed. The retrieved sequences were cross-referenced using DIAMOND (72) against the UniProtKB database (73) to determine if the putative ARGs found within pro- and eukaryotes encoded other functions. To further determine how the putative ARGs from GFSs relate to their homologs, the existing ARG database (i.e., CARD), a phylogenetic analysis was performed. For the phylogenetics analyses, all ARG nucleotide sequences were collected from the CARD database and grouped by classification. Pro- and eukaryotic ARGs from the GFS samples with similar classifications were collated respectively, into multifasta files along with the reference sequences, and a multiple sequence alignment was performed using MAFFT (74) with default settings. The aligned sequences were subsequently trimmed with trimAl (75) using “-gt 0.9” as a threshold for gap filtering. Lastly, IQ-TREE 2 (76) was used to construct a phylogenetic tree using trimmed multiple sequence alignment with at least 10 FASTA sequences. The built trees were visualized using the ggtree package (77) using version 3.6 of the R statistical software package (78). Data analysis. The relative abundance of the ORFs was calculated based on the RNum_Gi method described by Hu et al. (79). Figures for the study, including visualizations derived from the taxonomic and functional analyses, were created using the R statistical software and the tidyverse package (80). Alluvial plots were generated using the ggalluvial package (81), while heatmaps were generated using the ComplexHeatmap package (82) developed for R. The corresponding visualization and analysis code is available at https://github.com/susheelbhanu/rock_biofilm_amr. Data availability. The Biosample accession IDs listed under Table S4 can be found on NCBI under the BioProject accession number PRJNA781406. The analysis code for IMP and downstream analys is detailed at https://git-r3lab.uni.lu/susheel.busi/nomis_pipeline. Binning and manual refinement of eukaryotic MAGs was done as described here: https://git-r3lab.uni.lu/susheel.busi/nomis_pipeline/-/blob/master/workflow/notes/MiscEUKMAGs.md. All visualization and analysis code is available at https://git-r3lab.uni.lu/susheel.busi/rock_amr and https://github.com/susheelbhanu/rock_biofilm_amr.