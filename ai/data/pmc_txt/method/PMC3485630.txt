Methods Genome sequences used in this study The completed genome sequences of 20 members of the B. cereus sensu lato group used in these studies are listed in Table
1. In this study, we made the simplifying assumption to focus exclusively on whole genome sequences and excluded the extensive collection of draft sequences available for the Bc sensu lato group. This was due to our intent to compare the frequency of indels to promoter differences in the SigB regulons of these organisms. Lack of a particular protein coding sequence in a draft genome could be due either to deletion of this coding sequence from the genome, or a lack of sampling of this region during the sequencing for the draft assembly. A related concern was that many draft sequences likely contain regions of misassembly or low sequence quality that could complicate the analyses that we intended, since searching for specific promoter sequences in the genome would require high quality data at all points in the sequence. Sigma factor B comparisons To confirm the identity of the annotated SigB orthologs in each genome, all sigma factor proteins in this genome set were identified using blastp, with the Bc ATCC14579 SigB (locus tag BC1004) as the query sequence. These sequences were compared with a maximum likelihood algorithm using PhyML [Seaview
[88]] with 100 bootstrap iterations and then analyzed manually to confirm the identity of all BC1004 orthologs. We further examined these proteins to confirm that the DNA binding sites encoded in each protein were the same, and were distinct from those of other sigma factors. The DNA binding sites of all sigma factor proteins encoded in the Bc ATCC14579 genome were compared using Sigma70_r2.hmm and Sigma70_r4.hmm (hidden Markov models of sigma factor region 2 and region 4, respectively), obtained from the Pfam website
[89]. The utility hmmalign [hmmer-3.0b3
[90]] was used to create alignments of region 2 and region 4 of all Bc ATCC14579 primary alternative sigmas, which were manually inspected. A similar comparison was made with all SigB sequences using the utility hmmalign along with Sigma70_r2.hmm and Sigma70_r2.hmm. These comparisons confirmed that all SigB orthologs encoded in these genomes had a conserved DNA binding domain, and therefore are expected to recognize a conserved DNA binding site. SigB binding site model building and validation We began model building by using experimentally-derived SigB binding sites derived from Bc ATCC14579
[44,45]. This data set was expanded for training purposes using phylogenetic footprinting
[91]. To do this, we began with the 5’ gene of each Bc ATCC14579 operon regulated by SigB, including BC0863, BC0998, BC1001, BC1002, BC1005, BC1009, BC1010, BC3132, and BC4641. Blastp
[92] was used with default parameters, except an e-value cut-off of 1e-5, to identify similar sequences in the remaining 18 Bc sensu lato genomes. We did not use the B. cytotoxicus genome in these model-building experiments, as this organism lacks a SigB operon
[4]. Orthologs to the Bc ATCC14579 proteins in each organism were identified by constructing gene phylogenies for each gene family using Maximum Likelihood analysis (Seaview) and 100 bootstrap iterations. Tblastn searches were performed to ensure that any missing protein sequences in this data set were due to deletion events in the genome in question, rather than being missed during annotation. Then, the 150bp DNA sequence 5’ to each ortholog were collected and analyzed using the MEME default parameters
[93] to identify the SigB binding motif 5’ to each gene. These sequences defined the initial training set used for model building. Redundancy in this training was reduced using the purge function from the MEME package. We built two complementary models of the SigB binding site to be used in parallel for all subsequent analyses. A hidden Markov model (HMM) of the training sequences was created using hmmer-1.8.5
[94], while a position weight matrix (PWM) was derived using MEME. Leave-one-out cross validation
[95] was used to determine an appropriate empirical p-value cut-off of .00273 for the HMM and of 4.61e-7 for the PWM. Background scores for empirical p-value calculations for the HMM analysis were determined by searching the SigB HMM against the randomly shuffled Bc ATCC14579 genome [shuffleseq from EMBOSS-6.3.1
[96]]. Empirical p-values for the SigB HMM alignments were determined by comparing the alignment score to the background scores using a Perl script and R-2.13.0. Orthologous Gene Clustering, Operon and Regulon predictions Initially, the Ba str. Sterne transcriptome structure was extracted from the supplementary information provided by Passalacqua et al.[28]. For comparing the predicted transcriptomes from all genomes, we clustered all annotated protein-coding sequences using CD-hit
[97] to identify orthologous gene clusters. This resulted in a total of 16,835 gene clusters, with cluster sizes ranging from 1 to 19 genes; each cluster was assigned a unique identifier (bID_Cluster_number; see Additional file
3: Table S2). All predicted SigB-regulated genes were combined into a separate file and also clustered with CD-hit. On both data sets, we used the CD-hit default parameters except requiring an 85% sequence identity and an 80% sequence length difference cut-off. Operon predictions were performed using operonMBP
[98]. Receiver operator characteristic analysis
[99] was applied to the Ba str. Sterne transcriptome data to determine the appropriate cut-off to maximize true positive and minimize false positive transcription unit (TU) predictions (Figure
5). The appropriate window size was determined to be 250, and the appropriate cut-off for pairing two consecutive genes as co-operonic was 14. All TU predictions were then stored in a MySQL database (see Additional file
4: Table S3 for a summary of the TU predictions for each genome). To predict SigB regulon structure in each organism, the SigB HMM and PWM were used to independently scan across all 20 Bacillus genomes, and TUs 3’ to a significant binding site were extracted. We defined significant SigB binding sites as DNA regions that aligned to both the SigB HMM and PWM models, with p-values equal to or below at least one of their respective p-value cut-offs. Further, we allowed a 5’ untranslated region of up to 4.2 kb, based on the observations of Nicholas et al. in B. subtilis[100]. This information was then added to the MySQL database. Figure 5Receiver-operator characteristic analysis of the predicted Bc sensu lato transcriptome. Plot of the area under the curve (auc) versus the window size parameter of operonMBP for two different datasets. One data set contained RNA annotations while the RNA annotations were not in the second annotation. Receiver-operator characteristic analysis of the predicted Bc sensu lato transcriptome. Plot of the area under the curve (auc) versus the window size parameter of operonMBP for two different datasets. One data set contained RNA annotations while the RNA annotations were not in the second annotation. Finally, the regulon predictions were tabulated in a table of genomes vs. orthologous gene clusters and manually edited for accuracy. Scores of 0, 1, or 2 were assigned to the following states: 0, a gene not present in an orthologous cluster for a specific organism; 1, gene present but not predicted to be regulated by SigB in an orthologous cluster for a specific organism; and 2, gene present and predicted to be regulated by SigB in an orthologous cluster for a specific organism. Then, two comparisons were performed. We first used a pairwise comparison to assess the contribution of SigB promoters and indels to the structure of each regulon, and the changes between genomes. A promoter change occurs during the comparison of DNA sequence upstream of orthologous genes in which one gene contains a predicted binding site with a significant score while the second either does not contain a predicted binding site, or contains a predicted binding site that has a score that is not significant. And, we defined indels simply as the presence or lack of a protein coding sequence at a specific location; other more complex alterations, such as deletion of untranslated regions, SNPs or inversions, were not tabulated. All pairwise regulon comparisons were made in which the number of changes from 2 to 1, or 2 to 0 were counted. These numbers were normalized to the largest value counted and then plotted as indels vs. promoter changes (Figure
2). Secondly, the regulon scores were placed in a table that was converted to a phylip file and analyzed using PHYLIP with Maximum Parsimony and 100 bootstrap iterations to create a SigB regulon phylogeny. This table was also analyzed in R to create a heatmap (Figure
3 and Additional file
1: Figure S1) using heatmap.2 from the library package gplots. Cluster analysis for this heatmap was performed using the default hclust function in R, which specifies a complete-linkage clustering method similar to neighbor-joining.